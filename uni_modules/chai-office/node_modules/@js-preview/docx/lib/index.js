function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }
function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }
function _iterableToArray(r) { if ("undefined" != typeof Symbol && null != r[Symbol.iterator] || null != r["@@iterator"]) return Array.from(r); }
function _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }
function _slicedToArray(r, e) { return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest(); }
function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }
function _iterableToArrayLimit(r, l) { var t = null == r ? null : "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t.return && (u = t.return(), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }
function _arrayWithHoles(r) { if (Array.isArray(r)) return r; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _createForOfIteratorHelper(r, e) { var t = "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && "number" == typeof r.length) { t && (r = t); var _n11 = 0, F = function F() {}; return { s: F, n: function n() { return _n11 >= r.length ? { done: !0 } : { done: !1, value: r[_n11++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t.return || t.return(); } finally { if (u) throw o; } } }; }
function _unsupportedIterableToArray(r, a) { if (r) { if ("string" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return "Object" === t && r.constructor && (t = r.constructor.name), "Map" === t || "Set" === t ? Array.from(r) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }
function _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }
function _regeneratorRuntime() { "use strict"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = "function" == typeof Symbol ? Symbol : {}, a = i.iterator || "@@iterator", c = i.asyncIterator || "@@asyncIterator", u = i.toStringTag || "@@toStringTag"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, ""); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, "_invoke", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: "normal", arg: t.call(e, r) }; } catch (t) { return { type: "throw", arg: t }; } } e.wrap = wrap; var h = "suspendedStart", l = "suspendedYield", f = "executing", s = "completed", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { ["next", "throw", "return"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if ("throw" !== c.type) { var u = c.arg, h = u.value; return h && "object" == _typeof(h) && n.call(h, "__await") ? e.resolve(h.__await).then(function (t) { invoke("next", t, i, a); }, function (t) { invoke("throw", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke("throw", t, i, a); }); } a(c.arg); } var r; o(this, "_invoke", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw Error("Generator is already running"); if (o === s) { if ("throw" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if ("next" === n.method) n.sent = n._sent = n.arg;else if ("throw" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else "return" === n.method && n.abrupt("return", n.arg); o = f; var p = tryCatch(e, r, n); if ("normal" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } "throw" === p.type && (o = s, n.method = "throw", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, "throw" === n && e.iterator.return && (r.method = "return", r.arg = t, maybeInvokeDelegate(e, r), "throw" === r.method) || "return" !== n && (r.method = "throw", r.arg = new TypeError("The iterator does not provide a '" + n + "' method")), y; var i = tryCatch(o, e.iterator, r.arg); if ("throw" === i.type) return r.method = "throw", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, "return" !== r.method && (r.method = "next", r.arg = t), r.delegate = null, y) : a : (r.method = "throw", r.arg = new TypeError("iterator result is not an object"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = "normal", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: "root" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || "" === e) { var r = e[a]; if (r) return r.call(e); if ("function" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + " is not iterable"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, "constructor", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, "constructor", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, "GeneratorFunction"), e.isGeneratorFunction = function (t) { var e = "function" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || "GeneratorFunction" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, "GeneratorFunction")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, "Generator"), define(g, a, function () { return this; }), define(g, "toString", function () { return "[object Generator]"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = "next", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) "t" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if ("throw" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = "throw", a.arg = e, r.next = n, o && (r.method = "next", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if ("root" === i.tryLoc) return handle("end"); if (i.tryLoc <= this.prev) { var c = n.call(i, "catchLoc"), u = n.call(i, "finallyLoc"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw Error("try statement without catch or finally"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, "finallyLoc") && this.prev < o.finallyLoc) { var i = o; break; } } i && ("break" === t || "continue" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = "next", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if ("throw" === t.type) throw t.arg; return "break" === t.type || "continue" === t.type ? this.next = t.arg : "return" === t.type ? (this.rval = this.arg = t.arg, this.method = "return", this.next = "end") : "normal" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, catch: function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if ("throw" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw Error("illegal catch attempt"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, "next" === this.method && (this.arg = t), y; } }, e; }
function asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }
function _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, "next", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, "throw", n); } _next(void 0); }); }; }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
import "core-js/modules/es.symbol.js";
import "core-js/modules/es.symbol.description.js";
import "core-js/modules/es.symbol.async-iterator.js";
import "core-js/modules/es.symbol.has-instance.js";
import "core-js/modules/es.symbol.iterator.js";
import "core-js/modules/es.symbol.to-primitive.js";
import "core-js/modules/es.symbol.to-string-tag.js";
import "core-js/modules/es.array.concat.js";
import "core-js/modules/es.array.fill.js";
import "core-js/modules/es.array.filter.js";
import "core-js/modules/es.array.find.js";
import "core-js/modules/es.array.find-index.js";
import "core-js/modules/es.array.flat-map.js";
import "core-js/modules/es.array.from.js";
import "core-js/modules/es.array.includes.js";
import "core-js/modules/es.array.iterator.js";
import "core-js/modules/es.array.join.js";
import "core-js/modules/es.array.map.js";
import "core-js/modules/es.array.slice.js";
import "core-js/modules/es.array.sort.js";
import "core-js/modules/es.array.splice.js";
import "core-js/modules/es.array.unscopables.flat-map.js";
import "core-js/modules/es.array-buffer.constructor.js";
import "core-js/modules/es.date.to-primitive.js";
import "core-js/modules/es.function.has-instance.js";
import "core-js/modules/es.function.name.js";
import "core-js/modules/es.json.to-string-tag.js";
import "core-js/modules/es.math.to-string-tag.js";
import "core-js/modules/es.number.constructor.js";
import "core-js/modules/es.number.to-fixed.js";
import "core-js/modules/es.object.assign.js";
import "core-js/modules/es.object.entries.js";
import "core-js/modules/es.object.get-own-property-descriptor.js";
import "core-js/modules/es.object.get-own-property-descriptors.js";
import "core-js/modules/es.object.get-own-property-names.js";
import "core-js/modules/es.object.get-prototype-of.js";
import "core-js/modules/es.object.keys.js";
import "core-js/modules/es.object.to-string.js";
import "core-js/modules/es.promise.js";
import "core-js/modules/es.promise.finally.js";
import "core-js/modules/es.reflect.construct.js";
import "core-js/modules/es.regexp.exec.js";
import "core-js/modules/es.regexp.flags.js";
import "core-js/modules/es.regexp.to-string.js";
import "core-js/modules/es.string.includes.js";
import "core-js/modules/es.string.iterator.js";
import "core-js/modules/es.string.replace.js";
import "core-js/modules/es.string.starts-with.js";
import "core-js/modules/es.string.trim.js";
import "core-js/modules/es.typed-array.int32-array.js";
import "core-js/modules/es.typed-array.uint8-array.js";
import "core-js/modules/es.typed-array.uint16-array.js";
import "core-js/modules/es.typed-array.uint32-array.js";
import "core-js/modules/es.typed-array.copy-within.js";
import "core-js/modules/es.typed-array.every.js";
import "core-js/modules/es.typed-array.fill.js";
import "core-js/modules/es.typed-array.filter.js";
import "core-js/modules/es.typed-array.find.js";
import "core-js/modules/es.typed-array.find-index.js";
import "core-js/modules/es.typed-array.for-each.js";
import "core-js/modules/es.typed-array.from.js";
import "core-js/modules/es.typed-array.includes.js";
import "core-js/modules/es.typed-array.index-of.js";
import "core-js/modules/es.typed-array.iterator.js";
import "core-js/modules/es.typed-array.join.js";
import "core-js/modules/es.typed-array.last-index-of.js";
import "core-js/modules/es.typed-array.map.js";
import "core-js/modules/es.typed-array.reduce.js";
import "core-js/modules/es.typed-array.reduce-right.js";
import "core-js/modules/es.typed-array.reverse.js";
import "core-js/modules/es.typed-array.set.js";
import "core-js/modules/es.typed-array.slice.js";
import "core-js/modules/es.typed-array.some.js";
import "core-js/modules/es.typed-array.sort.js";
import "core-js/modules/es.typed-array.subarray.js";
import "core-js/modules/es.typed-array.to-locale-string.js";
import "core-js/modules/es.typed-array.to-string.js";
import "core-js/modules/esnext.global-this.js";
import "core-js/modules/esnext.promise.all-settled.js";
import "core-js/modules/web.dom-collections.for-each.js";
import "core-js/modules/web.dom-collections.iterator.js";
import "core-js/modules/web.url.js";
import "core-js/modules/web.url.to-json.js";
import "core-js/modules/web.url-search-params.js";
import e from "stream";
import t from "events";
import r from "buffer";
import n from "util";
void 0 === window.setImmediate && (window.setImmediate = function (e) {
  for (var _len = arguments.length, t = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    t[_key - 1] = arguments[_key];
  }
  setTimeout(function () {
    return e(t);
  });
});
var a = "undefined" != typeof globalThis ? globalThis : "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {};
function i(e) {
  return e && e.__esModule && Object.prototype.hasOwnProperty.call(e, "default") ? e.default : e;
}
var s,
  o,
  l,
  c,
  h,
  u = {},
  d = {},
  f = {},
  p = {
    exports: {}
  },
  m = {
    exports: {}
  };
function g() {
  if (s) return m.exports;
  return s = 1, "undefined" == typeof process || !process.version || 0 === process.version.indexOf("v0.") || 0 === process.version.indexOf("v1.") && 0 !== process.version.indexOf("v1.8.") ? m.exports = {
    nextTick: function nextTick(e, t, r, n) {
      if ("function" != typeof e) throw new TypeError('"callback" argument must be a function');
      var a,
        i,
        s = arguments.length;
      switch (s) {
        case 0:
        case 1:
          return process.nextTick(e);
        case 2:
          return process.nextTick(function () {
            e.call(null, t);
          });
        case 3:
          return process.nextTick(function () {
            e.call(null, t, r);
          });
        case 4:
          return process.nextTick(function () {
            e.call(null, t, r, n);
          });
        default:
          for (a = new Array(s - 1), i = 0; i < a.length;) a[i++] = arguments[i];
          return process.nextTick(function () {
            e.apply(null, a);
          });
      }
    }
  } : m.exports = process, m.exports;
}
function b() {
  return h ? c : (h = 1, c = e);
}
var y,
  v = {
    exports: {}
  };
function w() {
  return y || (y = 1, function (e, t) {
    var n = r,
      a = n.Buffer;
    function i(e, t) {
      for (var r in e) t[r] = e[r];
    }
    function s(e, t, r) {
      return a(e, t, r);
    }
    a.from && a.alloc && a.allocUnsafe && a.allocUnsafeSlow ? e.exports = n : (i(n, t), t.Buffer = s), i(a, s), s.from = function (e, t, r) {
      if ("number" == typeof e) throw new TypeError("Argument must not be a number");
      return a(e, t, r);
    }, s.alloc = function (e, t, r) {
      if ("number" != typeof e) throw new TypeError("Argument must be a number");
      var n = a(e);
      return void 0 !== t ? "string" == typeof r ? n.fill(t, r) : n.fill(t) : n.fill(0), n;
    }, s.allocUnsafe = function (e) {
      if ("number" != typeof e) throw new TypeError("Argument must be a number");
      return a(e);
    }, s.allocUnsafeSlow = function (e) {
      if ("number" != typeof e) throw new TypeError("Argument must be a number");
      return n.SlowBuffer(e);
    };
  }(v, v.exports)), v.exports;
}
var _,
  k = {};
function S() {
  if (_) return k;
  function e(e) {
    return Object.prototype.toString.call(e);
  }
  return _ = 1, k.isArray = function (t) {
    return Array.isArray ? Array.isArray(t) : "[object Array]" === e(t);
  }, k.isBoolean = function (e) {
    return "boolean" == typeof e;
  }, k.isNull = function (e) {
    return null === e;
  }, k.isNullOrUndefined = function (e) {
    return null == e;
  }, k.isNumber = function (e) {
    return "number" == typeof e;
  }, k.isString = function (e) {
    return "string" == typeof e;
  }, k.isSymbol = function (e) {
    return "symbol" == _typeof(e);
  }, k.isUndefined = function (e) {
    return void 0 === e;
  }, k.isRegExp = function (t) {
    return "[object RegExp]" === e(t);
  }, k.isObject = function (e) {
    return "object" == _typeof(e) && null !== e;
  }, k.isDate = function (t) {
    return "[object Date]" === e(t);
  }, k.isError = function (t) {
    return "[object Error]" === e(t) || t instanceof Error;
  }, k.isFunction = function (e) {
    return "function" == typeof e;
  }, k.isPrimitive = function (e) {
    return null === e || "boolean" == typeof e || "number" == typeof e || "string" == typeof e || "symbol" == _typeof(e) || void 0 === e;
  }, k.isBuffer = r.Buffer.isBuffer, k;
}
var x,
  C,
  E = {
    exports: {}
  },
  P = {
    exports: {}
  };
function A() {
  if (C) return E.exports;
  C = 1;
  try {
    var e = require("util");
    if ("function" != typeof e.inherits) throw "";
    E.exports = e.inherits;
  } catch (e) {
    E.exports = (x || (x = 1, "function" == typeof Object.create ? P.exports = function (e, t) {
      t && (e.super_ = t, e.prototype = Object.create(t.prototype, {
        constructor: {
          value: e,
          enumerable: !1,
          writable: !0,
          configurable: !0
        }
      }));
    } : P.exports = function (e, t) {
      if (t) {
        e.super_ = t;
        var r = function r() {};
        r.prototype = t.prototype, e.prototype = new r(), e.prototype.constructor = e;
      }
    }), P.exports);
  }
  return E.exports;
}
var T,
  N,
  R,
  B,
  M,
  D,
  O,
  I,
  z,
  F = {
    exports: {}
  };
function L() {
  return T || (T = 1, function (e) {
    var t = w().Buffer,
      r = n;
    e.exports = function () {
      function e() {
        !function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, e), this.head = null, this.tail = null, this.length = 0;
      }
      return e.prototype.push = function (e) {
        var t = {
          data: e,
          next: null
        };
        this.length > 0 ? this.tail.next = t : this.head = t, this.tail = t, ++this.length;
      }, e.prototype.unshift = function (e) {
        var t = {
          data: e,
          next: this.head
        };
        0 === this.length && (this.tail = t), this.head = t, ++this.length;
      }, e.prototype.shift = function () {
        if (0 !== this.length) {
          var e = this.head.data;
          return 1 === this.length ? this.head = this.tail = null : this.head = this.head.next, --this.length, e;
        }
      }, e.prototype.clear = function () {
        this.head = this.tail = null, this.length = 0;
      }, e.prototype.join = function (e) {
        if (0 === this.length) return "";
        for (var t = this.head, r = "" + t.data; t = t.next;) r += e + t.data;
        return r;
      }, e.prototype.concat = function (e) {
        if (0 === this.length) return t.alloc(0);
        for (var r, n, a, i = t.allocUnsafe(e >>> 0), s = this.head, o = 0; s;) r = s.data, n = i, a = o, r.copy(n, a), o += s.data.length, s = s.next;
        return i;
      }, e;
    }(), r && r.inspect && r.inspect.custom && (e.exports.prototype[r.inspect.custom] = function () {
      var e = r.inspect({
        length: this.length
      });
      return this.constructor.name + " " + e;
    });
  }(F)), F.exports;
}
function j() {
  if (R) return N;
  R = 1;
  var e = g();
  function t(e, t) {
    e.emit("error", t);
  }
  return N = {
    destroy: function destroy(r, n) {
      var a = this,
        i = this._readableState && this._readableState.destroyed,
        s = this._writableState && this._writableState.destroyed;
      return i || s ? (n ? n(r) : r && (this._writableState ? this._writableState.errorEmitted || (this._writableState.errorEmitted = !0, e.nextTick(t, this, r)) : e.nextTick(t, this, r)), this) : (this._readableState && (this._readableState.destroyed = !0), this._writableState && (this._writableState.destroyed = !0), this._destroy(r || null, function (r) {
        !n && r ? a._writableState ? a._writableState.errorEmitted || (a._writableState.errorEmitted = !0, e.nextTick(t, a, r)) : e.nextTick(t, a, r) : n && n(r);
      }), this);
    },
    undestroy: function undestroy() {
      this._readableState && (this._readableState.destroyed = !1, this._readableState.reading = !1, this._readableState.ended = !1, this._readableState.endEmitted = !1), this._writableState && (this._writableState.destroyed = !1, this._writableState.ended = !1, this._writableState.ending = !1, this._writableState.finalCalled = !1, this._writableState.prefinished = !1, this._writableState.finished = !1, this._writableState.errorEmitted = !1);
    }
  }, N;
}
function U() {
  if (O) return D;
  O = 1;
  var e = g();
  function t(e) {
    var t = this;
    this.next = null, this.entry = null, this.finish = function () {
      !function (e, t, r) {
        var n = e.entry;
        e.entry = null;
        for (; n;) {
          var a = n.callback;
          t.pendingcb--, a(r), n = n.next;
        }
        t.corkedRequestsFree.next = e;
      }(t, e);
    };
  }
  D = m;
  var r,
    i = !process.browser && ["v0.10", "v0.9."].indexOf(process.version.slice(0, 5)) > -1 ? setImmediate : e.nextTick;
  m.WritableState = p;
  var s = Object.create(S());
  s.inherits = A();
  var o = {
      deprecate: M ? B : (M = 1, B = n.deprecate)
    },
    l = b(),
    c = w().Buffer,
    h = (void 0 !== a ? a : "undefined" != typeof window ? window : "undefined" != typeof self ? self : {}).Uint8Array || function () {};
  var u,
    d = j();
  function f() {}
  function p(n, a) {
    r = r || $(), n = n || {};
    var s = a instanceof r;
    this.objectMode = !!n.objectMode, s && (this.objectMode = this.objectMode || !!n.writableObjectMode);
    var o = n.highWaterMark,
      l = n.writableHighWaterMark,
      c = this.objectMode ? 16 : 16384;
    this.highWaterMark = o || 0 === o ? o : s && (l || 0 === l) ? l : c, this.highWaterMark = Math.floor(this.highWaterMark), this.finalCalled = !1, this.needDrain = !1, this.ending = !1, this.ended = !1, this.finished = !1, this.destroyed = !1;
    var h = !1 === n.decodeStrings;
    this.decodeStrings = !h, this.defaultEncoding = n.defaultEncoding || "utf8", this.length = 0, this.writing = !1, this.corked = 0, this.sync = !0, this.bufferProcessing = !1, this.onwrite = function (t) {
      !function (t, r) {
        var n = t._writableState,
          a = n.sync,
          s = n.writecb;
        if (function (e) {
          e.writing = !1, e.writecb = null, e.length -= e.writelen, e.writelen = 0;
        }(n), r) !function (t, r, n, a, i) {
          --r.pendingcb, n ? (e.nextTick(i, a), e.nextTick(C, t, r), t._writableState.errorEmitted = !0, t.emit("error", a)) : (i(a), t._writableState.errorEmitted = !0, t.emit("error", a), C(t, r));
        }(t, n, a, r, s);else {
          var o = k(n);
          o || n.corked || n.bufferProcessing || !n.bufferedRequest || _(t, n), a ? i(v, t, n, o, s) : v(t, n, o, s);
        }
      }(a, t);
    }, this.writecb = null, this.writelen = 0, this.bufferedRequest = null, this.lastBufferedRequest = null, this.pendingcb = 0, this.prefinished = !1, this.errorEmitted = !1, this.bufferedRequestCount = 0, this.corkedRequestsFree = new t(this);
  }
  function m(e) {
    if (r = r || $(), !(u.call(m, this) || this instanceof r)) return new m(e);
    this._writableState = new p(e, this), this.writable = !0, e && ("function" == typeof e.write && (this._write = e.write), "function" == typeof e.writev && (this._writev = e.writev), "function" == typeof e.destroy && (this._destroy = e.destroy), "function" == typeof e.final && (this._final = e.final)), l.call(this);
  }
  function y(e, t, r, n, a, i, s) {
    t.writelen = n, t.writecb = s, t.writing = !0, t.sync = !0, r ? e._writev(a, t.onwrite) : e._write(a, i, t.onwrite), t.sync = !1;
  }
  function v(e, t, r, n) {
    r || function (e, t) {
      0 === t.length && t.needDrain && (t.needDrain = !1, e.emit("drain"));
    }(e, t), t.pendingcb--, n(), C(e, t);
  }
  function _(e, r) {
    r.bufferProcessing = !0;
    var n = r.bufferedRequest;
    if (e._writev && n && n.next) {
      var a = r.bufferedRequestCount,
        i = new Array(a),
        s = r.corkedRequestsFree;
      s.entry = n;
      for (var o = 0, l = !0; n;) i[o] = n, n.isBuf || (l = !1), n = n.next, o += 1;
      i.allBuffers = l, y(e, r, !0, r.length, i, "", s.finish), r.pendingcb++, r.lastBufferedRequest = null, s.next ? (r.corkedRequestsFree = s.next, s.next = null) : r.corkedRequestsFree = new t(r), r.bufferedRequestCount = 0;
    } else {
      for (; n;) {
        var c = n.chunk,
          h = n.encoding,
          u = n.callback;
        if (y(e, r, !1, r.objectMode ? 1 : c.length, c, h, u), n = n.next, r.bufferedRequestCount--, r.writing) break;
      }
      null === n && (r.lastBufferedRequest = null);
    }
    r.bufferedRequest = n, r.bufferProcessing = !1;
  }
  function k(e) {
    return e.ending && 0 === e.length && null === e.bufferedRequest && !e.finished && !e.writing;
  }
  function x(e, t) {
    e._final(function (r) {
      t.pendingcb--, r && e.emit("error", r), t.prefinished = !0, e.emit("prefinish"), C(e, t);
    });
  }
  function C(t, r) {
    var n = k(r);
    return n && (!function (t, r) {
      r.prefinished || r.finalCalled || ("function" == typeof t._final ? (r.pendingcb++, r.finalCalled = !0, e.nextTick(x, t, r)) : (r.prefinished = !0, t.emit("prefinish")));
    }(t, r), 0 === r.pendingcb && (r.finished = !0, t.emit("finish"))), n;
  }
  return s.inherits(m, l), p.prototype.getBuffer = function () {
    for (var e = this.bufferedRequest, t = []; e;) t.push(e), e = e.next;
    return t;
  }, function () {
    try {
      Object.defineProperty(p.prototype, "buffer", {
        get: o.deprecate(function () {
          return this.getBuffer();
        }, "_writableState.buffer is deprecated. Use _writableState.getBuffer instead.", "DEP0003")
      });
    } catch (e) {}
  }(), "function" == typeof Symbol && Symbol.hasInstance && "function" == typeof Function.prototype[Symbol.hasInstance] ? (u = Function.prototype[Symbol.hasInstance], Object.defineProperty(m, Symbol.hasInstance, {
    value: function value(e) {
      return !!u.call(this, e) || this === m && e && e._writableState instanceof p;
    }
  })) : u = function u(e) {
    return e instanceof this;
  }, m.prototype.pipe = function () {
    this.emit("error", new Error("Cannot pipe, not readable"));
  }, m.prototype.write = function (t, r, n) {
    var a,
      i = this._writableState,
      s = !1,
      o = !i.objectMode && (a = t, c.isBuffer(a) || a instanceof h);
    return o && !c.isBuffer(t) && (t = function (e) {
      return c.from(e);
    }(t)), "function" == typeof r && (n = r, r = null), o ? r = "buffer" : r || (r = i.defaultEncoding), "function" != typeof n && (n = f), i.ended ? function (t, r) {
      var n = new Error("write after end");
      t.emit("error", n), e.nextTick(r, n);
    }(this, n) : (o || function (t, r, n, a) {
      var i = !0,
        s = !1;
      return null === n ? s = new TypeError("May not write null values to stream") : "string" == typeof n || void 0 === n || r.objectMode || (s = new TypeError("Invalid non-string/buffer chunk")), s && (t.emit("error", s), e.nextTick(a, s), i = !1), i;
    }(this, i, t, n)) && (i.pendingcb++, s = function (e, t, r, n, a, i) {
      if (!r) {
        var s = function (e, t, r) {
          e.objectMode || !1 === e.decodeStrings || "string" != typeof t || (t = c.from(t, r));
          return t;
        }(t, n, a);
        n !== s && (r = !0, a = "buffer", n = s);
      }
      var o = t.objectMode ? 1 : n.length;
      t.length += o;
      var l = t.length < t.highWaterMark;
      l || (t.needDrain = !0);
      if (t.writing || t.corked) {
        var h = t.lastBufferedRequest;
        t.lastBufferedRequest = {
          chunk: n,
          encoding: a,
          isBuf: r,
          callback: i,
          next: null
        }, h ? h.next = t.lastBufferedRequest : t.bufferedRequest = t.lastBufferedRequest, t.bufferedRequestCount += 1;
      } else y(e, t, !1, o, n, a, i);
      return l;
    }(this, i, o, t, r, n)), s;
  }, m.prototype.cork = function () {
    this._writableState.corked++;
  }, m.prototype.uncork = function () {
    var e = this._writableState;
    e.corked && (e.corked--, e.writing || e.corked || e.bufferProcessing || !e.bufferedRequest || _(this, e));
  }, m.prototype.setDefaultEncoding = function (e) {
    if ("string" == typeof e && (e = e.toLowerCase()), !(["hex", "utf8", "utf-8", "ascii", "binary", "base64", "ucs2", "ucs-2", "utf16le", "utf-16le", "raw"].indexOf((e + "").toLowerCase()) > -1)) throw new TypeError("Unknown encoding: " + e);
    return this._writableState.defaultEncoding = e, this;
  }, Object.defineProperty(m.prototype, "writableHighWaterMark", {
    enumerable: !1,
    get: function get() {
      return this._writableState.highWaterMark;
    }
  }), m.prototype._write = function (e, t, r) {
    r(new Error("_write() is not implemented"));
  }, m.prototype._writev = null, m.prototype.end = function (t, r, n) {
    var a = this._writableState;
    "function" == typeof t ? (n = t, t = null, r = null) : "function" == typeof r && (n = r, r = null), null != t && this.write(t, r), a.corked && (a.corked = 1, this.uncork()), a.ending || function (t, r, n) {
      r.ending = !0, C(t, r), n && (r.finished ? e.nextTick(n) : t.once("finish", n));
      r.ended = !0, t.writable = !1;
    }(this, a, n);
  }, Object.defineProperty(m.prototype, "destroyed", {
    get: function get() {
      return void 0 !== this._writableState && this._writableState.destroyed;
    },
    set: function set(e) {
      this._writableState && (this._writableState.destroyed = e);
    }
  }), m.prototype.destroy = d.destroy, m.prototype._undestroy = d.undestroy, m.prototype._destroy = function (e, t) {
    this.end(), t(e);
  }, D;
}
function $() {
  if (z) return I;
  z = 1;
  var e = g(),
    t = Object.keys || function (e) {
      var t = [];
      for (var r in e) t.push(r);
      return t;
    };
  I = l;
  var r = Object.create(S());
  r.inherits = A();
  var n = Q(),
    a = U();
  r.inherits(l, n);
  for (var i = t(a.prototype), s = 0; s < i.length; s++) {
    var o = i[s];
    l.prototype[o] || (l.prototype[o] = a.prototype[o]);
  }
  function l(e) {
    if (!(this instanceof l)) return new l(e);
    n.call(this, e), a.call(this, e), e && !1 === e.readable && (this.readable = !1), e && !1 === e.writable && (this.writable = !1), this.allowHalfOpen = !0, e && !1 === e.allowHalfOpen && (this.allowHalfOpen = !1), this.once("end", c);
  }
  function c() {
    this.allowHalfOpen || this._writableState.ended || e.nextTick(h, this);
  }
  function h(e) {
    e.end();
  }
  return Object.defineProperty(l.prototype, "writableHighWaterMark", {
    enumerable: !1,
    get: function get() {
      return this._writableState.highWaterMark;
    }
  }), Object.defineProperty(l.prototype, "destroyed", {
    get: function get() {
      return void 0 !== this._readableState && void 0 !== this._writableState && this._readableState.destroyed && this._writableState.destroyed;
    },
    set: function set(e) {
      void 0 !== this._readableState && void 0 !== this._writableState && (this._readableState.destroyed = e, this._writableState.destroyed = e);
    }
  }), l.prototype._destroy = function (t, r) {
    this.push(null), this.end(), e.nextTick(r, t);
  }, I;
}
var H,
  W,
  Z,
  V,
  q,
  X,
  K,
  Y,
  G = {};
function J() {
  if (H) return G;
  H = 1;
  var e = w().Buffer,
    t = e.isEncoding || function (e) {
      switch ((e = "" + e) && e.toLowerCase()) {
        case "hex":
        case "utf8":
        case "utf-8":
        case "ascii":
        case "binary":
        case "base64":
        case "ucs2":
        case "ucs-2":
        case "utf16le":
        case "utf-16le":
        case "raw":
          return !0;
        default:
          return !1;
      }
    };
  function r(r) {
    var n;
    switch (this.encoding = function (r) {
      var n = function (e) {
        if (!e) return "utf8";
        for (var t;;) switch (e) {
          case "utf8":
          case "utf-8":
            return "utf8";
          case "ucs2":
          case "ucs-2":
          case "utf16le":
          case "utf-16le":
            return "utf16le";
          case "latin1":
          case "binary":
            return "latin1";
          case "base64":
          case "ascii":
          case "hex":
            return e;
          default:
            if (t) return;
            e = ("" + e).toLowerCase(), t = !0;
        }
      }(r);
      if ("string" != typeof n && (e.isEncoding === t || !t(r))) throw new Error("Unknown encoding: " + r);
      return n || r;
    }(r), this.encoding) {
      case "utf16le":
        this.text = i, this.end = s, n = 4;
        break;
      case "utf8":
        this.fillLast = a, n = 4;
        break;
      case "base64":
        this.text = o, this.end = l, n = 3;
        break;
      default:
        return this.write = c, void (this.end = h);
    }
    this.lastNeed = 0, this.lastTotal = 0, this.lastChar = e.allocUnsafe(n);
  }
  function n(e) {
    return e <= 127 ? 0 : e >> 5 == 6 ? 2 : e >> 4 == 14 ? 3 : e >> 3 == 30 ? 4 : e >> 6 == 2 ? -1 : -2;
  }
  function a(e) {
    var t = this.lastTotal - this.lastNeed,
      r = function (e, t) {
        if (128 != (192 & t[0])) return e.lastNeed = 0, "�";
        if (e.lastNeed > 1 && t.length > 1) {
          if (128 != (192 & t[1])) return e.lastNeed = 1, "�";
          if (e.lastNeed > 2 && t.length > 2 && 128 != (192 & t[2])) return e.lastNeed = 2, "�";
        }
      }(this, e);
    return void 0 !== r ? r : this.lastNeed <= e.length ? (e.copy(this.lastChar, t, 0, this.lastNeed), this.lastChar.toString(this.encoding, 0, this.lastTotal)) : (e.copy(this.lastChar, t, 0, e.length), void (this.lastNeed -= e.length));
  }
  function i(e, t) {
    if ((e.length - t) % 2 == 0) {
      var r = e.toString("utf16le", t);
      if (r) {
        var n = r.charCodeAt(r.length - 1);
        if (n >= 55296 && n <= 56319) return this.lastNeed = 2, this.lastTotal = 4, this.lastChar[0] = e[e.length - 2], this.lastChar[1] = e[e.length - 1], r.slice(0, -1);
      }
      return r;
    }
    return this.lastNeed = 1, this.lastTotal = 2, this.lastChar[0] = e[e.length - 1], e.toString("utf16le", t, e.length - 1);
  }
  function s(e) {
    var t = e && e.length ? this.write(e) : "";
    if (this.lastNeed) {
      var r = this.lastTotal - this.lastNeed;
      return t + this.lastChar.toString("utf16le", 0, r);
    }
    return t;
  }
  function o(e, t) {
    var r = (e.length - t) % 3;
    return 0 === r ? e.toString("base64", t) : (this.lastNeed = 3 - r, this.lastTotal = 3, 1 === r ? this.lastChar[0] = e[e.length - 1] : (this.lastChar[0] = e[e.length - 2], this.lastChar[1] = e[e.length - 1]), e.toString("base64", t, e.length - r));
  }
  function l(e) {
    var t = e && e.length ? this.write(e) : "";
    return this.lastNeed ? t + this.lastChar.toString("base64", 0, 3 - this.lastNeed) : t;
  }
  function c(e) {
    return e.toString(this.encoding);
  }
  function h(e) {
    return e && e.length ? this.write(e) : "";
  }
  return G.StringDecoder = r, r.prototype.write = function (e) {
    if (0 === e.length) return "";
    var t, r;
    if (this.lastNeed) {
      if (void 0 === (t = this.fillLast(e))) return "";
      r = this.lastNeed, this.lastNeed = 0;
    } else r = 0;
    return r < e.length ? t ? t + this.text(e, r) : this.text(e, r) : t || "";
  }, r.prototype.end = function (e) {
    var t = e && e.length ? this.write(e) : "";
    return this.lastNeed ? t + "�" : t;
  }, r.prototype.text = function (e, t) {
    var r = function (e, t, r) {
      var a = t.length - 1;
      if (a < r) return 0;
      var i = n(t[a]);
      if (i >= 0) return i > 0 && (e.lastNeed = i - 1), i;
      if (--a < r || -2 === i) return 0;
      if (i = n(t[a]), i >= 0) return i > 0 && (e.lastNeed = i - 2), i;
      if (--a < r || -2 === i) return 0;
      if (i = n(t[a]), i >= 0) return i > 0 && (2 === i ? i = 0 : e.lastNeed = i - 3), i;
      return 0;
    }(this, e, t);
    if (!this.lastNeed) return e.toString("utf8", t);
    this.lastTotal = r;
    var a = e.length - (r - this.lastNeed);
    return e.copy(this.lastChar, 0, a), e.toString("utf8", t, a);
  }, r.prototype.fillLast = function (e) {
    if (this.lastNeed <= e.length) return e.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, this.lastNeed), this.lastChar.toString(this.encoding, 0, this.lastTotal);
    e.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, e.length), this.lastNeed -= e.length;
  }, G;
}
function Q() {
  if (Z) return W;
  Z = 1;
  var e = g();
  W = x;
  var r,
    i = function () {
      if (l) return o;
      l = 1;
      var e = {}.toString;
      return o = Array.isArray || function (t) {
        return "[object Array]" == e.call(t);
      };
    }();
  x.ReadableState = k, t.EventEmitter;
  var s = function s(e, t) {
      return e.listeners(t).length;
    },
    c = b(),
    h = w().Buffer,
    u = (void 0 !== a ? a : "undefined" != typeof window ? window : "undefined" != typeof self ? self : {}).Uint8Array || function () {};
  var d = Object.create(S());
  d.inherits = A();
  var f = n,
    p = void 0;
  p = f && f.debuglog ? f.debuglog("stream") : function () {};
  var m,
    y = L(),
    v = j();
  d.inherits(x, c);
  var _ = ["error", "close", "destroy", "pause", "resume"];
  function k(e, t) {
    e = e || {};
    var n = t instanceof (r = r || $());
    this.objectMode = !!e.objectMode, n && (this.objectMode = this.objectMode || !!e.readableObjectMode);
    var a = e.highWaterMark,
      i = e.readableHighWaterMark,
      s = this.objectMode ? 16 : 16384;
    this.highWaterMark = a || 0 === a ? a : n && (i || 0 === i) ? i : s, this.highWaterMark = Math.floor(this.highWaterMark), this.buffer = new y(), this.length = 0, this.pipes = null, this.pipesCount = 0, this.flowing = null, this.ended = !1, this.endEmitted = !1, this.reading = !1, this.sync = !0, this.needReadable = !1, this.emittedReadable = !1, this.readableListening = !1, this.resumeScheduled = !1, this.destroyed = !1, this.defaultEncoding = e.defaultEncoding || "utf8", this.awaitDrain = 0, this.readingMore = !1, this.decoder = null, this.encoding = null, e.encoding && (m || (m = J().StringDecoder), this.decoder = new m(e.encoding), this.encoding = e.encoding);
  }
  function x(e) {
    if (r = r || $(), !(this instanceof x)) return new x(e);
    this._readableState = new k(e, this), this.readable = !0, e && ("function" == typeof e.read && (this._read = e.read), "function" == typeof e.destroy && (this._destroy = e.destroy)), c.call(this);
  }
  function C(e, t, r, n, a) {
    var i,
      s = e._readableState;
    null === t ? (s.reading = !1, function (e, t) {
      if (t.ended) return;
      if (t.decoder) {
        var r = t.decoder.end();
        r && r.length && (t.buffer.push(r), t.length += t.objectMode ? 1 : r.length);
      }
      t.ended = !0, N(e);
    }(e, s)) : (a || (i = function (e, t) {
      var r;
      n = t, h.isBuffer(n) || n instanceof u || "string" == typeof t || void 0 === t || e.objectMode || (r = new TypeError("Invalid non-string/buffer chunk"));
      var n;
      return r;
    }(s, t)), i ? e.emit("error", i) : s.objectMode || t && t.length > 0 ? ("string" == typeof t || s.objectMode || Object.getPrototypeOf(t) === h.prototype || (t = function (e) {
      return h.from(e);
    }(t)), n ? s.endEmitted ? e.emit("error", new Error("stream.unshift() after end event")) : E(e, s, t, !0) : s.ended ? e.emit("error", new Error("stream.push() after EOF")) : (s.reading = !1, s.decoder && !r ? (t = s.decoder.write(t), s.objectMode || 0 !== t.length ? E(e, s, t, !1) : B(e, s)) : E(e, s, t, !1))) : n || (s.reading = !1));
    return function (e) {
      return !e.ended && (e.needReadable || e.length < e.highWaterMark || 0 === e.length);
    }(s);
  }
  function E(e, t, r, n) {
    t.flowing && 0 === t.length && !t.sync ? (e.emit("data", r), e.read(0)) : (t.length += t.objectMode ? 1 : r.length, n ? t.buffer.unshift(r) : t.buffer.push(r), t.needReadable && N(e)), B(e, t);
  }
  Object.defineProperty(x.prototype, "destroyed", {
    get: function get() {
      return void 0 !== this._readableState && this._readableState.destroyed;
    },
    set: function set(e) {
      this._readableState && (this._readableState.destroyed = e);
    }
  }), x.prototype.destroy = v.destroy, x.prototype._undestroy = v.undestroy, x.prototype._destroy = function (e, t) {
    this.push(null), t(e);
  }, x.prototype.push = function (e, t) {
    var r,
      n = this._readableState;
    return n.objectMode ? r = !0 : "string" == typeof e && ((t = t || n.defaultEncoding) !== n.encoding && (e = h.from(e, t), t = ""), r = !0), C(this, e, t, !1, r);
  }, x.prototype.unshift = function (e) {
    return C(this, e, null, !0, !1);
  }, x.prototype.isPaused = function () {
    return !1 === this._readableState.flowing;
  }, x.prototype.setEncoding = function (e) {
    return m || (m = J().StringDecoder), this._readableState.decoder = new m(e), this._readableState.encoding = e, this;
  };
  var P = 8388608;
  function T(e, t) {
    return e <= 0 || 0 === t.length && t.ended ? 0 : t.objectMode ? 1 : e != e ? t.flowing && t.length ? t.buffer.head.data.length : t.length : (e > t.highWaterMark && (t.highWaterMark = function (e) {
      return e >= P ? e = P : (e--, e |= e >>> 1, e |= e >>> 2, e |= e >>> 4, e |= e >>> 8, e |= e >>> 16, e++), e;
    }(e)), e <= t.length ? e : t.ended ? t.length : (t.needReadable = !0, 0));
  }
  function N(t) {
    var r = t._readableState;
    r.needReadable = !1, r.emittedReadable || (p("emitReadable", r.flowing), r.emittedReadable = !0, r.sync ? e.nextTick(R, t) : R(t));
  }
  function R(e) {
    p("emit readable"), e.emit("readable"), I(e);
  }
  function B(t, r) {
    r.readingMore || (r.readingMore = !0, e.nextTick(M, t, r));
  }
  function M(e, t) {
    for (var r = t.length; !t.reading && !t.flowing && !t.ended && t.length < t.highWaterMark && (p("maybeReadMore read 0"), e.read(0), r !== t.length);) r = t.length;
    t.readingMore = !1;
  }
  function D(e) {
    p("readable nexttick read 0"), e.read(0);
  }
  function O(e, t) {
    t.reading || (p("resume read 0"), e.read(0)), t.resumeScheduled = !1, t.awaitDrain = 0, e.emit("resume"), I(e), t.flowing && !t.reading && e.read(0);
  }
  function I(e) {
    var t = e._readableState;
    for (p("flow", t.flowing); t.flowing && null !== e.read(););
  }
  function z(e, t) {
    return 0 === t.length ? null : (t.objectMode ? r = t.buffer.shift() : !e || e >= t.length ? (r = t.decoder ? t.buffer.join("") : 1 === t.buffer.length ? t.buffer.head.data : t.buffer.concat(t.length), t.buffer.clear()) : r = function (e, t, r) {
      var n;
      e < t.head.data.length ? (n = t.head.data.slice(0, e), t.head.data = t.head.data.slice(e)) : n = e === t.head.data.length ? t.shift() : r ? function (e, t) {
        var r = t.head,
          n = 1,
          a = r.data;
        e -= a.length;
        for (; r = r.next;) {
          var i = r.data,
            s = e > i.length ? i.length : e;
          if (s === i.length ? a += i : a += i.slice(0, e), 0 === (e -= s)) {
            s === i.length ? (++n, r.next ? t.head = r.next : t.head = t.tail = null) : (t.head = r, r.data = i.slice(s));
            break;
          }
          ++n;
        }
        return t.length -= n, a;
      }(e, t) : function (e, t) {
        var r = h.allocUnsafe(e),
          n = t.head,
          a = 1;
        n.data.copy(r), e -= n.data.length;
        for (; n = n.next;) {
          var i = n.data,
            s = e > i.length ? i.length : e;
          if (i.copy(r, r.length - e, 0, s), 0 === (e -= s)) {
            s === i.length ? (++a, n.next ? t.head = n.next : t.head = t.tail = null) : (t.head = n, n.data = i.slice(s));
            break;
          }
          ++a;
        }
        return t.length -= a, r;
      }(e, t);
      return n;
    }(e, t.buffer, t.decoder), r);
    var r;
  }
  function F(t) {
    var r = t._readableState;
    if (r.length > 0) throw new Error('"endReadable()" called on non-empty stream');
    r.endEmitted || (r.ended = !0, e.nextTick(U, r, t));
  }
  function U(e, t) {
    e.endEmitted || 0 !== e.length || (e.endEmitted = !0, t.readable = !1, t.emit("end"));
  }
  function H(e, t) {
    for (var r = 0, n = e.length; r < n; r++) if (e[r] === t) return r;
    return -1;
  }
  return x.prototype.read = function (e) {
    p("read", e), e = parseInt(e, 10);
    var t = this._readableState,
      r = e;
    if (0 !== e && (t.emittedReadable = !1), 0 === e && t.needReadable && (t.length >= t.highWaterMark || t.ended)) return p("read: emitReadable", t.length, t.ended), 0 === t.length && t.ended ? F(this) : N(this), null;
    if (0 === (e = T(e, t)) && t.ended) return 0 === t.length && F(this), null;
    var n,
      a = t.needReadable;
    return p("need readable", a), (0 === t.length || t.length - e < t.highWaterMark) && p("length less than watermark", a = !0), t.ended || t.reading ? p("reading or ended", a = !1) : a && (p("do read"), t.reading = !0, t.sync = !0, 0 === t.length && (t.needReadable = !0), this._read(t.highWaterMark), t.sync = !1, t.reading || (e = T(r, t))), null === (n = e > 0 ? z(e, t) : null) ? (t.needReadable = !0, e = 0) : t.length -= e, 0 === t.length && (t.ended || (t.needReadable = !0), r !== e && t.ended && F(this)), null !== n && this.emit("data", n), n;
  }, x.prototype._read = function (e) {
    this.emit("error", new Error("_read() is not implemented"));
  }, x.prototype.pipe = function (t, r) {
    var n = this,
      a = this._readableState;
    switch (a.pipesCount) {
      case 0:
        a.pipes = t;
        break;
      case 1:
        a.pipes = [a.pipes, t];
        break;
      default:
        a.pipes.push(t);
    }
    a.pipesCount += 1, p("pipe count=%d opts=%j", a.pipesCount, r);
    var o = (!r || !1 !== r.end) && t !== process.stdout && t !== process.stderr ? c : y;
    function l(e, r) {
      p("onunpipe"), e === n && r && !1 === r.hasUnpiped && (r.hasUnpiped = !0, p("cleanup"), t.removeListener("close", g), t.removeListener("finish", b), t.removeListener("drain", h), t.removeListener("error", m), t.removeListener("unpipe", l), n.removeListener("end", c), n.removeListener("end", y), n.removeListener("data", f), u = !0, !a.awaitDrain || t._writableState && !t._writableState.needDrain || h());
    }
    function c() {
      p("onend"), t.end();
    }
    a.endEmitted ? e.nextTick(o) : n.once("end", o), t.on("unpipe", l);
    var h = function (e) {
      return function () {
        var t = e._readableState;
        p("pipeOnDrain", t.awaitDrain), t.awaitDrain && t.awaitDrain--, 0 === t.awaitDrain && s(e, "data") && (t.flowing = !0, I(e));
      };
    }(n);
    t.on("drain", h);
    var u = !1;
    var d = !1;
    function f(e) {
      p("ondata"), d = !1, !1 !== t.write(e) || d || ((1 === a.pipesCount && a.pipes === t || a.pipesCount > 1 && -1 !== H(a.pipes, t)) && !u && (p("false write response, pause", a.awaitDrain), a.awaitDrain++, d = !0), n.pause());
    }
    function m(e) {
      p("onerror", e), y(), t.removeListener("error", m), 0 === s(t, "error") && t.emit("error", e);
    }
    function g() {
      t.removeListener("finish", b), y();
    }
    function b() {
      p("onfinish"), t.removeListener("close", g), y();
    }
    function y() {
      p("unpipe"), n.unpipe(t);
    }
    return n.on("data", f), function (e, t, r) {
      if ("function" == typeof e.prependListener) return e.prependListener(t, r);
      e._events && e._events[t] ? i(e._events[t]) ? e._events[t].unshift(r) : e._events[t] = [r, e._events[t]] : e.on(t, r);
    }(t, "error", m), t.once("close", g), t.once("finish", b), t.emit("pipe", n), a.flowing || (p("pipe resume"), n.resume()), t;
  }, x.prototype.unpipe = function (e) {
    var t = this._readableState,
      r = {
        hasUnpiped: !1
      };
    if (0 === t.pipesCount) return this;
    if (1 === t.pipesCount) return e && e !== t.pipes || (e || (e = t.pipes), t.pipes = null, t.pipesCount = 0, t.flowing = !1, e && e.emit("unpipe", this, r)), this;
    if (!e) {
      var n = t.pipes,
        a = t.pipesCount;
      t.pipes = null, t.pipesCount = 0, t.flowing = !1;
      for (var i = 0; i < a; i++) n[i].emit("unpipe", this, {
        hasUnpiped: !1
      });
      return this;
    }
    var s = H(t.pipes, e);
    return -1 === s || (t.pipes.splice(s, 1), t.pipesCount -= 1, 1 === t.pipesCount && (t.pipes = t.pipes[0]), e.emit("unpipe", this, r)), this;
  }, x.prototype.on = function (t, r) {
    var n = c.prototype.on.call(this, t, r);
    if ("data" === t) !1 !== this._readableState.flowing && this.resume();else if ("readable" === t) {
      var a = this._readableState;
      a.endEmitted || a.readableListening || (a.readableListening = a.needReadable = !0, a.emittedReadable = !1, a.reading ? a.length && N(this) : e.nextTick(D, this));
    }
    return n;
  }, x.prototype.addListener = x.prototype.on, x.prototype.resume = function () {
    var t = this._readableState;
    return t.flowing || (p("resume"), t.flowing = !0, function (t, r) {
      r.resumeScheduled || (r.resumeScheduled = !0, e.nextTick(O, t, r));
    }(this, t)), this;
  }, x.prototype.pause = function () {
    return p("call pause flowing=%j", this._readableState.flowing), !1 !== this._readableState.flowing && (p("pause"), this._readableState.flowing = !1, this.emit("pause")), this;
  }, x.prototype.wrap = function (e) {
    var t = this,
      r = this._readableState,
      n = !1;
    for (var a in e.on("end", function () {
      if (p("wrapped end"), r.decoder && !r.ended) {
        var e = r.decoder.end();
        e && e.length && t.push(e);
      }
      t.push(null);
    }), e.on("data", function (a) {
      (p("wrapped data"), r.decoder && (a = r.decoder.write(a)), r.objectMode && null == a) || (r.objectMode || a && a.length) && (t.push(a) || (n = !0, e.pause()));
    }), e) void 0 === this[a] && "function" == typeof e[a] && (this[a] = function (t) {
      return function () {
        return e[t].apply(e, arguments);
      };
    }(a));
    for (var i = 0; i < _.length; i++) e.on(_[i], this.emit.bind(this, _[i]));
    return this._read = function (t) {
      p("wrapped _read", t), n && (n = !1, e.resume());
    }, this;
  }, Object.defineProperty(x.prototype, "readableHighWaterMark", {
    enumerable: !1,
    get: function get() {
      return this._readableState.highWaterMark;
    }
  }), x._fromList = z, W;
}
function ee() {
  if (q) return V;
  q = 1, V = n;
  var e = $(),
    t = Object.create(S());
  function r(e, t) {
    var r = this._transformState;
    r.transforming = !1;
    var n = r.writecb;
    if (!n) return this.emit("error", new Error("write callback called multiple times"));
    r.writechunk = null, r.writecb = null, null != t && this.push(t), n(e);
    var a = this._readableState;
    a.reading = !1, (a.needReadable || a.length < a.highWaterMark) && this._read(a.highWaterMark);
  }
  function n(t) {
    if (!(this instanceof n)) return new n(t);
    e.call(this, t), this._transformState = {
      afterTransform: r.bind(this),
      needTransform: !1,
      transforming: !1,
      writecb: null,
      writechunk: null,
      writeencoding: null
    }, this._readableState.needReadable = !0, this._readableState.sync = !1, t && ("function" == typeof t.transform && (this._transform = t.transform), "function" == typeof t.flush && (this._flush = t.flush)), this.on("prefinish", a);
  }
  function a() {
    var e = this;
    "function" == typeof this._flush ? this._flush(function (t, r) {
      i(e, t, r);
    }) : i(this, null, null);
  }
  function i(e, t, r) {
    if (t) return e.emit("error", t);
    if (null != r && e.push(r), e._writableState.length) throw new Error("Calling transform done when ws.length != 0");
    if (e._transformState.transforming) throw new Error("Calling transform done when still transforming");
    return e.push(null);
  }
  return t.inherits = A(), t.inherits(n, e), n.prototype.push = function (t, r) {
    return this._transformState.needTransform = !1, e.prototype.push.call(this, t, r);
  }, n.prototype._transform = function (e, t, r) {
    throw new Error("_transform() is not implemented");
  }, n.prototype._write = function (e, t, r) {
    var n = this._transformState;
    if (n.writecb = r, n.writechunk = e, n.writeencoding = t, !n.transforming) {
      var a = this._readableState;
      (n.needTransform || a.needReadable || a.length < a.highWaterMark) && this._read(a.highWaterMark);
    }
  }, n.prototype._read = function (e) {
    var t = this._transformState;
    null !== t.writechunk && t.writecb && !t.transforming ? (t.transforming = !0, this._transform(t.writechunk, t.writeencoding, t.afterTransform)) : t.needTransform = !0;
  }, n.prototype._destroy = function (t, r) {
    var n = this;
    e.prototype._destroy.call(this, t, function (e) {
      r(e), n.emit("close");
    });
  }, V;
}
function te() {
  return Y || (Y = 1, t = p, r = p.exports, n = e, "disable" === process.env.READABLE_STREAM && n ? (t.exports = n, (r = t.exports = n.Readable).Readable = n.Readable, r.Writable = n.Writable, r.Duplex = n.Duplex, r.Transform = n.Transform, r.PassThrough = n.PassThrough, r.Stream = n) : ((r = t.exports = Q()).Stream = n || r, r.Readable = r, r.Writable = U(), r.Duplex = $(), r.Transform = ee(), r.PassThrough = function () {
    if (K) return X;
    K = 1, X = r;
    var e = ee(),
      t = Object.create(S());
    function r(t) {
      if (!(this instanceof r)) return new r(t);
      e.call(this, t);
    }
    return t.inherits = A(), t.inherits(r, e), r.prototype._transform = function (e, t, r) {
      r(null, e);
    }, X;
  }())), p.exports;
  var t, r, n;
}
if (f.base64 = !0, f.array = !0, f.string = !0, f.arraybuffer = "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array, f.nodebuffer = "undefined" != typeof Buffer, f.uint8array = "undefined" != typeof Uint8Array, "undefined" == typeof ArrayBuffer) f.blob = !1;else {
  var re = new ArrayBuffer(0);
  try {
    f.blob = 0 === new Blob([re], {
      type: "application/zip"
    }).size;
  } catch (e) {
    try {
      var ne = new (self.BlobBuilder || self.WebKitBlobBuilder || self.MozBlobBuilder || self.MSBlobBuilder)();
      ne.append(re), f.blob = 0 === ne.getBlob("application/zip").size;
    } catch (e) {
      f.blob = !1;
    }
  }
}
try {
  f.nodestream = !!te().Readable;
} catch (e) {
  f.nodestream = !1;
}
var ae,
  ie = {};
function se() {
  if (ae) return ie;
  ae = 1;
  var e = me(),
    t = f,
    r = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  return ie.encode = function (t) {
    for (var n, a, i, s, o, l, c, h = [], u = 0, d = t.length, f = d, p = "string" !== e.getTypeOf(t); u < t.length;) f = d - u, p ? (n = t[u++], a = u < d ? t[u++] : 0, i = u < d ? t[u++] : 0) : (n = t.charCodeAt(u++), a = u < d ? t.charCodeAt(u++) : 0, i = u < d ? t.charCodeAt(u++) : 0), s = n >> 2, o = (3 & n) << 4 | a >> 4, l = f > 1 ? (15 & a) << 2 | i >> 6 : 64, c = f > 2 ? 63 & i : 64, h.push(r.charAt(s) + r.charAt(o) + r.charAt(l) + r.charAt(c));
    return h.join("");
  }, ie.decode = function (e) {
    var n,
      a,
      i,
      s,
      o,
      l,
      c = 0,
      h = 0,
      u = "data:";
    if (e.substr(0, 5) === u) throw new Error("Invalid base64 input, it looks like a data url.");
    var d,
      f = 3 * (e = e.replace(/[^A-Za-z0-9+/=]/g, "")).length / 4;
    if (e.charAt(e.length - 1) === r.charAt(64) && f--, e.charAt(e.length - 2) === r.charAt(64) && f--, f % 1 != 0) throw new Error("Invalid base64 input, bad content length.");
    for (d = t.uint8array ? new Uint8Array(0 | f) : new Array(0 | f); c < e.length;) n = r.indexOf(e.charAt(c++)) << 2 | (s = r.indexOf(e.charAt(c++))) >> 4, a = (15 & s) << 4 | (o = r.indexOf(e.charAt(c++))) >> 2, i = (3 & o) << 6 | (l = r.indexOf(e.charAt(c++))), d[h++] = n, 64 !== o && (d[h++] = a), 64 !== l && (d[h++] = i);
    return d;
  }, ie;
}
var oe,
  le,
  ce,
  he,
  ue = {
    isNode: "undefined" != typeof Buffer,
    newBufferFrom: function newBufferFrom(e, t) {
      if (Buffer.from && Buffer.from !== Uint8Array.from) return Buffer.from(e, t);
      if ("number" == typeof e) throw new Error('The "data" argument must not be a number');
      return new Buffer(e, t);
    },
    allocBuffer: function allocBuffer(e) {
      if (Buffer.alloc) return Buffer.alloc(e);
      var t = new Buffer(e);
      return t.fill(0), t;
    },
    isBuffer: function isBuffer(e) {
      return Buffer.isBuffer(e);
    },
    isStream: function isStream(e) {
      return e && "function" == typeof e.on && "function" == typeof e.pause && "function" == typeof e.resume;
    }
  };
var de = null;
de = "undefined" != typeof Promise ? Promise : function () {
  if (he) return ce;
  he = 1;
  var e = function () {
    if (le) return oe;
    le = 1;
    var e,
      t,
      r = a.MutationObserver || a.WebKitMutationObserver;
    if (process.browser) {
      if (r) {
        var n = 0,
          i = new r(c),
          s = a.document.createTextNode("");
        i.observe(s, {
          characterData: !0
        }), e = function e() {
          s.data = n = ++n % 2;
        };
      } else if (a.setImmediate || void 0 === a.MessageChannel) e = "document" in a && "onreadystatechange" in a.document.createElement("script") ? function () {
        var e = a.document.createElement("script");
        e.onreadystatechange = function () {
          c(), e.onreadystatechange = null, e.parentNode.removeChild(e), e = null;
        }, a.document.documentElement.appendChild(e);
      } : function () {
        setTimeout(c, 0);
      };else {
        var o = new a.MessageChannel();
        o.port1.onmessage = c, e = function e() {
          o.port2.postMessage(0);
        };
      }
    } else e = function e() {
      process.nextTick(c);
    };
    var l = [];
    function c() {
      var e, r;
      t = !0;
      for (var n = l.length; n;) {
        for (r = l, l = [], e = -1; ++e < n;) r[e]();
        n = l.length;
      }
      t = !1;
    }
    return oe = function oe(r) {
      1 !== l.push(r) || t || e();
    };
  }();
  function t() {}
  var r = {},
    n = ["REJECTED"],
    i = ["FULFILLED"],
    s = ["PENDING"];
  if (!process.browser) var o = ["UNHANDLED"];
  function l(e) {
    if ("function" != typeof e) throw new TypeError("resolver must be a function");
    this.state = s, this.queue = [], this.outcome = void 0, process.browser || (this.handled = o), e !== t && d(this, e);
  }
  function c(e, t, r) {
    this.promise = e, "function" == typeof t && (this.onFulfilled = t, this.callFulfilled = this.otherCallFulfilled), "function" == typeof r && (this.onRejected = r, this.callRejected = this.otherCallRejected);
  }
  function h(t, n, a) {
    e(function () {
      var e;
      try {
        e = n(a);
      } catch (e) {
        return r.reject(t, e);
      }
      e === t ? r.reject(t, new TypeError("Cannot resolve promise with itself")) : r.resolve(t, e);
    });
  }
  function u(e) {
    var t = e && e.then;
    if (e && ("object" == _typeof(e) || "function" == typeof e) && "function" == typeof t) return function () {
      t.apply(e, arguments);
    };
  }
  function d(e, t) {
    var n = !1;
    function a(t) {
      n || (n = !0, r.reject(e, t));
    }
    function i(t) {
      n || (n = !0, r.resolve(e, t));
    }
    var s = f(function () {
      t(i, a);
    });
    "error" === s.status && a(s.value);
  }
  function f(e, t) {
    var r = {};
    try {
      r.value = e(t), r.status = "success";
    } catch (e) {
      r.status = "error", r.value = e;
    }
    return r;
  }
  return ce = l, l.prototype.finally = function (e) {
    if ("function" != typeof e) return this;
    var t = this.constructor;
    return this.then(function (r) {
      return t.resolve(e()).then(function () {
        return r;
      });
    }, function (r) {
      return t.resolve(e()).then(function () {
        throw r;
      });
    });
  }, l.prototype.catch = function (e) {
    return this.then(null, e);
  }, l.prototype.then = function (e, r) {
    if ("function" != typeof e && this.state === i || "function" != typeof r && this.state === n) return this;
    var a = new this.constructor(t);
    return process.browser || this.handled === o && (this.handled = null), this.state !== s ? h(a, this.state === i ? e : r, this.outcome) : this.queue.push(new c(a, e, r)), a;
  }, c.prototype.callFulfilled = function (e) {
    r.resolve(this.promise, e);
  }, c.prototype.otherCallFulfilled = function (e) {
    h(this.promise, this.onFulfilled, e);
  }, c.prototype.callRejected = function (e) {
    r.reject(this.promise, e);
  }, c.prototype.otherCallRejected = function (e) {
    h(this.promise, this.onRejected, e);
  }, r.resolve = function (e, t) {
    var n = f(u, t);
    if ("error" === n.status) return r.reject(e, n.value);
    var a = n.value;
    if (a) d(e, a);else {
      e.state = i, e.outcome = t;
      for (var s = -1, o = e.queue.length; ++s < o;) e.queue[s].callFulfilled(t);
    }
    return e;
  }, r.reject = function (t, r) {
    t.state = n, t.outcome = r, process.browser || t.handled === o && e(function () {
      t.handled === o && process.emit("unhandledRejection", r, t);
    });
    for (var a = -1, i = t.queue.length; ++a < i;) t.queue[a].callRejected(r);
    return t;
  }, l.resolve = function (e) {
    return e instanceof this ? e : r.resolve(new this(t), e);
  }, l.reject = function (e) {
    var n = new this(t);
    return r.reject(n, e);
  }, l.all = function (e) {
    var n = this;
    if ("[object Array]" !== Object.prototype.toString.call(e)) return this.reject(new TypeError("must be an array"));
    var a = e.length,
      i = !1;
    if (!a) return this.resolve([]);
    for (var s = new Array(a), o = 0, l = -1, c = new this(t); ++l < a;) h(e[l], l);
    return c;
    function h(e, t) {
      n.resolve(e).then(function (e) {
        s[t] = e, ++o !== a || i || (i = !0, r.resolve(c, s));
      }, function (e) {
        i || (i = !0, r.reject(c, e));
      });
    }
  }, l.race = function (e) {
    var n = this;
    if ("[object Array]" !== Object.prototype.toString.call(e)) return this.reject(new TypeError("must be an array"));
    var a = e.length,
      i = !1;
    if (!a) return this.resolve([]);
    for (var s, o = -1, l = new this(t); ++o < a;) s = e[o], n.resolve(s).then(function (e) {
      i || (i = !0, r.resolve(l, e));
    }, function (e) {
      i || (i = !0, r.reject(l, e));
    });
    return l;
  }, ce;
}();
var fe,
  pe = {
    Promise: de
  };
function me() {
  return fe || (fe = 1, function (e) {
    var t = f,
      r = se(),
      n = ue,
      a = pe;
    function i(e) {
      return e;
    }
    function s(e, t) {
      for (var r = 0; r < e.length; ++r) t[r] = 255 & e.charCodeAt(r);
      return t;
    }
    e.newBlob = function (t, r) {
      e.checkSupport("blob");
      try {
        return new Blob([t], {
          type: r
        });
      } catch (e) {
        try {
          var n = new (self.BlobBuilder || self.WebKitBlobBuilder || self.MozBlobBuilder || self.MSBlobBuilder)();
          return n.append(t), n.getBlob(r);
        } catch (e) {
          throw new Error("Bug : can't construct the Blob.");
        }
      }
    };
    var o = {
      stringifyByChunk: function stringifyByChunk(e, t, r) {
        var n = [],
          a = 0,
          i = e.length;
        if (i <= r) return String.fromCharCode.apply(null, e);
        for (; a < i;) "array" === t || "nodebuffer" === t ? n.push(String.fromCharCode.apply(null, e.slice(a, Math.min(a + r, i)))) : n.push(String.fromCharCode.apply(null, e.subarray(a, Math.min(a + r, i)))), a += r;
        return n.join("");
      },
      stringifyByChar: function stringifyByChar(e) {
        for (var t = "", r = 0; r < e.length; r++) t += String.fromCharCode(e[r]);
        return t;
      },
      applyCanBeUsed: {
        uint8array: function () {
          try {
            return t.uint8array && 1 === String.fromCharCode.apply(null, new Uint8Array(1)).length;
          } catch (e) {
            return !1;
          }
        }(),
        nodebuffer: function () {
          try {
            return t.nodebuffer && 1 === String.fromCharCode.apply(null, n.allocBuffer(1)).length;
          } catch (e) {
            return !1;
          }
        }()
      }
    };
    function l(t) {
      var r = 65536,
        n = e.getTypeOf(t),
        a = !0;
      if ("uint8array" === n ? a = o.applyCanBeUsed.uint8array : "nodebuffer" === n && (a = o.applyCanBeUsed.nodebuffer), a) for (; r > 1;) try {
        return o.stringifyByChunk(t, n, r);
      } catch (e) {
        r = Math.floor(r / 2);
      }
      return o.stringifyByChar(t);
    }
    function c(e, t) {
      for (var r = 0; r < e.length; r++) t[r] = e[r];
      return t;
    }
    e.applyFromCharCode = l;
    var h = {};
    h.string = {
      string: i,
      array: function array(e) {
        return s(e, new Array(e.length));
      },
      arraybuffer: function arraybuffer(e) {
        return h.string.uint8array(e).buffer;
      },
      uint8array: function uint8array(e) {
        return s(e, new Uint8Array(e.length));
      },
      nodebuffer: function nodebuffer(e) {
        return s(e, n.allocBuffer(e.length));
      }
    }, h.array = {
      string: l,
      array: i,
      arraybuffer: function arraybuffer(e) {
        return new Uint8Array(e).buffer;
      },
      uint8array: function uint8array(e) {
        return new Uint8Array(e);
      },
      nodebuffer: function nodebuffer(e) {
        return n.newBufferFrom(e);
      }
    }, h.arraybuffer = {
      string: function string(e) {
        return l(new Uint8Array(e));
      },
      array: function array(e) {
        return c(new Uint8Array(e), new Array(e.byteLength));
      },
      arraybuffer: i,
      uint8array: function uint8array(e) {
        return new Uint8Array(e);
      },
      nodebuffer: function nodebuffer(e) {
        return n.newBufferFrom(new Uint8Array(e));
      }
    }, h.uint8array = {
      string: l,
      array: function array(e) {
        return c(e, new Array(e.length));
      },
      arraybuffer: function arraybuffer(e) {
        return e.buffer;
      },
      uint8array: i,
      nodebuffer: function nodebuffer(e) {
        return n.newBufferFrom(e);
      }
    }, h.nodebuffer = {
      string: l,
      array: function array(e) {
        return c(e, new Array(e.length));
      },
      arraybuffer: function arraybuffer(e) {
        return h.nodebuffer.uint8array(e).buffer;
      },
      uint8array: function uint8array(e) {
        return c(e, new Uint8Array(e.length));
      },
      nodebuffer: i
    }, e.transformTo = function (t, r) {
      if (r || (r = ""), !t) return r;
      e.checkSupport(t);
      var n = e.getTypeOf(r);
      return h[n][t](r);
    }, e.resolve = function (e) {
      for (var t = e.split("/"), r = [], n = 0; n < t.length; n++) {
        var a = t[n];
        "." === a || "" === a && 0 !== n && n !== t.length - 1 || (".." === a ? r.pop() : r.push(a));
      }
      return r.join("/");
    }, e.getTypeOf = function (e) {
      return "string" == typeof e ? "string" : "[object Array]" === Object.prototype.toString.call(e) ? "array" : t.nodebuffer && n.isBuffer(e) ? "nodebuffer" : t.uint8array && e instanceof Uint8Array ? "uint8array" : t.arraybuffer && e instanceof ArrayBuffer ? "arraybuffer" : void 0;
    }, e.checkSupport = function (e) {
      if (!t[e.toLowerCase()]) throw new Error(e + " is not supported by this platform");
    }, e.MAX_VALUE_16BITS = 65535, e.MAX_VALUE_32BITS = -1, e.pretty = function (e) {
      var t,
        r,
        n = "";
      for (r = 0; r < (e || "").length; r++) n += "\\x" + ((t = e.charCodeAt(r)) < 16 ? "0" : "") + t.toString(16).toUpperCase();
      return n;
    }, e.delay = function (e, t, r) {
      setImmediate(function () {
        e.apply(r || null, t || []);
      });
    }, e.inherits = function (e, t) {
      var r = function r() {};
      r.prototype = t.prototype, e.prototype = new r();
    }, e.extend = function () {
      var e,
        t,
        r = {};
      for (e = 0; e < arguments.length; e++) for (t in arguments[e]) Object.prototype.hasOwnProperty.call(arguments[e], t) && void 0 === r[t] && (r[t] = arguments[e][t]);
      return r;
    }, e.prepareContent = function (n, i, o, l, c) {
      return a.Promise.resolve(i).then(function (e) {
        return t.blob && (e instanceof Blob || -1 !== ["[object File]", "[object Blob]"].indexOf(Object.prototype.toString.call(e))) && "undefined" != typeof FileReader ? new a.Promise(function (t, r) {
          var n = new FileReader();
          n.onload = function (e) {
            t(e.target.result);
          }, n.onerror = function (e) {
            r(e.target.error);
          }, n.readAsArrayBuffer(e);
        }) : e;
      }).then(function (i) {
        var h,
          u = e.getTypeOf(i);
        return u ? ("arraybuffer" === u ? i = e.transformTo("uint8array", i) : "string" === u && (c ? i = r.decode(i) : o && !0 !== l && (i = s(h = i, t.uint8array ? new Uint8Array(h.length) : new Array(h.length)))), i) : a.Promise.reject(new Error("Can't read the data of '" + n + "'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"));
      });
    };
  }(d)), d;
}
function ge(e) {
  this.name = e || "default", this.streamInfo = {}, this.generatedError = null, this.extraStreamInfo = {}, this.isPaused = !0, this.isFinished = !1, this.isLocked = !1, this._listeners = {
    data: [],
    end: [],
    error: []
  }, this.previous = null;
}
!function (e) {
  if (!e.setImmediate) {
    var t,
      r,
      n,
      a,
      i,
      s = 1,
      o = {},
      l = !1,
      c = e.document,
      h = Object.getPrototypeOf && Object.getPrototypeOf(e);
    h = h && h.setTimeout ? h : e, "[object process]" === {}.toString.call(e.process) ? t = function t(e) {
      process.nextTick(function () {
        d(e);
      });
    } : !function () {
      if (e.postMessage && !e.importScripts) {
        var t = !0,
          r = e.onmessage;
        return e.onmessage = function () {
          t = !1;
        }, e.postMessage("", "*"), e.onmessage = r, t;
      }
    }() ? e.MessageChannel ? ((n = new MessageChannel()).port1.onmessage = function (e) {
      d(e.data);
    }, t = function t(e) {
      n.port2.postMessage(e);
    }) : c && "onreadystatechange" in c.createElement("script") ? (r = c.documentElement, t = function t(e) {
      var t = c.createElement("script");
      t.onreadystatechange = function () {
        d(e), t.onreadystatechange = null, r.removeChild(t), t = null;
      }, r.appendChild(t);
    }) : t = function t(e) {
      setTimeout(d, 0, e);
    } : (a = "setImmediate$" + Math.random() + "$", i = function i(t) {
      t.source === e && "string" == typeof t.data && 0 === t.data.indexOf(a) && d(+t.data.slice(a.length));
    }, e.addEventListener ? e.addEventListener("message", i, !1) : e.attachEvent("onmessage", i), t = function t(_t2) {
      e.postMessage(a + _t2, "*");
    }), h.setImmediate = function (e) {
      "function" != typeof e && (e = new Function("" + e));
      for (var r = new Array(arguments.length - 1), n = 0; n < r.length; n++) r[n] = arguments[n + 1];
      var a = {
        callback: e,
        args: r
      };
      return o[s] = a, t(s), s++;
    }, h.clearImmediate = u;
  }
  function u(e) {
    delete o[e];
  }
  function d(e) {
    if (l) setTimeout(d, 0, e);else {
      var t = o[e];
      if (t) {
        l = !0;
        try {
          !function (e) {
            var t = e.callback,
              r = e.args;
            switch (r.length) {
              case 0:
                t();
                break;
              case 1:
                t(r[0]);
                break;
              case 2:
                t(r[0], r[1]);
                break;
              case 3:
                t(r[0], r[1], r[2]);
                break;
              default:
                t.apply(void 0, r);
            }
          }(t);
        } finally {
          u(e), l = !1;
        }
      }
    }
  }
}("undefined" == typeof self ? a : self), ge.prototype = {
  push: function push(e) {
    this.emit("data", e);
  },
  end: function end() {
    if (this.isFinished) return !1;
    this.flush();
    try {
      this.emit("end"), this.cleanUp(), this.isFinished = !0;
    } catch (e) {
      this.emit("error", e);
    }
    return !0;
  },
  error: function error(e) {
    return !this.isFinished && (this.isPaused ? this.generatedError = e : (this.isFinished = !0, this.emit("error", e), this.previous && this.previous.error(e), this.cleanUp()), !0);
  },
  on: function on(e, t) {
    return this._listeners[e].push(t), this;
  },
  cleanUp: function cleanUp() {
    this.streamInfo = this.generatedError = this.extraStreamInfo = null, this._listeners = [];
  },
  emit: function emit(e, t) {
    if (this._listeners[e]) for (var r = 0; r < this._listeners[e].length; r++) this._listeners[e][r].call(this, t);
  },
  pipe: function pipe(e) {
    return e.registerPrevious(this);
  },
  registerPrevious: function registerPrevious(e) {
    if (this.isLocked) throw new Error("The stream '" + this + "' has already been used.");
    this.streamInfo = e.streamInfo, this.mergeStreamInfo(), this.previous = e;
    var t = this;
    return e.on("data", function (e) {
      t.processChunk(e);
    }), e.on("end", function () {
      t.end();
    }), e.on("error", function (e) {
      t.error(e);
    }), this;
  },
  pause: function pause() {
    return !this.isPaused && !this.isFinished && (this.isPaused = !0, this.previous && this.previous.pause(), !0);
  },
  resume: function resume() {
    if (!this.isPaused || this.isFinished) return !1;
    this.isPaused = !1;
    var e = !1;
    return this.generatedError && (this.error(this.generatedError), e = !0), this.previous && this.previous.resume(), !e;
  },
  flush: function flush() {},
  processChunk: function processChunk(e) {
    this.push(e);
  },
  withStreamInfo: function withStreamInfo(e, t) {
    return this.extraStreamInfo[e] = t, this.mergeStreamInfo(), this;
  },
  mergeStreamInfo: function mergeStreamInfo() {
    for (var e in this.extraStreamInfo) Object.prototype.hasOwnProperty.call(this.extraStreamInfo, e) && (this.streamInfo[e] = this.extraStreamInfo[e]);
  },
  lock: function lock() {
    if (this.isLocked) throw new Error("The stream '" + this + "' has already been used.");
    this.isLocked = !0, this.previous && this.previous.lock();
  },
  toString: function toString() {
    var e = "Worker " + this.name;
    return this.previous ? this.previous + " -> " + e : e;
  }
};
var be = ge;
!function (e) {
  for (var t = me(), r = f, n = ue, a = be, i = new Array(256), s = 0; s < 256; s++) i[s] = s >= 252 ? 6 : s >= 248 ? 5 : s >= 240 ? 4 : s >= 224 ? 3 : s >= 192 ? 2 : 1;
  i[254] = i[254] = 1;
  function o() {
    a.call(this, "utf-8 decode"), this.leftOver = null;
  }
  function l() {
    a.call(this, "utf-8 encode");
  }
  e.utf8encode = function (e) {
    return r.nodebuffer ? n.newBufferFrom(e, "utf-8") : function (e) {
      var t,
        n,
        a,
        i,
        s,
        o = e.length,
        l = 0;
      for (i = 0; i < o; i++) 55296 == (64512 & (n = e.charCodeAt(i))) && i + 1 < o && 56320 == (64512 & (a = e.charCodeAt(i + 1))) && (n = 65536 + (n - 55296 << 10) + (a - 56320), i++), l += n < 128 ? 1 : n < 2048 ? 2 : n < 65536 ? 3 : 4;
      for (t = r.uint8array ? new Uint8Array(l) : new Array(l), s = 0, i = 0; s < l; i++) 55296 == (64512 & (n = e.charCodeAt(i))) && i + 1 < o && 56320 == (64512 & (a = e.charCodeAt(i + 1))) && (n = 65536 + (n - 55296 << 10) + (a - 56320), i++), n < 128 ? t[s++] = n : n < 2048 ? (t[s++] = 192 | n >>> 6, t[s++] = 128 | 63 & n) : n < 65536 ? (t[s++] = 224 | n >>> 12, t[s++] = 128 | n >>> 6 & 63, t[s++] = 128 | 63 & n) : (t[s++] = 240 | n >>> 18, t[s++] = 128 | n >>> 12 & 63, t[s++] = 128 | n >>> 6 & 63, t[s++] = 128 | 63 & n);
      return t;
    }(e);
  }, e.utf8decode = function (e) {
    return r.nodebuffer ? t.transformTo("nodebuffer", e).toString("utf-8") : function (e) {
      var r,
        n,
        a,
        s,
        o = e.length,
        l = new Array(2 * o);
      for (n = 0, r = 0; r < o;) if ((a = e[r++]) < 128) l[n++] = a;else if ((s = i[a]) > 4) l[n++] = 65533, r += s - 1;else {
        for (a &= 2 === s ? 31 : 3 === s ? 15 : 7; s > 1 && r < o;) a = a << 6 | 63 & e[r++], s--;
        s > 1 ? l[n++] = 65533 : a < 65536 ? l[n++] = a : (a -= 65536, l[n++] = 55296 | a >> 10 & 1023, l[n++] = 56320 | 1023 & a);
      }
      return l.length !== n && (l.subarray ? l = l.subarray(0, n) : l.length = n), t.applyFromCharCode(l);
    }(e = t.transformTo(r.uint8array ? "uint8array" : "array", e));
  }, t.inherits(o, a), o.prototype.processChunk = function (n) {
    var a = t.transformTo(r.uint8array ? "uint8array" : "array", n.data);
    if (this.leftOver && this.leftOver.length) {
      if (r.uint8array) {
        var s = a;
        (a = new Uint8Array(s.length + this.leftOver.length)).set(this.leftOver, 0), a.set(s, this.leftOver.length);
      } else a = this.leftOver.concat(a);
      this.leftOver = null;
    }
    var o = function (e, t) {
        var r;
        for ((t = t || e.length) > e.length && (t = e.length), r = t - 1; r >= 0 && 128 == (192 & e[r]);) r--;
        return r < 0 || 0 === r ? t : r + i[e[r]] > t ? r : t;
      }(a),
      l = a;
    o !== a.length && (r.uint8array ? (l = a.subarray(0, o), this.leftOver = a.subarray(o, a.length)) : (l = a.slice(0, o), this.leftOver = a.slice(o, a.length))), this.push({
      data: e.utf8decode(l),
      meta: n.meta
    });
  }, o.prototype.flush = function () {
    this.leftOver && this.leftOver.length && (this.push({
      data: e.utf8decode(this.leftOver),
      meta: {}
    }), this.leftOver = null);
  }, e.Utf8DecodeWorker = o, t.inherits(l, a), l.prototype.processChunk = function (t) {
    this.push({
      data: e.utf8encode(t.data),
      meta: t.meta
    });
  }, e.Utf8EncodeWorker = l;
}(u);
var ye = be,
  ve = me();
function we(e) {
  ye.call(this, "ConvertWorker to " + e), this.destType = e;
}
ve.inherits(we, ye), we.prototype.processChunk = function (e) {
  this.push({
    data: ve.transformTo(this.destType, e.data),
    meta: e.meta
  });
};
var _e,
  ke,
  Se = we;
var xe = me(),
  Ce = Se,
  Ee = be,
  Pe = se(),
  Ae = pe,
  Te = null;
if (f.nodestream) try {
  Te = function () {
    if (ke) return _e;
    ke = 1;
    var e = te().Readable;
    function t(t, r, n) {
      e.call(this, r), this._helper = t;
      var a = this;
      t.on("data", function (e, t) {
        a.push(e) || a._helper.pause(), n && n(t);
      }).on("error", function (e) {
        a.emit("error", e);
      }).on("end", function () {
        a.push(null);
      });
    }
    return me().inherits(t, e), t.prototype._read = function () {
      this._helper.resume();
    }, _e = t;
  }();
} catch (e) {}
function Ne(e, t) {
  return new Ae.Promise(function (r, n) {
    var a = [],
      i = e._internalType,
      s = e._outputType,
      o = e._mimeType;
    e.on("data", function (e, r) {
      a.push(e), t && t(r);
    }).on("error", function (e) {
      a = [], n(e);
    }).on("end", function () {
      try {
        var e = function (e, t, r) {
          switch (e) {
            case "blob":
              return xe.newBlob(xe.transformTo("arraybuffer", t), r);
            case "base64":
              return Pe.encode(t);
            default:
              return xe.transformTo(e, t);
          }
        }(s, function (e, t) {
          var r,
            n = 0,
            a = null,
            i = 0;
          for (r = 0; r < t.length; r++) i += t[r].length;
          switch (e) {
            case "string":
              return t.join("");
            case "array":
              return Array.prototype.concat.apply([], t);
            case "uint8array":
              for (a = new Uint8Array(i), r = 0; r < t.length; r++) a.set(t[r], n), n += t[r].length;
              return a;
            case "nodebuffer":
              return Buffer.concat(t);
            default:
              throw new Error("concat : unsupported type '" + e + "'");
          }
        }(i, a), o);
        r(e);
      } catch (e) {
        n(e);
      }
      a = [];
    }).resume();
  });
}
function Re(e, t, r) {
  var n = t;
  switch (t) {
    case "blob":
    case "arraybuffer":
      n = "uint8array";
      break;
    case "base64":
      n = "string";
  }
  try {
    this._internalType = n, this._outputType = t, this._mimeType = r, xe.checkSupport(n), this._worker = e.pipe(new Ce(n)), e.lock();
  } catch (e) {
    this._worker = new Ee("error"), this._worker.error(e);
  }
}
Re.prototype = {
  accumulate: function accumulate(e) {
    return Ne(this, e);
  },
  on: function on(e, t) {
    var r = this;
    return "data" === e ? this._worker.on(e, function (e) {
      t.call(r, e.data, e.meta);
    }) : this._worker.on(e, function () {
      xe.delay(t, arguments, r);
    }), this;
  },
  resume: function resume() {
    return xe.delay(this._worker.resume, [], this._worker), this;
  },
  pause: function pause() {
    return this._worker.pause(), this;
  },
  toNodejsStream: function toNodejsStream(e) {
    if (xe.checkSupport("nodestream"), "nodebuffer" !== this._outputType) throw new Error(this._outputType + " is not supported by this method");
    return new Te(this, {
      objectMode: "nodebuffer" !== this._outputType
    }, e);
  }
};
var Be = Re,
  Me = {
    base64: !1,
    binary: !1,
    dir: !1,
    createFolders: !0,
    date: null,
    compression: null,
    compressionOptions: null,
    comment: null,
    unixPermissions: null,
    dosPermissions: null
  },
  De = me(),
  Oe = be;
function Ie(e) {
  Oe.call(this, "DataWorker");
  var t = this;
  this.dataIsReady = !1, this.index = 0, this.max = 0, this.data = null, this.type = "", this._tickScheduled = !1, e.then(function (e) {
    t.dataIsReady = !0, t.data = e, t.max = e && e.length || 0, t.type = De.getTypeOf(e), t.isPaused || t._tickAndRepeat();
  }, function (e) {
    t.error(e);
  });
}
De.inherits(Ie, Oe), Ie.prototype.cleanUp = function () {
  Oe.prototype.cleanUp.call(this), this.data = null;
}, Ie.prototype.resume = function () {
  return !!Oe.prototype.resume.call(this) && (!this._tickScheduled && this.dataIsReady && (this._tickScheduled = !0, De.delay(this._tickAndRepeat, [], this)), !0);
}, Ie.prototype._tickAndRepeat = function () {
  this._tickScheduled = !1, this.isPaused || this.isFinished || (this._tick(), this.isFinished || (De.delay(this._tickAndRepeat, [], this), this._tickScheduled = !0));
}, Ie.prototype._tick = function () {
  if (this.isPaused || this.isFinished) return !1;
  var e = null,
    t = Math.min(this.max, this.index + 16384);
  if (this.index >= this.max) return this.end();
  switch (this.type) {
    case "string":
      e = this.data.substring(this.index, t);
      break;
    case "uint8array":
      e = this.data.subarray(this.index, t);
      break;
    case "array":
    case "nodebuffer":
      e = this.data.slice(this.index, t);
  }
  return this.index = t, this.push({
    data: e,
    meta: {
      percent: this.max ? this.index / this.max * 100 : 0
    }
  });
};
var ze = Ie,
  Fe = me();
var Le = function () {
  for (var e, t = [], r = 0; r < 256; r++) {
    e = r;
    for (var n = 0; n < 8; n++) e = 1 & e ? 3988292384 ^ e >>> 1 : e >>> 1;
    t[r] = e;
  }
  return t;
}();
var je = function je(e, t) {
    return void 0 !== e && e.length ? "string" !== Fe.getTypeOf(e) ? function (e, t, r, n) {
      var a = Le,
        i = n + r;
      e = ~e;
      for (var s = n; s < i; s++) e = e >>> 8 ^ a[255 & (e ^ t[s])];
      return ~e;
    }(0 | t, e, e.length, 0) : function (e, t, r, n) {
      var a = Le,
        i = n + r;
      e = ~e;
      for (var s = n; s < i; s++) e = e >>> 8 ^ a[255 & (e ^ t.charCodeAt(s))];
      return ~e;
    }(0 | t, e, e.length, 0) : 0;
  },
  Ue = be,
  $e = je;
function He() {
  Ue.call(this, "Crc32Probe"), this.withStreamInfo("crc32", 0);
}
me().inherits(He, Ue), He.prototype.processChunk = function (e) {
  this.streamInfo.crc32 = $e(e.data, this.streamInfo.crc32 || 0), this.push(e);
};
var We = He,
  Ze = me(),
  Ve = be;
function qe(e) {
  Ve.call(this, "DataLengthProbe for " + e), this.propName = e, this.withStreamInfo(e, 0);
}
Ze.inherits(qe, Ve), qe.prototype.processChunk = function (e) {
  if (e) {
    var t = this.streamInfo[this.propName] || 0;
    this.streamInfo[this.propName] = t + e.data.length;
  }
  Ve.prototype.processChunk.call(this, e);
};
var Xe = pe,
  Ke = ze,
  Ye = We,
  Ge = qe;
function Je(e, t, r, n, a) {
  this.compressedSize = e, this.uncompressedSize = t, this.crc32 = r, this.compression = n, this.compressedContent = a;
}
Je.prototype = {
  getContentWorker: function getContentWorker() {
    var e = new Ke(Xe.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new Ge("data_length")),
      t = this;
    return e.on("end", function () {
      if (this.streamInfo.data_length !== t.uncompressedSize) throw new Error("Bug : uncompressed data size mismatch");
    }), e;
  },
  getCompressedWorker: function getCompressedWorker() {
    return new Ke(Xe.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize", this.compressedSize).withStreamInfo("uncompressedSize", this.uncompressedSize).withStreamInfo("crc32", this.crc32).withStreamInfo("compression", this.compression);
  }
}, Je.createWorkerFrom = function (e, t, r) {
  return e.pipe(new Ye()).pipe(new Ge("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new Ge("compressedSize")).withStreamInfo("compression", t);
};
var Qe = Je,
  et = Be,
  tt = ze,
  rt = u,
  nt = Qe,
  at = be,
  it = function it(e, t, r) {
    this.name = e, this.dir = r.dir, this.date = r.date, this.comment = r.comment, this.unixPermissions = r.unixPermissions, this.dosPermissions = r.dosPermissions, this._data = t, this._dataBinary = r.binary, this.options = {
      compression: r.compression,
      compressionOptions: r.compressionOptions
    };
  };
it.prototype = {
  internalStream: function internalStream(e) {
    var t = null,
      r = "string";
    try {
      if (!e) throw new Error("No output type specified.");
      var n = "string" === (r = e.toLowerCase()) || "text" === r;
      "binarystring" !== r && "text" !== r || (r = "string"), t = this._decompressWorker();
      var a = !this._dataBinary;
      a && !n && (t = t.pipe(new rt.Utf8EncodeWorker())), !a && n && (t = t.pipe(new rt.Utf8DecodeWorker()));
    } catch (e) {
      (t = new at("error")).error(e);
    }
    return new et(t, r, "");
  },
  async: function async(e, t) {
    return this.internalStream(e).accumulate(t);
  },
  nodeStream: function nodeStream(e, t) {
    return this.internalStream(e || "nodebuffer").toNodejsStream(t);
  },
  _compressWorker: function _compressWorker(e, t) {
    if (this._data instanceof nt && this._data.compression.magic === e.magic) return this._data.getCompressedWorker();
    var r = this._decompressWorker();
    return this._dataBinary || (r = r.pipe(new rt.Utf8EncodeWorker())), nt.createWorkerFrom(r, e, t);
  },
  _decompressWorker: function _decompressWorker() {
    return this._data instanceof nt ? this._data.getContentWorker() : this._data instanceof at ? this._data : new tt(this._data);
  }
};
for (var st = ["asText", "asBinary", "asNodeBuffer", "asUint8Array", "asArrayBuffer"], ot = function ot() {
    throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");
  }, lt = 0; lt < st.length; lt++) it.prototype[st[lt]] = ot;
var ct = it,
  ht = {},
  ut = {},
  dt = {},
  ft = {};
!function (e) {
  var t = "undefined" != typeof Uint8Array && "undefined" != typeof Uint16Array && "undefined" != typeof Int32Array;
  function r(e, t) {
    return Object.prototype.hasOwnProperty.call(e, t);
  }
  e.assign = function (e) {
    for (var t = Array.prototype.slice.call(arguments, 1); t.length;) {
      var n = t.shift();
      if (n) {
        if ("object" != _typeof(n)) throw new TypeError(n + "must be non-object");
        for (var a in n) r(n, a) && (e[a] = n[a]);
      }
    }
    return e;
  }, e.shrinkBuf = function (e, t) {
    return e.length === t ? e : e.subarray ? e.subarray(0, t) : (e.length = t, e);
  };
  var n = {
      arraySet: function arraySet(e, t, r, n, a) {
        if (t.subarray && e.subarray) e.set(t.subarray(r, r + n), a);else for (var i = 0; i < n; i++) e[a + i] = t[r + i];
      },
      flattenChunks: function flattenChunks(e) {
        var t, r, n, a, i, s;
        for (n = 0, t = 0, r = e.length; t < r; t++) n += e[t].length;
        for (s = new Uint8Array(n), a = 0, t = 0, r = e.length; t < r; t++) i = e[t], s.set(i, a), a += i.length;
        return s;
      }
    },
    a = {
      arraySet: function arraySet(e, t, r, n, a) {
        for (var i = 0; i < n; i++) e[a + i] = t[r + i];
      },
      flattenChunks: function flattenChunks(e) {
        return [].concat.apply([], e);
      }
    };
  e.setTyped = function (t) {
    t ? (e.Buf8 = Uint8Array, e.Buf16 = Uint16Array, e.Buf32 = Int32Array, e.assign(e, n)) : (e.Buf8 = Array, e.Buf16 = Array, e.Buf32 = Array, e.assign(e, a));
  }, e.setTyped(t);
}(ft);
var pt = {},
  mt = {},
  gt = {},
  bt = ft;
function yt(e) {
  for (var t = e.length; --t >= 0;) e[t] = 0;
}
var vt = 256,
  wt = 286,
  _t = 30,
  kt = 15,
  St = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0],
  xt = [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13],
  Ct = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7],
  Et = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15],
  Pt = new Array(576);
yt(Pt);
var At = new Array(60);
yt(At);
var Tt = new Array(512);
yt(Tt);
var Nt = new Array(256);
yt(Nt);
var Rt = new Array(29);
yt(Rt);
var Bt,
  Mt,
  Dt,
  Ot = new Array(_t);
function It(e, t, r, n, a) {
  this.static_tree = e, this.extra_bits = t, this.extra_base = r, this.elems = n, this.max_length = a, this.has_stree = e && e.length;
}
function zt(e, t) {
  this.dyn_tree = e, this.max_code = 0, this.stat_desc = t;
}
function Ft(e) {
  return e < 256 ? Tt[e] : Tt[256 + (e >>> 7)];
}
function Lt(e, t) {
  e.pending_buf[e.pending++] = 255 & t, e.pending_buf[e.pending++] = t >>> 8 & 255;
}
function jt(e, t, r) {
  e.bi_valid > 16 - r ? (e.bi_buf |= t << e.bi_valid & 65535, Lt(e, e.bi_buf), e.bi_buf = t >> 16 - e.bi_valid, e.bi_valid += r - 16) : (e.bi_buf |= t << e.bi_valid & 65535, e.bi_valid += r);
}
function Ut(e, t, r) {
  jt(e, r[2 * t], r[2 * t + 1]);
}
function $t(e, t) {
  var r = 0;
  do {
    r |= 1 & e, e >>>= 1, r <<= 1;
  } while (--t > 0);
  return r >>> 1;
}
function Ht(e, t, r) {
  var n,
    a,
    i = new Array(16),
    s = 0;
  for (n = 1; n <= kt; n++) i[n] = s = s + r[n - 1] << 1;
  for (a = 0; a <= t; a++) {
    var o = e[2 * a + 1];
    0 !== o && (e[2 * a] = $t(i[o]++, o));
  }
}
function Wt(e) {
  var t;
  for (t = 0; t < wt; t++) e.dyn_ltree[2 * t] = 0;
  for (t = 0; t < _t; t++) e.dyn_dtree[2 * t] = 0;
  for (t = 0; t < 19; t++) e.bl_tree[2 * t] = 0;
  e.dyn_ltree[512] = 1, e.opt_len = e.static_len = 0, e.last_lit = e.matches = 0;
}
function Zt(e) {
  e.bi_valid > 8 ? Lt(e, e.bi_buf) : e.bi_valid > 0 && (e.pending_buf[e.pending++] = e.bi_buf), e.bi_buf = 0, e.bi_valid = 0;
}
function Vt(e, t, r, n) {
  var a = 2 * t,
    i = 2 * r;
  return e[a] < e[i] || e[a] === e[i] && n[t] <= n[r];
}
function qt(e, t, r) {
  for (var n = e.heap[r], a = r << 1; a <= e.heap_len && (a < e.heap_len && Vt(t, e.heap[a + 1], e.heap[a], e.depth) && a++, !Vt(t, n, e.heap[a], e.depth));) e.heap[r] = e.heap[a], r = a, a <<= 1;
  e.heap[r] = n;
}
function Xt(e, t, r) {
  var n,
    a,
    i,
    s,
    o = 0;
  if (0 !== e.last_lit) do {
    n = e.pending_buf[e.d_buf + 2 * o] << 8 | e.pending_buf[e.d_buf + 2 * o + 1], a = e.pending_buf[e.l_buf + o], o++, 0 === n ? Ut(e, a, t) : (Ut(e, (i = Nt[a]) + vt + 1, t), 0 !== (s = St[i]) && jt(e, a -= Rt[i], s), Ut(e, i = Ft(--n), r), 0 !== (s = xt[i]) && jt(e, n -= Ot[i], s));
  } while (o < e.last_lit);
  Ut(e, 256, t);
}
function Kt(e, t) {
  var r,
    n,
    a,
    i = t.dyn_tree,
    s = t.stat_desc.static_tree,
    o = t.stat_desc.has_stree,
    l = t.stat_desc.elems,
    c = -1;
  for (e.heap_len = 0, e.heap_max = 573, r = 0; r < l; r++) 0 !== i[2 * r] ? (e.heap[++e.heap_len] = c = r, e.depth[r] = 0) : i[2 * r + 1] = 0;
  for (; e.heap_len < 2;) i[2 * (a = e.heap[++e.heap_len] = c < 2 ? ++c : 0)] = 1, e.depth[a] = 0, e.opt_len--, o && (e.static_len -= s[2 * a + 1]);
  for (t.max_code = c, r = e.heap_len >> 1; r >= 1; r--) qt(e, i, r);
  a = l;
  do {
    r = e.heap[1], e.heap[1] = e.heap[e.heap_len--], qt(e, i, 1), n = e.heap[1], e.heap[--e.heap_max] = r, e.heap[--e.heap_max] = n, i[2 * a] = i[2 * r] + i[2 * n], e.depth[a] = (e.depth[r] >= e.depth[n] ? e.depth[r] : e.depth[n]) + 1, i[2 * r + 1] = i[2 * n + 1] = a, e.heap[1] = a++, qt(e, i, 1);
  } while (e.heap_len >= 2);
  e.heap[--e.heap_max] = e.heap[1], function (e, t) {
    var r,
      n,
      a,
      i,
      s,
      o,
      l = t.dyn_tree,
      c = t.max_code,
      h = t.stat_desc.static_tree,
      u = t.stat_desc.has_stree,
      d = t.stat_desc.extra_bits,
      f = t.stat_desc.extra_base,
      p = t.stat_desc.max_length,
      m = 0;
    for (i = 0; i <= kt; i++) e.bl_count[i] = 0;
    for (l[2 * e.heap[e.heap_max] + 1] = 0, r = e.heap_max + 1; r < 573; r++) (i = l[2 * l[2 * (n = e.heap[r]) + 1] + 1] + 1) > p && (i = p, m++), l[2 * n + 1] = i, n > c || (e.bl_count[i]++, s = 0, n >= f && (s = d[n - f]), o = l[2 * n], e.opt_len += o * (i + s), u && (e.static_len += o * (h[2 * n + 1] + s)));
    if (0 !== m) {
      do {
        for (i = p - 1; 0 === e.bl_count[i];) i--;
        e.bl_count[i]--, e.bl_count[i + 1] += 2, e.bl_count[p]--, m -= 2;
      } while (m > 0);
      for (i = p; 0 !== i; i--) for (n = e.bl_count[i]; 0 !== n;) (a = e.heap[--r]) > c || (l[2 * a + 1] !== i && (e.opt_len += (i - l[2 * a + 1]) * l[2 * a], l[2 * a + 1] = i), n--);
    }
  }(e, t), Ht(i, c, e.bl_count);
}
function Yt(e, t, r) {
  var n,
    a,
    i = -1,
    s = t[1],
    o = 0,
    l = 7,
    c = 4;
  for (0 === s && (l = 138, c = 3), t[2 * (r + 1) + 1] = 65535, n = 0; n <= r; n++) a = s, s = t[2 * (n + 1) + 1], ++o < l && a === s || (o < c ? e.bl_tree[2 * a] += o : 0 !== a ? (a !== i && e.bl_tree[2 * a]++, e.bl_tree[32]++) : o <= 10 ? e.bl_tree[34]++ : e.bl_tree[36]++, o = 0, i = a, 0 === s ? (l = 138, c = 3) : a === s ? (l = 6, c = 3) : (l = 7, c = 4));
}
function Gt(e, t, r) {
  var n,
    a,
    i = -1,
    s = t[1],
    o = 0,
    l = 7,
    c = 4;
  for (0 === s && (l = 138, c = 3), n = 0; n <= r; n++) if (a = s, s = t[2 * (n + 1) + 1], !(++o < l && a === s)) {
    if (o < c) do {
      Ut(e, a, e.bl_tree);
    } while (0 != --o);else 0 !== a ? (a !== i && (Ut(e, a, e.bl_tree), o--), Ut(e, 16, e.bl_tree), jt(e, o - 3, 2)) : o <= 10 ? (Ut(e, 17, e.bl_tree), jt(e, o - 3, 3)) : (Ut(e, 18, e.bl_tree), jt(e, o - 11, 7));
    o = 0, i = a, 0 === s ? (l = 138, c = 3) : a === s ? (l = 6, c = 3) : (l = 7, c = 4);
  }
}
yt(Ot);
var Jt = !1;
function Qt(e, t, r, n) {
  jt(e, 0 + (n ? 1 : 0), 3), function (e, t, r, n) {
    Zt(e), n && (Lt(e, r), Lt(e, ~r)), bt.arraySet(e.pending_buf, e.window, t, r, e.pending), e.pending += r;
  }(e, t, r, !0);
}
gt._tr_init = function (e) {
  Jt || (!function () {
    var e,
      t,
      r,
      n,
      a,
      i = new Array(16);
    for (r = 0, n = 0; n < 28; n++) for (Rt[n] = r, e = 0; e < 1 << St[n]; e++) Nt[r++] = n;
    for (Nt[r - 1] = n, a = 0, n = 0; n < 16; n++) for (Ot[n] = a, e = 0; e < 1 << xt[n]; e++) Tt[a++] = n;
    for (a >>= 7; n < _t; n++) for (Ot[n] = a << 7, e = 0; e < 1 << xt[n] - 7; e++) Tt[256 + a++] = n;
    for (t = 0; t <= kt; t++) i[t] = 0;
    for (e = 0; e <= 143;) Pt[2 * e + 1] = 8, e++, i[8]++;
    for (; e <= 255;) Pt[2 * e + 1] = 9, e++, i[9]++;
    for (; e <= 279;) Pt[2 * e + 1] = 7, e++, i[7]++;
    for (; e <= 287;) Pt[2 * e + 1] = 8, e++, i[8]++;
    for (Ht(Pt, 287, i), e = 0; e < _t; e++) At[2 * e + 1] = 5, At[2 * e] = $t(e, 5);
    Bt = new It(Pt, St, 257, wt, kt), Mt = new It(At, xt, 0, _t, kt), Dt = new It(new Array(0), Ct, 0, 19, 7);
  }(), Jt = !0), e.l_desc = new zt(e.dyn_ltree, Bt), e.d_desc = new zt(e.dyn_dtree, Mt), e.bl_desc = new zt(e.bl_tree, Dt), e.bi_buf = 0, e.bi_valid = 0, Wt(e);
}, gt._tr_stored_block = Qt, gt._tr_flush_block = function (e, t, r, n) {
  var a,
    i,
    s = 0;
  e.level > 0 ? (2 === e.strm.data_type && (e.strm.data_type = function (e) {
    var t,
      r = 4093624447;
    for (t = 0; t <= 31; t++, r >>>= 1) if (1 & r && 0 !== e.dyn_ltree[2 * t]) return 0;
    if (0 !== e.dyn_ltree[18] || 0 !== e.dyn_ltree[20] || 0 !== e.dyn_ltree[26]) return 1;
    for (t = 32; t < vt; t++) if (0 !== e.dyn_ltree[2 * t]) return 1;
    return 0;
  }(e)), Kt(e, e.l_desc), Kt(e, e.d_desc), s = function (e) {
    var t;
    for (Yt(e, e.dyn_ltree, e.l_desc.max_code), Yt(e, e.dyn_dtree, e.d_desc.max_code), Kt(e, e.bl_desc), t = 18; t >= 3 && 0 === e.bl_tree[2 * Et[t] + 1]; t--);
    return e.opt_len += 3 * (t + 1) + 5 + 5 + 4, t;
  }(e), a = e.opt_len + 3 + 7 >>> 3, (i = e.static_len + 3 + 7 >>> 3) <= a && (a = i)) : a = i = r + 5, r + 4 <= a && -1 !== t ? Qt(e, t, r, n) : 4 === e.strategy || i === a ? (jt(e, 2 + (n ? 1 : 0), 3), Xt(e, Pt, At)) : (jt(e, 4 + (n ? 1 : 0), 3), function (e, t, r, n) {
    var a;
    for (jt(e, t - 257, 5), jt(e, r - 1, 5), jt(e, n - 4, 4), a = 0; a < n; a++) jt(e, e.bl_tree[2 * Et[a] + 1], 3);
    Gt(e, e.dyn_ltree, t - 1), Gt(e, e.dyn_dtree, r - 1);
  }(e, e.l_desc.max_code + 1, e.d_desc.max_code + 1, s + 1), Xt(e, e.dyn_ltree, e.dyn_dtree)), Wt(e), n && Zt(e);
}, gt._tr_tally = function (e, t, r) {
  return e.pending_buf[e.d_buf + 2 * e.last_lit] = t >>> 8 & 255, e.pending_buf[e.d_buf + 2 * e.last_lit + 1] = 255 & t, e.pending_buf[e.l_buf + e.last_lit] = 255 & r, e.last_lit++, 0 === t ? e.dyn_ltree[2 * r]++ : (e.matches++, t--, e.dyn_ltree[2 * (Nt[r] + vt + 1)]++, e.dyn_dtree[2 * Ft(t)]++), e.last_lit === e.lit_bufsize - 1;
}, gt._tr_align = function (e) {
  jt(e, 2, 3), Ut(e, 256, Pt), function (e) {
    16 === e.bi_valid ? (Lt(e, e.bi_buf), e.bi_buf = 0, e.bi_valid = 0) : e.bi_valid >= 8 && (e.pending_buf[e.pending++] = 255 & e.bi_buf, e.bi_buf >>= 8, e.bi_valid -= 8);
  }(e);
};
var er = function er(e, t, r, n) {
  for (var a = 65535 & e, i = e >>> 16 & 65535, s = 0; 0 !== r;) {
    r -= s = r > 2e3 ? 2e3 : r;
    do {
      i = i + (a = a + t[n++] | 0) | 0;
    } while (--s);
    a %= 65521, i %= 65521;
  }
  return a | i << 16;
};
var tr = function () {
  for (var e, t = [], r = 0; r < 256; r++) {
    e = r;
    for (var n = 0; n < 8; n++) e = 1 & e ? 3988292384 ^ e >>> 1 : e >>> 1;
    t[r] = e;
  }
  return t;
}();
var rr,
  nr = function nr(e, t, r, n) {
    var a = tr,
      i = n + r;
    e ^= -1;
    for (var s = n; s < i; s++) e = e >>> 8 ^ a[255 & (e ^ t[s])];
    return ~e;
  },
  ar = {
    2: "need dictionary",
    1: "stream end",
    0: "",
    "-1": "file error",
    "-2": "stream error",
    "-3": "data error",
    "-4": "insufficient memory",
    "-5": "buffer error",
    "-6": "incompatible version"
  },
  ir = ft,
  sr = gt,
  or = er,
  lr = nr,
  cr = ar,
  hr = -2,
  ur = 258,
  dr = 262,
  fr = 103,
  pr = 113,
  mr = 666;
function gr(e, t) {
  return e.msg = cr[t], t;
}
function br(e) {
  return (e << 1) - (e > 4 ? 9 : 0);
}
function yr(e) {
  for (var t = e.length; --t >= 0;) e[t] = 0;
}
function vr(e) {
  var t = e.state,
    r = t.pending;
  r > e.avail_out && (r = e.avail_out), 0 !== r && (ir.arraySet(e.output, t.pending_buf, t.pending_out, r, e.next_out), e.next_out += r, t.pending_out += r, e.total_out += r, e.avail_out -= r, t.pending -= r, 0 === t.pending && (t.pending_out = 0));
}
function wr(e, t) {
  sr._tr_flush_block(e, e.block_start >= 0 ? e.block_start : -1, e.strstart - e.block_start, t), e.block_start = e.strstart, vr(e.strm);
}
function _r(e, t) {
  e.pending_buf[e.pending++] = t;
}
function kr(e, t) {
  e.pending_buf[e.pending++] = t >>> 8 & 255, e.pending_buf[e.pending++] = 255 & t;
}
function Sr(e, t) {
  var r,
    n,
    a = e.max_chain_length,
    i = e.strstart,
    s = e.prev_length,
    o = e.nice_match,
    l = e.strstart > e.w_size - dr ? e.strstart - (e.w_size - dr) : 0,
    c = e.window,
    h = e.w_mask,
    u = e.prev,
    d = e.strstart + ur,
    f = c[i + s - 1],
    p = c[i + s];
  e.prev_length >= e.good_match && (a >>= 2), o > e.lookahead && (o = e.lookahead);
  do {
    if (c[(r = t) + s] === p && c[r + s - 1] === f && c[r] === c[i] && c[++r] === c[i + 1]) {
      i += 2, r++;
      do {} while (c[++i] === c[++r] && c[++i] === c[++r] && c[++i] === c[++r] && c[++i] === c[++r] && c[++i] === c[++r] && c[++i] === c[++r] && c[++i] === c[++r] && c[++i] === c[++r] && i < d);
      if (n = ur - (d - i), i = d - ur, n > s) {
        if (e.match_start = t, s = n, n >= o) break;
        f = c[i + s - 1], p = c[i + s];
      }
    }
  } while ((t = u[t & h]) > l && 0 != --a);
  return s <= e.lookahead ? s : e.lookahead;
}
function xr(e) {
  var t,
    r,
    n,
    a,
    i,
    s,
    o,
    l,
    c,
    h,
    u = e.w_size;
  do {
    if (a = e.window_size - e.lookahead - e.strstart, e.strstart >= u + (u - dr)) {
      ir.arraySet(e.window, e.window, u, u, 0), e.match_start -= u, e.strstart -= u, e.block_start -= u, t = r = e.hash_size;
      do {
        n = e.head[--t], e.head[t] = n >= u ? n - u : 0;
      } while (--r);
      t = r = u;
      do {
        n = e.prev[--t], e.prev[t] = n >= u ? n - u : 0;
      } while (--r);
      a += u;
    }
    if (0 === e.strm.avail_in) break;
    if (s = e.strm, o = e.window, l = e.strstart + e.lookahead, c = a, h = void 0, (h = s.avail_in) > c && (h = c), r = 0 === h ? 0 : (s.avail_in -= h, ir.arraySet(o, s.input, s.next_in, h, l), 1 === s.state.wrap ? s.adler = or(s.adler, o, h, l) : 2 === s.state.wrap && (s.adler = lr(s.adler, o, h, l)), s.next_in += h, s.total_in += h, h), e.lookahead += r, e.lookahead + e.insert >= 3) for (i = e.strstart - e.insert, e.ins_h = e.window[i], e.ins_h = (e.ins_h << e.hash_shift ^ e.window[i + 1]) & e.hash_mask; e.insert && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[i + 3 - 1]) & e.hash_mask, e.prev[i & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = i, i++, e.insert--, !(e.lookahead + e.insert < 3)););
  } while (e.lookahead < dr && 0 !== e.strm.avail_in);
}
function Cr(e, t) {
  for (var r, n;;) {
    if (e.lookahead < dr) {
      if (xr(e), e.lookahead < dr && 0 === t) return 1;
      if (0 === e.lookahead) break;
    }
    if (r = 0, e.lookahead >= 3 && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 3 - 1]) & e.hash_mask, r = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart), 0 !== r && e.strstart - r <= e.w_size - dr && (e.match_length = Sr(e, r)), e.match_length >= 3) {
      if (n = sr._tr_tally(e, e.strstart - e.match_start, e.match_length - 3), e.lookahead -= e.match_length, e.match_length <= e.max_lazy_match && e.lookahead >= 3) {
        e.match_length--;
        do {
          e.strstart++, e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 3 - 1]) & e.hash_mask, r = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart;
        } while (0 != --e.match_length);
        e.strstart++;
      } else e.strstart += e.match_length, e.match_length = 0, e.ins_h = e.window[e.strstart], e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 1]) & e.hash_mask;
    } else n = sr._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++;
    if (n && (wr(e, !1), 0 === e.strm.avail_out)) return 1;
  }
  return e.insert = e.strstart < 2 ? e.strstart : 2, 4 === t ? (wr(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.last_lit && (wr(e, !1), 0 === e.strm.avail_out) ? 1 : 2;
}
function Er(e, t) {
  for (var r, n, a;;) {
    if (e.lookahead < dr) {
      if (xr(e), e.lookahead < dr && 0 === t) return 1;
      if (0 === e.lookahead) break;
    }
    if (r = 0, e.lookahead >= 3 && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 3 - 1]) & e.hash_mask, r = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart), e.prev_length = e.match_length, e.prev_match = e.match_start, e.match_length = 2, 0 !== r && e.prev_length < e.max_lazy_match && e.strstart - r <= e.w_size - dr && (e.match_length = Sr(e, r), e.match_length <= 5 && (1 === e.strategy || 3 === e.match_length && e.strstart - e.match_start > 4096) && (e.match_length = 2)), e.prev_length >= 3 && e.match_length <= e.prev_length) {
      a = e.strstart + e.lookahead - 3, n = sr._tr_tally(e, e.strstart - 1 - e.prev_match, e.prev_length - 3), e.lookahead -= e.prev_length - 1, e.prev_length -= 2;
      do {
        ++e.strstart <= a && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 3 - 1]) & e.hash_mask, r = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart);
      } while (0 != --e.prev_length);
      if (e.match_available = 0, e.match_length = 2, e.strstart++, n && (wr(e, !1), 0 === e.strm.avail_out)) return 1;
    } else if (e.match_available) {
      if ((n = sr._tr_tally(e, 0, e.window[e.strstart - 1])) && wr(e, !1), e.strstart++, e.lookahead--, 0 === e.strm.avail_out) return 1;
    } else e.match_available = 1, e.strstart++, e.lookahead--;
  }
  return e.match_available && (n = sr._tr_tally(e, 0, e.window[e.strstart - 1]), e.match_available = 0), e.insert = e.strstart < 2 ? e.strstart : 2, 4 === t ? (wr(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.last_lit && (wr(e, !1), 0 === e.strm.avail_out) ? 1 : 2;
}
function Pr(e, t, r, n, a) {
  this.good_length = e, this.max_lazy = t, this.nice_length = r, this.max_chain = n, this.func = a;
}
function Ar() {
  this.strm = null, this.status = 0, this.pending_buf = null, this.pending_buf_size = 0, this.pending_out = 0, this.pending = 0, this.wrap = 0, this.gzhead = null, this.gzindex = 0, this.method = 8, this.last_flush = -1, this.w_size = 0, this.w_bits = 0, this.w_mask = 0, this.window = null, this.window_size = 0, this.prev = null, this.head = null, this.ins_h = 0, this.hash_size = 0, this.hash_bits = 0, this.hash_mask = 0, this.hash_shift = 0, this.block_start = 0, this.match_length = 0, this.prev_match = 0, this.match_available = 0, this.strstart = 0, this.match_start = 0, this.lookahead = 0, this.prev_length = 0, this.max_chain_length = 0, this.max_lazy_match = 0, this.level = 0, this.strategy = 0, this.good_match = 0, this.nice_match = 0, this.dyn_ltree = new ir.Buf16(1146), this.dyn_dtree = new ir.Buf16(122), this.bl_tree = new ir.Buf16(78), yr(this.dyn_ltree), yr(this.dyn_dtree), yr(this.bl_tree), this.l_desc = null, this.d_desc = null, this.bl_desc = null, this.bl_count = new ir.Buf16(16), this.heap = new ir.Buf16(573), yr(this.heap), this.heap_len = 0, this.heap_max = 0, this.depth = new ir.Buf16(573), yr(this.depth), this.l_buf = 0, this.lit_bufsize = 0, this.last_lit = 0, this.d_buf = 0, this.opt_len = 0, this.static_len = 0, this.matches = 0, this.insert = 0, this.bi_buf = 0, this.bi_valid = 0;
}
function Tr(e) {
  var t;
  return e && e.state ? (e.total_in = e.total_out = 0, e.data_type = 2, (t = e.state).pending = 0, t.pending_out = 0, t.wrap < 0 && (t.wrap = -t.wrap), t.status = t.wrap ? 42 : pr, e.adler = 2 === t.wrap ? 0 : 1, t.last_flush = 0, sr._tr_init(t), 0) : gr(e, hr);
}
function Nr(e) {
  var t,
    r = Tr(e);
  return 0 === r && ((t = e.state).window_size = 2 * t.w_size, yr(t.head), t.max_lazy_match = rr[t.level].max_lazy, t.good_match = rr[t.level].good_length, t.nice_match = rr[t.level].nice_length, t.max_chain_length = rr[t.level].max_chain, t.strstart = 0, t.block_start = 0, t.lookahead = 0, t.insert = 0, t.match_length = t.prev_length = 2, t.match_available = 0, t.ins_h = 0), r;
}
function Rr(e, t, r, n, a, i) {
  if (!e) return hr;
  var s = 1;
  if (-1 === t && (t = 6), n < 0 ? (s = 0, n = -n) : n > 15 && (s = 2, n -= 16), a < 1 || a > 9 || 8 !== r || n < 8 || n > 15 || t < 0 || t > 9 || i < 0 || i > 4) return gr(e, hr);
  8 === n && (n = 9);
  var o = new Ar();
  return e.state = o, o.strm = e, o.wrap = s, o.gzhead = null, o.w_bits = n, o.w_size = 1 << o.w_bits, o.w_mask = o.w_size - 1, o.hash_bits = a + 7, o.hash_size = 1 << o.hash_bits, o.hash_mask = o.hash_size - 1, o.hash_shift = ~~((o.hash_bits + 3 - 1) / 3), o.window = new ir.Buf8(2 * o.w_size), o.head = new ir.Buf16(o.hash_size), o.prev = new ir.Buf16(o.w_size), o.lit_bufsize = 1 << a + 6, o.pending_buf_size = 4 * o.lit_bufsize, o.pending_buf = new ir.Buf8(o.pending_buf_size), o.d_buf = 1 * o.lit_bufsize, o.l_buf = 3 * o.lit_bufsize, o.level = t, o.strategy = i, o.method = r, Nr(e);
}
rr = [new Pr(0, 0, 0, 0, function (e, t) {
  var r = 65535;
  for (r > e.pending_buf_size - 5 && (r = e.pending_buf_size - 5);;) {
    if (e.lookahead <= 1) {
      if (xr(e), 0 === e.lookahead && 0 === t) return 1;
      if (0 === e.lookahead) break;
    }
    e.strstart += e.lookahead, e.lookahead = 0;
    var n = e.block_start + r;
    if ((0 === e.strstart || e.strstart >= n) && (e.lookahead = e.strstart - n, e.strstart = n, wr(e, !1), 0 === e.strm.avail_out)) return 1;
    if (e.strstart - e.block_start >= e.w_size - dr && (wr(e, !1), 0 === e.strm.avail_out)) return 1;
  }
  return e.insert = 0, 4 === t ? (wr(e, !0), 0 === e.strm.avail_out ? 3 : 4) : (e.strstart > e.block_start && (wr(e, !1), e.strm.avail_out), 1);
}), new Pr(4, 4, 8, 4, Cr), new Pr(4, 5, 16, 8, Cr), new Pr(4, 6, 32, 32, Cr), new Pr(4, 4, 16, 16, Er), new Pr(8, 16, 32, 32, Er), new Pr(8, 16, 128, 128, Er), new Pr(8, 32, 128, 256, Er), new Pr(32, 128, 258, 1024, Er), new Pr(32, 258, 258, 4096, Er)], mt.deflateInit = function (e, t) {
  return Rr(e, t, 8, 15, 8, 0);
}, mt.deflateInit2 = Rr, mt.deflateReset = Nr, mt.deflateResetKeep = Tr, mt.deflateSetHeader = function (e, t) {
  return e && e.state ? 2 !== e.state.wrap ? hr : (e.state.gzhead = t, 0) : hr;
}, mt.deflate = function (e, t) {
  var r, n, a, i;
  if (!e || !e.state || t > 5 || t < 0) return e ? gr(e, hr) : hr;
  if (n = e.state, !e.output || !e.input && 0 !== e.avail_in || n.status === mr && 4 !== t) return gr(e, 0 === e.avail_out ? -5 : hr);
  if (n.strm = e, r = n.last_flush, n.last_flush = t, 42 === n.status) if (2 === n.wrap) e.adler = 0, _r(n, 31), _r(n, 139), _r(n, 8), n.gzhead ? (_r(n, (n.gzhead.text ? 1 : 0) + (n.gzhead.hcrc ? 2 : 0) + (n.gzhead.extra ? 4 : 0) + (n.gzhead.name ? 8 : 0) + (n.gzhead.comment ? 16 : 0)), _r(n, 255 & n.gzhead.time), _r(n, n.gzhead.time >> 8 & 255), _r(n, n.gzhead.time >> 16 & 255), _r(n, n.gzhead.time >> 24 & 255), _r(n, 9 === n.level ? 2 : n.strategy >= 2 || n.level < 2 ? 4 : 0), _r(n, 255 & n.gzhead.os), n.gzhead.extra && n.gzhead.extra.length && (_r(n, 255 & n.gzhead.extra.length), _r(n, n.gzhead.extra.length >> 8 & 255)), n.gzhead.hcrc && (e.adler = lr(e.adler, n.pending_buf, n.pending, 0)), n.gzindex = 0, n.status = 69) : (_r(n, 0), _r(n, 0), _r(n, 0), _r(n, 0), _r(n, 0), _r(n, 9 === n.level ? 2 : n.strategy >= 2 || n.level < 2 ? 4 : 0), _r(n, 3), n.status = pr);else {
    var s = 8 + (n.w_bits - 8 << 4) << 8;
    s |= (n.strategy >= 2 || n.level < 2 ? 0 : n.level < 6 ? 1 : 6 === n.level ? 2 : 3) << 6, 0 !== n.strstart && (s |= 32), s += 31 - s % 31, n.status = pr, kr(n, s), 0 !== n.strstart && (kr(n, e.adler >>> 16), kr(n, 65535 & e.adler)), e.adler = 1;
  }
  if (69 === n.status) if (n.gzhead.extra) {
    for (a = n.pending; n.gzindex < (65535 & n.gzhead.extra.length) && (n.pending !== n.pending_buf_size || (n.gzhead.hcrc && n.pending > a && (e.adler = lr(e.adler, n.pending_buf, n.pending - a, a)), vr(e), a = n.pending, n.pending !== n.pending_buf_size));) _r(n, 255 & n.gzhead.extra[n.gzindex]), n.gzindex++;
    n.gzhead.hcrc && n.pending > a && (e.adler = lr(e.adler, n.pending_buf, n.pending - a, a)), n.gzindex === n.gzhead.extra.length && (n.gzindex = 0, n.status = 73);
  } else n.status = 73;
  if (73 === n.status) if (n.gzhead.name) {
    a = n.pending;
    do {
      if (n.pending === n.pending_buf_size && (n.gzhead.hcrc && n.pending > a && (e.adler = lr(e.adler, n.pending_buf, n.pending - a, a)), vr(e), a = n.pending, n.pending === n.pending_buf_size)) {
        i = 1;
        break;
      }
      i = n.gzindex < n.gzhead.name.length ? 255 & n.gzhead.name.charCodeAt(n.gzindex++) : 0, _r(n, i);
    } while (0 !== i);
    n.gzhead.hcrc && n.pending > a && (e.adler = lr(e.adler, n.pending_buf, n.pending - a, a)), 0 === i && (n.gzindex = 0, n.status = 91);
  } else n.status = 91;
  if (91 === n.status) if (n.gzhead.comment) {
    a = n.pending;
    do {
      if (n.pending === n.pending_buf_size && (n.gzhead.hcrc && n.pending > a && (e.adler = lr(e.adler, n.pending_buf, n.pending - a, a)), vr(e), a = n.pending, n.pending === n.pending_buf_size)) {
        i = 1;
        break;
      }
      i = n.gzindex < n.gzhead.comment.length ? 255 & n.gzhead.comment.charCodeAt(n.gzindex++) : 0, _r(n, i);
    } while (0 !== i);
    n.gzhead.hcrc && n.pending > a && (e.adler = lr(e.adler, n.pending_buf, n.pending - a, a)), 0 === i && (n.status = fr);
  } else n.status = fr;
  if (n.status === fr && (n.gzhead.hcrc ? (n.pending + 2 > n.pending_buf_size && vr(e), n.pending + 2 <= n.pending_buf_size && (_r(n, 255 & e.adler), _r(n, e.adler >> 8 & 255), e.adler = 0, n.status = pr)) : n.status = pr), 0 !== n.pending) {
    if (vr(e), 0 === e.avail_out) return n.last_flush = -1, 0;
  } else if (0 === e.avail_in && br(t) <= br(r) && 4 !== t) return gr(e, -5);
  if (n.status === mr && 0 !== e.avail_in) return gr(e, -5);
  if (0 !== e.avail_in || 0 !== n.lookahead || 0 !== t && n.status !== mr) {
    var o = 2 === n.strategy ? function (e, t) {
      for (var r;;) {
        if (0 === e.lookahead && (xr(e), 0 === e.lookahead)) {
          if (0 === t) return 1;
          break;
        }
        if (e.match_length = 0, r = sr._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++, r && (wr(e, !1), 0 === e.strm.avail_out)) return 1;
      }
      return e.insert = 0, 4 === t ? (wr(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.last_lit && (wr(e, !1), 0 === e.strm.avail_out) ? 1 : 2;
    }(n, t) : 3 === n.strategy ? function (e, t) {
      for (var r, n, a, i, s = e.window;;) {
        if (e.lookahead <= ur) {
          if (xr(e), e.lookahead <= ur && 0 === t) return 1;
          if (0 === e.lookahead) break;
        }
        if (e.match_length = 0, e.lookahead >= 3 && e.strstart > 0 && (n = s[a = e.strstart - 1]) === s[++a] && n === s[++a] && n === s[++a]) {
          i = e.strstart + ur;
          do {} while (n === s[++a] && n === s[++a] && n === s[++a] && n === s[++a] && n === s[++a] && n === s[++a] && n === s[++a] && n === s[++a] && a < i);
          e.match_length = ur - (i - a), e.match_length > e.lookahead && (e.match_length = e.lookahead);
        }
        if (e.match_length >= 3 ? (r = sr._tr_tally(e, 1, e.match_length - 3), e.lookahead -= e.match_length, e.strstart += e.match_length, e.match_length = 0) : (r = sr._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++), r && (wr(e, !1), 0 === e.strm.avail_out)) return 1;
      }
      return e.insert = 0, 4 === t ? (wr(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.last_lit && (wr(e, !1), 0 === e.strm.avail_out) ? 1 : 2;
    }(n, t) : rr[n.level].func(n, t);
    if (3 !== o && 4 !== o || (n.status = mr), 1 === o || 3 === o) return 0 === e.avail_out && (n.last_flush = -1), 0;
    if (2 === o && (1 === t ? sr._tr_align(n) : 5 !== t && (sr._tr_stored_block(n, 0, 0, !1), 3 === t && (yr(n.head), 0 === n.lookahead && (n.strstart = 0, n.block_start = 0, n.insert = 0))), vr(e), 0 === e.avail_out)) return n.last_flush = -1, 0;
  }
  return 4 !== t ? 0 : n.wrap <= 0 ? 1 : (2 === n.wrap ? (_r(n, 255 & e.adler), _r(n, e.adler >> 8 & 255), _r(n, e.adler >> 16 & 255), _r(n, e.adler >> 24 & 255), _r(n, 255 & e.total_in), _r(n, e.total_in >> 8 & 255), _r(n, e.total_in >> 16 & 255), _r(n, e.total_in >> 24 & 255)) : (kr(n, e.adler >>> 16), kr(n, 65535 & e.adler)), vr(e), n.wrap > 0 && (n.wrap = -n.wrap), 0 !== n.pending ? 0 : 1);
}, mt.deflateEnd = function (e) {
  var t;
  return e && e.state ? 42 !== (t = e.state.status) && 69 !== t && 73 !== t && 91 !== t && t !== fr && t !== pr && t !== mr ? gr(e, hr) : (e.state = null, t === pr ? gr(e, -3) : 0) : hr;
}, mt.deflateSetDictionary = function (e, t) {
  var r,
    n,
    a,
    i,
    s,
    o,
    l,
    c,
    h = t.length;
  if (!e || !e.state) return hr;
  if (2 === (i = (r = e.state).wrap) || 1 === i && 42 !== r.status || r.lookahead) return hr;
  for (1 === i && (e.adler = or(e.adler, t, h, 0)), r.wrap = 0, h >= r.w_size && (0 === i && (yr(r.head), r.strstart = 0, r.block_start = 0, r.insert = 0), c = new ir.Buf8(r.w_size), ir.arraySet(c, t, h - r.w_size, r.w_size, 0), t = c, h = r.w_size), s = e.avail_in, o = e.next_in, l = e.input, e.avail_in = h, e.next_in = 0, e.input = t, xr(r); r.lookahead >= 3;) {
    n = r.strstart, a = r.lookahead - 2;
    do {
      r.ins_h = (r.ins_h << r.hash_shift ^ r.window[n + 3 - 1]) & r.hash_mask, r.prev[n & r.w_mask] = r.head[r.ins_h], r.head[r.ins_h] = n, n++;
    } while (--a);
    r.strstart = n, r.lookahead = 2, xr(r);
  }
  return r.strstart += r.lookahead, r.block_start = r.strstart, r.insert = r.lookahead, r.lookahead = 0, r.match_length = r.prev_length = 2, r.match_available = 0, e.next_in = o, e.input = l, e.avail_in = s, r.wrap = i, 0;
}, mt.deflateInfo = "pako deflate (from Nodeca project)";
var Br = {},
  Mr = ft,
  Dr = !0,
  Or = !0;
try {
  String.fromCharCode.apply(null, [0]);
} catch (e) {
  Dr = !1;
}
try {
  String.fromCharCode.apply(null, new Uint8Array(1));
} catch (e) {
  Or = !1;
}
for (var Ir = new Mr.Buf8(256), zr = 0; zr < 256; zr++) Ir[zr] = zr >= 252 ? 6 : zr >= 248 ? 5 : zr >= 240 ? 4 : zr >= 224 ? 3 : zr >= 192 ? 2 : 1;
function Fr(e, t) {
  if (t < 65534 && (e.subarray && Or || !e.subarray && Dr)) return String.fromCharCode.apply(null, Mr.shrinkBuf(e, t));
  for (var r = "", n = 0; n < t; n++) r += String.fromCharCode(e[n]);
  return r;
}
Ir[254] = Ir[254] = 1, Br.string2buf = function (e) {
  var t,
    r,
    n,
    a,
    i,
    s = e.length,
    o = 0;
  for (a = 0; a < s; a++) 55296 == (64512 & (r = e.charCodeAt(a))) && a + 1 < s && 56320 == (64512 & (n = e.charCodeAt(a + 1))) && (r = 65536 + (r - 55296 << 10) + (n - 56320), a++), o += r < 128 ? 1 : r < 2048 ? 2 : r < 65536 ? 3 : 4;
  for (t = new Mr.Buf8(o), i = 0, a = 0; i < o; a++) 55296 == (64512 & (r = e.charCodeAt(a))) && a + 1 < s && 56320 == (64512 & (n = e.charCodeAt(a + 1))) && (r = 65536 + (r - 55296 << 10) + (n - 56320), a++), r < 128 ? t[i++] = r : r < 2048 ? (t[i++] = 192 | r >>> 6, t[i++] = 128 | 63 & r) : r < 65536 ? (t[i++] = 224 | r >>> 12, t[i++] = 128 | r >>> 6 & 63, t[i++] = 128 | 63 & r) : (t[i++] = 240 | r >>> 18, t[i++] = 128 | r >>> 12 & 63, t[i++] = 128 | r >>> 6 & 63, t[i++] = 128 | 63 & r);
  return t;
}, Br.buf2binstring = function (e) {
  return Fr(e, e.length);
}, Br.binstring2buf = function (e) {
  for (var t = new Mr.Buf8(e.length), r = 0, n = t.length; r < n; r++) t[r] = e.charCodeAt(r);
  return t;
}, Br.buf2string = function (e, t) {
  var r,
    n,
    a,
    i,
    s = t || e.length,
    o = new Array(2 * s);
  for (n = 0, r = 0; r < s;) if ((a = e[r++]) < 128) o[n++] = a;else if ((i = Ir[a]) > 4) o[n++] = 65533, r += i - 1;else {
    for (a &= 2 === i ? 31 : 3 === i ? 15 : 7; i > 1 && r < s;) a = a << 6 | 63 & e[r++], i--;
    i > 1 ? o[n++] = 65533 : a < 65536 ? o[n++] = a : (a -= 65536, o[n++] = 55296 | a >> 10 & 1023, o[n++] = 56320 | 1023 & a);
  }
  return Fr(o, n);
}, Br.utf8border = function (e, t) {
  var r;
  for ((t = t || e.length) > e.length && (t = e.length), r = t - 1; r >= 0 && 128 == (192 & e[r]);) r--;
  return r < 0 || 0 === r ? t : r + Ir[e[r]] > t ? r : t;
};
var Lr = function Lr() {
    this.input = null, this.next_in = 0, this.avail_in = 0, this.total_in = 0, this.output = null, this.next_out = 0, this.avail_out = 0, this.total_out = 0, this.msg = "", this.state = null, this.data_type = 2, this.adler = 0;
  },
  jr = mt,
  Ur = ft,
  $r = Br,
  Hr = ar,
  Wr = Lr,
  Zr = Object.prototype.toString;
function Vr(e) {
  if (!(this instanceof Vr)) return new Vr(e);
  this.options = Ur.assign({
    level: -1,
    method: 8,
    chunkSize: 16384,
    windowBits: 15,
    memLevel: 8,
    strategy: 0,
    to: ""
  }, e || {});
  var t = this.options;
  t.raw && t.windowBits > 0 ? t.windowBits = -t.windowBits : t.gzip && t.windowBits > 0 && t.windowBits < 16 && (t.windowBits += 16), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new Wr(), this.strm.avail_out = 0;
  var r = jr.deflateInit2(this.strm, t.level, t.method, t.windowBits, t.memLevel, t.strategy);
  if (0 !== r) throw new Error(Hr[r]);
  if (t.header && jr.deflateSetHeader(this.strm, t.header), t.dictionary) {
    var n;
    if (n = "string" == typeof t.dictionary ? $r.string2buf(t.dictionary) : "[object ArrayBuffer]" === Zr.call(t.dictionary) ? new Uint8Array(t.dictionary) : t.dictionary, 0 !== (r = jr.deflateSetDictionary(this.strm, n))) throw new Error(Hr[r]);
    this._dict_set = !0;
  }
}
function qr(e, t) {
  var r = new Vr(t);
  if (r.push(e, !0), r.err) throw r.msg || Hr[r.err];
  return r.result;
}
Vr.prototype.push = function (e, t) {
  var r,
    n,
    a = this.strm,
    i = this.options.chunkSize;
  if (this.ended) return !1;
  n = t === ~~t ? t : !0 === t ? 4 : 0, "string" == typeof e ? a.input = $r.string2buf(e) : "[object ArrayBuffer]" === Zr.call(e) ? a.input = new Uint8Array(e) : a.input = e, a.next_in = 0, a.avail_in = a.input.length;
  do {
    if (0 === a.avail_out && (a.output = new Ur.Buf8(i), a.next_out = 0, a.avail_out = i), 1 !== (r = jr.deflate(a, n)) && 0 !== r) return this.onEnd(r), this.ended = !0, !1;
    0 !== a.avail_out && (0 !== a.avail_in || 4 !== n && 2 !== n) || ("string" === this.options.to ? this.onData($r.buf2binstring(Ur.shrinkBuf(a.output, a.next_out))) : this.onData(Ur.shrinkBuf(a.output, a.next_out)));
  } while ((a.avail_in > 0 || 0 === a.avail_out) && 1 !== r);
  return 4 === n ? (r = jr.deflateEnd(this.strm), this.onEnd(r), this.ended = !0, 0 === r) : 2 !== n || (this.onEnd(0), a.avail_out = 0, !0);
}, Vr.prototype.onData = function (e) {
  this.chunks.push(e);
}, Vr.prototype.onEnd = function (e) {
  0 === e && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = Ur.flattenChunks(this.chunks)), this.chunks = [], this.err = e, this.msg = this.strm.msg;
}, pt.Deflate = Vr, pt.deflate = qr, pt.deflateRaw = function (e, t) {
  return (t = t || {}).raw = !0, qr(e, t);
}, pt.gzip = function (e, t) {
  return (t = t || {}).gzip = !0, qr(e, t);
};
var Xr = {},
  Kr = {},
  Yr = ft,
  Gr = 15,
  Jr = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0],
  Qr = [16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78],
  en = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 0, 0],
  tn = [16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64],
  rn = ft,
  nn = er,
  an = nr,
  sn = function sn(e, t) {
    var r, n, a, i, s, o, l, c, h, u, d, f, p, m, g, b, y, v, w, _, k, S, x, C, E;
    r = e.state, n = e.next_in, C = e.input, a = n + (e.avail_in - 5), i = e.next_out, E = e.output, s = i - (t - e.avail_out), o = i + (e.avail_out - 257), l = r.dmax, c = r.wsize, h = r.whave, u = r.wnext, d = r.window, f = r.hold, p = r.bits, m = r.lencode, g = r.distcode, b = (1 << r.lenbits) - 1, y = (1 << r.distbits) - 1;
    e: do {
      p < 15 && (f += C[n++] << p, p += 8, f += C[n++] << p, p += 8), v = m[f & b];
      t: for (;;) {
        if (f >>>= w = v >>> 24, p -= w, 0 === (w = v >>> 16 & 255)) E[i++] = 65535 & v;else {
          if (!(16 & w)) {
            if (64 & w) {
              if (32 & w) {
                r.mode = 12;
                break e;
              }
              e.msg = "invalid literal/length code", r.mode = 30;
              break e;
            }
            v = m[(65535 & v) + (f & (1 << w) - 1)];
            continue t;
          }
          for (_ = 65535 & v, (w &= 15) && (p < w && (f += C[n++] << p, p += 8), _ += f & (1 << w) - 1, f >>>= w, p -= w), p < 15 && (f += C[n++] << p, p += 8, f += C[n++] << p, p += 8), v = g[f & y];;) {
            if (f >>>= w = v >>> 24, p -= w, 16 & (w = v >>> 16 & 255)) {
              if (k = 65535 & v, p < (w &= 15) && (f += C[n++] << p, (p += 8) < w && (f += C[n++] << p, p += 8)), (k += f & (1 << w) - 1) > l) {
                e.msg = "invalid distance too far back", r.mode = 30;
                break e;
              }
              if (f >>>= w, p -= w, k > (w = i - s)) {
                if ((w = k - w) > h && r.sane) {
                  e.msg = "invalid distance too far back", r.mode = 30;
                  break e;
                }
                if (S = 0, x = d, 0 === u) {
                  if (S += c - w, w < _) {
                    _ -= w;
                    do {
                      E[i++] = d[S++];
                    } while (--w);
                    S = i - k, x = E;
                  }
                } else if (u < w) {
                  if (S += c + u - w, (w -= u) < _) {
                    _ -= w;
                    do {
                      E[i++] = d[S++];
                    } while (--w);
                    if (S = 0, u < _) {
                      _ -= w = u;
                      do {
                        E[i++] = d[S++];
                      } while (--w);
                      S = i - k, x = E;
                    }
                  }
                } else if (S += u - w, w < _) {
                  _ -= w;
                  do {
                    E[i++] = d[S++];
                  } while (--w);
                  S = i - k, x = E;
                }
                for (; _ > 2;) E[i++] = x[S++], E[i++] = x[S++], E[i++] = x[S++], _ -= 3;
                _ && (E[i++] = x[S++], _ > 1 && (E[i++] = x[S++]));
              } else {
                S = i - k;
                do {
                  E[i++] = E[S++], E[i++] = E[S++], E[i++] = E[S++], _ -= 3;
                } while (_ > 2);
                _ && (E[i++] = E[S++], _ > 1 && (E[i++] = E[S++]));
              }
              break;
            }
            if (64 & w) {
              e.msg = "invalid distance code", r.mode = 30;
              break e;
            }
            v = g[(65535 & v) + (f & (1 << w) - 1)];
          }
        }
        break;
      }
    } while (n < a && i < o);
    n -= _ = p >> 3, f &= (1 << (p -= _ << 3)) - 1, e.next_in = n, e.next_out = i, e.avail_in = n < a ? a - n + 5 : 5 - (n - a), e.avail_out = i < o ? o - i + 257 : 257 - (i - o), r.hold = f, r.bits = p;
  },
  on = function on(e, t, r, n, a, i, s, o) {
    var l,
      c,
      h,
      u,
      d,
      f,
      p,
      m,
      g,
      b = o.bits,
      y = 0,
      v = 0,
      w = 0,
      _ = 0,
      k = 0,
      S = 0,
      x = 0,
      C = 0,
      E = 0,
      P = 0,
      A = null,
      T = 0,
      N = new Yr.Buf16(16),
      R = new Yr.Buf16(16),
      B = null,
      M = 0;
    for (y = 0; y <= Gr; y++) N[y] = 0;
    for (v = 0; v < n; v++) N[t[r + v]]++;
    for (k = b, _ = Gr; _ >= 1 && 0 === N[_]; _--);
    if (k > _ && (k = _), 0 === _) return a[i++] = 20971520, a[i++] = 20971520, o.bits = 1, 0;
    for (w = 1; w < _ && 0 === N[w]; w++);
    for (k < w && (k = w), C = 1, y = 1; y <= Gr; y++) if (C <<= 1, (C -= N[y]) < 0) return -1;
    if (C > 0 && (0 === e || 1 !== _)) return -1;
    for (R[1] = 0, y = 1; y < Gr; y++) R[y + 1] = R[y] + N[y];
    for (v = 0; v < n; v++) 0 !== t[r + v] && (s[R[t[r + v]]++] = v);
    if (0 === e ? (A = B = s, f = 19) : 1 === e ? (A = Jr, T -= 257, B = Qr, M -= 257, f = 256) : (A = en, B = tn, f = -1), P = 0, v = 0, y = w, d = i, S = k, x = 0, h = -1, u = (E = 1 << k) - 1, 1 === e && E > 852 || 2 === e && E > 592) return 1;
    for (;;) {
      p = y - x, s[v] < f ? (m = 0, g = s[v]) : s[v] > f ? (m = B[M + s[v]], g = A[T + s[v]]) : (m = 96, g = 0), l = 1 << y - x, w = c = 1 << S;
      do {
        a[d + (P >> x) + (c -= l)] = p << 24 | m << 16 | g;
      } while (0 !== c);
      for (l = 1 << y - 1; P & l;) l >>= 1;
      if (0 !== l ? (P &= l - 1, P += l) : P = 0, v++, 0 == --N[y]) {
        if (y === _) break;
        y = t[r + s[v]];
      }
      if (y > k && (P & u) !== h) {
        for (0 === x && (x = k), d += w, C = 1 << (S = y - x); S + x < _ && !((C -= N[S + x]) <= 0);) S++, C <<= 1;
        if (E += 1 << S, 1 === e && E > 852 || 2 === e && E > 592) return 1;
        a[h = P & u] = k << 24 | S << 16 | d - i;
      }
    }
    return 0 !== P && (a[d + P] = y - x << 24 | 64 << 16), o.bits = k, 0;
  },
  ln = -2,
  cn = 12,
  hn = 30;
function un(e) {
  return (e >>> 24 & 255) + (e >>> 8 & 65280) + ((65280 & e) << 8) + ((255 & e) << 24);
}
function dn() {
  this.mode = 0, this.last = !1, this.wrap = 0, this.havedict = !1, this.flags = 0, this.dmax = 0, this.check = 0, this.total = 0, this.head = null, this.wbits = 0, this.wsize = 0, this.whave = 0, this.wnext = 0, this.window = null, this.hold = 0, this.bits = 0, this.length = 0, this.offset = 0, this.extra = 0, this.lencode = null, this.distcode = null, this.lenbits = 0, this.distbits = 0, this.ncode = 0, this.nlen = 0, this.ndist = 0, this.have = 0, this.next = null, this.lens = new rn.Buf16(320), this.work = new rn.Buf16(288), this.lendyn = null, this.distdyn = null, this.sane = 0, this.back = 0, this.was = 0;
}
function fn(e) {
  var t;
  return e && e.state ? (t = e.state, e.total_in = e.total_out = t.total = 0, e.msg = "", t.wrap && (e.adler = 1 & t.wrap), t.mode = 1, t.last = 0, t.havedict = 0, t.dmax = 32768, t.head = null, t.hold = 0, t.bits = 0, t.lencode = t.lendyn = new rn.Buf32(852), t.distcode = t.distdyn = new rn.Buf32(592), t.sane = 1, t.back = -1, 0) : ln;
}
function pn(e) {
  var t;
  return e && e.state ? ((t = e.state).wsize = 0, t.whave = 0, t.wnext = 0, fn(e)) : ln;
}
function mn(e, t) {
  var r, n;
  return e && e.state ? (n = e.state, t < 0 ? (r = 0, t = -t) : (r = 1 + (t >> 4), t < 48 && (t &= 15)), t && (t < 8 || t > 15) ? ln : (null !== n.window && n.wbits !== t && (n.window = null), n.wrap = r, n.wbits = t, pn(e))) : ln;
}
function gn(e, t) {
  var r, n;
  return e ? (n = new dn(), e.state = n, n.window = null, 0 !== (r = mn(e, t)) && (e.state = null), r) : ln;
}
var bn,
  yn,
  vn = !0;
function wn(e) {
  if (vn) {
    var t;
    for (bn = new rn.Buf32(512), yn = new rn.Buf32(32), t = 0; t < 144;) e.lens[t++] = 8;
    for (; t < 256;) e.lens[t++] = 9;
    for (; t < 280;) e.lens[t++] = 7;
    for (; t < 288;) e.lens[t++] = 8;
    for (on(1, e.lens, 0, 288, bn, 0, e.work, {
      bits: 9
    }), t = 0; t < 32;) e.lens[t++] = 5;
    on(2, e.lens, 0, 32, yn, 0, e.work, {
      bits: 5
    }), vn = !1;
  }
  e.lencode = bn, e.lenbits = 9, e.distcode = yn, e.distbits = 5;
}
function _n(e, t, r, n) {
  var a,
    i = e.state;
  return null === i.window && (i.wsize = 1 << i.wbits, i.wnext = 0, i.whave = 0, i.window = new rn.Buf8(i.wsize)), n >= i.wsize ? (rn.arraySet(i.window, t, r - i.wsize, i.wsize, 0), i.wnext = 0, i.whave = i.wsize) : ((a = i.wsize - i.wnext) > n && (a = n), rn.arraySet(i.window, t, r - n, a, i.wnext), (n -= a) ? (rn.arraySet(i.window, t, r - n, n, 0), i.wnext = n, i.whave = i.wsize) : (i.wnext += a, i.wnext === i.wsize && (i.wnext = 0), i.whave < i.wsize && (i.whave += a))), 0;
}
Kr.inflateReset = pn, Kr.inflateReset2 = mn, Kr.inflateResetKeep = fn, Kr.inflateInit = function (e) {
  return gn(e, 15);
}, Kr.inflateInit2 = gn, Kr.inflate = function (e, t) {
  var r,
    n,
    a,
    i,
    s,
    o,
    l,
    c,
    h,
    u,
    d,
    f,
    p,
    m,
    g,
    b,
    y,
    v,
    w,
    _,
    k,
    S,
    x,
    C,
    E = 0,
    P = new rn.Buf8(4),
    A = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
  if (!e || !e.state || !e.output || !e.input && 0 !== e.avail_in) return ln;
  (r = e.state).mode === cn && (r.mode = 13), s = e.next_out, a = e.output, l = e.avail_out, i = e.next_in, n = e.input, o = e.avail_in, c = r.hold, h = r.bits, u = o, d = l, S = 0;
  e: for (;;) switch (r.mode) {
    case 1:
      if (0 === r.wrap) {
        r.mode = 13;
        break;
      }
      for (; h < 16;) {
        if (0 === o) break e;
        o--, c += n[i++] << h, h += 8;
      }
      if (2 & r.wrap && 35615 === c) {
        r.check = 0, P[0] = 255 & c, P[1] = c >>> 8 & 255, r.check = an(r.check, P, 2, 0), c = 0, h = 0, r.mode = 2;
        break;
      }
      if (r.flags = 0, r.head && (r.head.done = !1), !(1 & r.wrap) || (((255 & c) << 8) + (c >> 8)) % 31) {
        e.msg = "incorrect header check", r.mode = hn;
        break;
      }
      if (8 != (15 & c)) {
        e.msg = "unknown compression method", r.mode = hn;
        break;
      }
      if (h -= 4, k = 8 + (15 & (c >>>= 4)), 0 === r.wbits) r.wbits = k;else if (k > r.wbits) {
        e.msg = "invalid window size", r.mode = hn;
        break;
      }
      r.dmax = 1 << k, e.adler = r.check = 1, r.mode = 512 & c ? 10 : cn, c = 0, h = 0;
      break;
    case 2:
      for (; h < 16;) {
        if (0 === o) break e;
        o--, c += n[i++] << h, h += 8;
      }
      if (r.flags = c, 8 != (255 & r.flags)) {
        e.msg = "unknown compression method", r.mode = hn;
        break;
      }
      if (57344 & r.flags) {
        e.msg = "unknown header flags set", r.mode = hn;
        break;
      }
      r.head && (r.head.text = c >> 8 & 1), 512 & r.flags && (P[0] = 255 & c, P[1] = c >>> 8 & 255, r.check = an(r.check, P, 2, 0)), c = 0, h = 0, r.mode = 3;
    case 3:
      for (; h < 32;) {
        if (0 === o) break e;
        o--, c += n[i++] << h, h += 8;
      }
      r.head && (r.head.time = c), 512 & r.flags && (P[0] = 255 & c, P[1] = c >>> 8 & 255, P[2] = c >>> 16 & 255, P[3] = c >>> 24 & 255, r.check = an(r.check, P, 4, 0)), c = 0, h = 0, r.mode = 4;
    case 4:
      for (; h < 16;) {
        if (0 === o) break e;
        o--, c += n[i++] << h, h += 8;
      }
      r.head && (r.head.xflags = 255 & c, r.head.os = c >> 8), 512 & r.flags && (P[0] = 255 & c, P[1] = c >>> 8 & 255, r.check = an(r.check, P, 2, 0)), c = 0, h = 0, r.mode = 5;
    case 5:
      if (1024 & r.flags) {
        for (; h < 16;) {
          if (0 === o) break e;
          o--, c += n[i++] << h, h += 8;
        }
        r.length = c, r.head && (r.head.extra_len = c), 512 & r.flags && (P[0] = 255 & c, P[1] = c >>> 8 & 255, r.check = an(r.check, P, 2, 0)), c = 0, h = 0;
      } else r.head && (r.head.extra = null);
      r.mode = 6;
    case 6:
      if (1024 & r.flags && ((f = r.length) > o && (f = o), f && (r.head && (k = r.head.extra_len - r.length, r.head.extra || (r.head.extra = new Array(r.head.extra_len)), rn.arraySet(r.head.extra, n, i, f, k)), 512 & r.flags && (r.check = an(r.check, n, f, i)), o -= f, i += f, r.length -= f), r.length)) break e;
      r.length = 0, r.mode = 7;
    case 7:
      if (2048 & r.flags) {
        if (0 === o) break e;
        f = 0;
        do {
          k = n[i + f++], r.head && k && r.length < 65536 && (r.head.name += String.fromCharCode(k));
        } while (k && f < o);
        if (512 & r.flags && (r.check = an(r.check, n, f, i)), o -= f, i += f, k) break e;
      } else r.head && (r.head.name = null);
      r.length = 0, r.mode = 8;
    case 8:
      if (4096 & r.flags) {
        if (0 === o) break e;
        f = 0;
        do {
          k = n[i + f++], r.head && k && r.length < 65536 && (r.head.comment += String.fromCharCode(k));
        } while (k && f < o);
        if (512 & r.flags && (r.check = an(r.check, n, f, i)), o -= f, i += f, k) break e;
      } else r.head && (r.head.comment = null);
      r.mode = 9;
    case 9:
      if (512 & r.flags) {
        for (; h < 16;) {
          if (0 === o) break e;
          o--, c += n[i++] << h, h += 8;
        }
        if (c !== (65535 & r.check)) {
          e.msg = "header crc mismatch", r.mode = hn;
          break;
        }
        c = 0, h = 0;
      }
      r.head && (r.head.hcrc = r.flags >> 9 & 1, r.head.done = !0), e.adler = r.check = 0, r.mode = cn;
      break;
    case 10:
      for (; h < 32;) {
        if (0 === o) break e;
        o--, c += n[i++] << h, h += 8;
      }
      e.adler = r.check = un(c), c = 0, h = 0, r.mode = 11;
    case 11:
      if (0 === r.havedict) return e.next_out = s, e.avail_out = l, e.next_in = i, e.avail_in = o, r.hold = c, r.bits = h, 2;
      e.adler = r.check = 1, r.mode = cn;
    case cn:
      if (5 === t || 6 === t) break e;
    case 13:
      if (r.last) {
        c >>>= 7 & h, h -= 7 & h, r.mode = 27;
        break;
      }
      for (; h < 3;) {
        if (0 === o) break e;
        o--, c += n[i++] << h, h += 8;
      }
      switch (r.last = 1 & c, h -= 1, 3 & (c >>>= 1)) {
        case 0:
          r.mode = 14;
          break;
        case 1:
          if (wn(r), r.mode = 20, 6 === t) {
            c >>>= 2, h -= 2;
            break e;
          }
          break;
        case 2:
          r.mode = 17;
          break;
        case 3:
          e.msg = "invalid block type", r.mode = hn;
      }
      c >>>= 2, h -= 2;
      break;
    case 14:
      for (c >>>= 7 & h, h -= 7 & h; h < 32;) {
        if (0 === o) break e;
        o--, c += n[i++] << h, h += 8;
      }
      if ((65535 & c) != (c >>> 16 ^ 65535)) {
        e.msg = "invalid stored block lengths", r.mode = hn;
        break;
      }
      if (r.length = 65535 & c, c = 0, h = 0, r.mode = 15, 6 === t) break e;
    case 15:
      r.mode = 16;
    case 16:
      if (f = r.length) {
        if (f > o && (f = o), f > l && (f = l), 0 === f) break e;
        rn.arraySet(a, n, i, f, s), o -= f, i += f, l -= f, s += f, r.length -= f;
        break;
      }
      r.mode = cn;
      break;
    case 17:
      for (; h < 14;) {
        if (0 === o) break e;
        o--, c += n[i++] << h, h += 8;
      }
      if (r.nlen = 257 + (31 & c), c >>>= 5, h -= 5, r.ndist = 1 + (31 & c), c >>>= 5, h -= 5, r.ncode = 4 + (15 & c), c >>>= 4, h -= 4, r.nlen > 286 || r.ndist > 30) {
        e.msg = "too many length or distance symbols", r.mode = hn;
        break;
      }
      r.have = 0, r.mode = 18;
    case 18:
      for (; r.have < r.ncode;) {
        for (; h < 3;) {
          if (0 === o) break e;
          o--, c += n[i++] << h, h += 8;
        }
        r.lens[A[r.have++]] = 7 & c, c >>>= 3, h -= 3;
      }
      for (; r.have < 19;) r.lens[A[r.have++]] = 0;
      if (r.lencode = r.lendyn, r.lenbits = 7, x = {
        bits: r.lenbits
      }, S = on(0, r.lens, 0, 19, r.lencode, 0, r.work, x), r.lenbits = x.bits, S) {
        e.msg = "invalid code lengths set", r.mode = hn;
        break;
      }
      r.have = 0, r.mode = 19;
    case 19:
      for (; r.have < r.nlen + r.ndist;) {
        for (; b = (E = r.lencode[c & (1 << r.lenbits) - 1]) >>> 16 & 255, y = 65535 & E, !((g = E >>> 24) <= h);) {
          if (0 === o) break e;
          o--, c += n[i++] << h, h += 8;
        }
        if (y < 16) c >>>= g, h -= g, r.lens[r.have++] = y;else {
          if (16 === y) {
            for (C = g + 2; h < C;) {
              if (0 === o) break e;
              o--, c += n[i++] << h, h += 8;
            }
            if (c >>>= g, h -= g, 0 === r.have) {
              e.msg = "invalid bit length repeat", r.mode = hn;
              break;
            }
            k = r.lens[r.have - 1], f = 3 + (3 & c), c >>>= 2, h -= 2;
          } else if (17 === y) {
            for (C = g + 3; h < C;) {
              if (0 === o) break e;
              o--, c += n[i++] << h, h += 8;
            }
            h -= g, k = 0, f = 3 + (7 & (c >>>= g)), c >>>= 3, h -= 3;
          } else {
            for (C = g + 7; h < C;) {
              if (0 === o) break e;
              o--, c += n[i++] << h, h += 8;
            }
            h -= g, k = 0, f = 11 + (127 & (c >>>= g)), c >>>= 7, h -= 7;
          }
          if (r.have + f > r.nlen + r.ndist) {
            e.msg = "invalid bit length repeat", r.mode = hn;
            break;
          }
          for (; f--;) r.lens[r.have++] = k;
        }
      }
      if (r.mode === hn) break;
      if (0 === r.lens[256]) {
        e.msg = "invalid code -- missing end-of-block", r.mode = hn;
        break;
      }
      if (r.lenbits = 9, x = {
        bits: r.lenbits
      }, S = on(1, r.lens, 0, r.nlen, r.lencode, 0, r.work, x), r.lenbits = x.bits, S) {
        e.msg = "invalid literal/lengths set", r.mode = hn;
        break;
      }
      if (r.distbits = 6, r.distcode = r.distdyn, x = {
        bits: r.distbits
      }, S = on(2, r.lens, r.nlen, r.ndist, r.distcode, 0, r.work, x), r.distbits = x.bits, S) {
        e.msg = "invalid distances set", r.mode = hn;
        break;
      }
      if (r.mode = 20, 6 === t) break e;
    case 20:
      r.mode = 21;
    case 21:
      if (o >= 6 && l >= 258) {
        e.next_out = s, e.avail_out = l, e.next_in = i, e.avail_in = o, r.hold = c, r.bits = h, sn(e, d), s = e.next_out, a = e.output, l = e.avail_out, i = e.next_in, n = e.input, o = e.avail_in, c = r.hold, h = r.bits, r.mode === cn && (r.back = -1);
        break;
      }
      for (r.back = 0; b = (E = r.lencode[c & (1 << r.lenbits) - 1]) >>> 16 & 255, y = 65535 & E, !((g = E >>> 24) <= h);) {
        if (0 === o) break e;
        o--, c += n[i++] << h, h += 8;
      }
      if (b && !(240 & b)) {
        for (v = g, w = b, _ = y; b = (E = r.lencode[_ + ((c & (1 << v + w) - 1) >> v)]) >>> 16 & 255, y = 65535 & E, !(v + (g = E >>> 24) <= h);) {
          if (0 === o) break e;
          o--, c += n[i++] << h, h += 8;
        }
        c >>>= v, h -= v, r.back += v;
      }
      if (c >>>= g, h -= g, r.back += g, r.length = y, 0 === b) {
        r.mode = 26;
        break;
      }
      if (32 & b) {
        r.back = -1, r.mode = cn;
        break;
      }
      if (64 & b) {
        e.msg = "invalid literal/length code", r.mode = hn;
        break;
      }
      r.extra = 15 & b, r.mode = 22;
    case 22:
      if (r.extra) {
        for (C = r.extra; h < C;) {
          if (0 === o) break e;
          o--, c += n[i++] << h, h += 8;
        }
        r.length += c & (1 << r.extra) - 1, c >>>= r.extra, h -= r.extra, r.back += r.extra;
      }
      r.was = r.length, r.mode = 23;
    case 23:
      for (; b = (E = r.distcode[c & (1 << r.distbits) - 1]) >>> 16 & 255, y = 65535 & E, !((g = E >>> 24) <= h);) {
        if (0 === o) break e;
        o--, c += n[i++] << h, h += 8;
      }
      if (!(240 & b)) {
        for (v = g, w = b, _ = y; b = (E = r.distcode[_ + ((c & (1 << v + w) - 1) >> v)]) >>> 16 & 255, y = 65535 & E, !(v + (g = E >>> 24) <= h);) {
          if (0 === o) break e;
          o--, c += n[i++] << h, h += 8;
        }
        c >>>= v, h -= v, r.back += v;
      }
      if (c >>>= g, h -= g, r.back += g, 64 & b) {
        e.msg = "invalid distance code", r.mode = hn;
        break;
      }
      r.offset = y, r.extra = 15 & b, r.mode = 24;
    case 24:
      if (r.extra) {
        for (C = r.extra; h < C;) {
          if (0 === o) break e;
          o--, c += n[i++] << h, h += 8;
        }
        r.offset += c & (1 << r.extra) - 1, c >>>= r.extra, h -= r.extra, r.back += r.extra;
      }
      if (r.offset > r.dmax) {
        e.msg = "invalid distance too far back", r.mode = hn;
        break;
      }
      r.mode = 25;
    case 25:
      if (0 === l) break e;
      if (f = d - l, r.offset > f) {
        if ((f = r.offset - f) > r.whave && r.sane) {
          e.msg = "invalid distance too far back", r.mode = hn;
          break;
        }
        f > r.wnext ? (f -= r.wnext, p = r.wsize - f) : p = r.wnext - f, f > r.length && (f = r.length), m = r.window;
      } else m = a, p = s - r.offset, f = r.length;
      f > l && (f = l), l -= f, r.length -= f;
      do {
        a[s++] = m[p++];
      } while (--f);
      0 === r.length && (r.mode = 21);
      break;
    case 26:
      if (0 === l) break e;
      a[s++] = r.length, l--, r.mode = 21;
      break;
    case 27:
      if (r.wrap) {
        for (; h < 32;) {
          if (0 === o) break e;
          o--, c |= n[i++] << h, h += 8;
        }
        if (d -= l, e.total_out += d, r.total += d, d && (e.adler = r.check = r.flags ? an(r.check, a, d, s - d) : nn(r.check, a, d, s - d)), d = l, (r.flags ? c : un(c)) !== r.check) {
          e.msg = "incorrect data check", r.mode = hn;
          break;
        }
        c = 0, h = 0;
      }
      r.mode = 28;
    case 28:
      if (r.wrap && r.flags) {
        for (; h < 32;) {
          if (0 === o) break e;
          o--, c += n[i++] << h, h += 8;
        }
        if (c !== (4294967295 & r.total)) {
          e.msg = "incorrect length check", r.mode = hn;
          break;
        }
        c = 0, h = 0;
      }
      r.mode = 29;
    case 29:
      S = 1;
      break e;
    case hn:
      S = -3;
      break e;
    case 31:
      return -4;
    default:
      return ln;
  }
  return e.next_out = s, e.avail_out = l, e.next_in = i, e.avail_in = o, r.hold = c, r.bits = h, (r.wsize || d !== e.avail_out && r.mode < hn && (r.mode < 27 || 4 !== t)) && _n(e, e.output, e.next_out, d - e.avail_out), u -= e.avail_in, d -= e.avail_out, e.total_in += u, e.total_out += d, r.total += d, r.wrap && d && (e.adler = r.check = r.flags ? an(r.check, a, d, e.next_out - d) : nn(r.check, a, d, e.next_out - d)), e.data_type = r.bits + (r.last ? 64 : 0) + (r.mode === cn ? 128 : 0) + (20 === r.mode || 15 === r.mode ? 256 : 0), (0 === u && 0 === d || 4 === t) && 0 === S && (S = -5), S;
}, Kr.inflateEnd = function (e) {
  if (!e || !e.state) return ln;
  var t = e.state;
  return t.window && (t.window = null), e.state = null, 0;
}, Kr.inflateGetHeader = function (e, t) {
  var r;
  return e && e.state && 2 & (r = e.state).wrap ? (r.head = t, t.done = !1, 0) : ln;
}, Kr.inflateSetDictionary = function (e, t) {
  var r,
    n = t.length;
  return e && e.state ? 0 !== (r = e.state).wrap && 11 !== r.mode ? ln : 11 === r.mode && nn(1, t, n, 0) !== r.check ? -3 : _n(e, t, n, n) ? (r.mode = 31, -4) : (r.havedict = 1, 0) : ln;
}, Kr.inflateInfo = "pako inflate (from Nodeca project)";
var kn = {
  Z_NO_FLUSH: 0,
  Z_PARTIAL_FLUSH: 1,
  Z_SYNC_FLUSH: 2,
  Z_FULL_FLUSH: 3,
  Z_FINISH: 4,
  Z_BLOCK: 5,
  Z_TREES: 6,
  Z_OK: 0,
  Z_STREAM_END: 1,
  Z_NEED_DICT: 2,
  Z_ERRNO: -1,
  Z_STREAM_ERROR: -2,
  Z_DATA_ERROR: -3,
  Z_BUF_ERROR: -5,
  Z_NO_COMPRESSION: 0,
  Z_BEST_SPEED: 1,
  Z_BEST_COMPRESSION: 9,
  Z_DEFAULT_COMPRESSION: -1,
  Z_FILTERED: 1,
  Z_HUFFMAN_ONLY: 2,
  Z_RLE: 3,
  Z_FIXED: 4,
  Z_DEFAULT_STRATEGY: 0,
  Z_BINARY: 0,
  Z_TEXT: 1,
  Z_UNKNOWN: 2,
  Z_DEFLATED: 8
};
var Sn = Kr,
  xn = ft,
  Cn = Br,
  En = kn,
  Pn = ar,
  An = Lr,
  Tn = function Tn() {
    this.text = 0, this.time = 0, this.xflags = 0, this.os = 0, this.extra = null, this.extra_len = 0, this.name = "", this.comment = "", this.hcrc = 0, this.done = !1;
  },
  Nn = Object.prototype.toString;
function Rn(e) {
  if (!(this instanceof Rn)) return new Rn(e);
  this.options = xn.assign({
    chunkSize: 16384,
    windowBits: 0,
    to: ""
  }, e || {});
  var t = this.options;
  t.raw && t.windowBits >= 0 && t.windowBits < 16 && (t.windowBits = -t.windowBits, 0 === t.windowBits && (t.windowBits = -15)), !(t.windowBits >= 0 && t.windowBits < 16) || e && e.windowBits || (t.windowBits += 32), t.windowBits > 15 && t.windowBits < 48 && (15 & t.windowBits || (t.windowBits |= 15)), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new An(), this.strm.avail_out = 0;
  var r = Sn.inflateInit2(this.strm, t.windowBits);
  if (r !== En.Z_OK) throw new Error(Pn[r]);
  if (this.header = new Tn(), Sn.inflateGetHeader(this.strm, this.header), t.dictionary && ("string" == typeof t.dictionary ? t.dictionary = Cn.string2buf(t.dictionary) : "[object ArrayBuffer]" === Nn.call(t.dictionary) && (t.dictionary = new Uint8Array(t.dictionary)), t.raw && (r = Sn.inflateSetDictionary(this.strm, t.dictionary)) !== En.Z_OK)) throw new Error(Pn[r]);
}
function Bn(e, t) {
  var r = new Rn(t);
  if (r.push(e, !0), r.err) throw r.msg || Pn[r.err];
  return r.result;
}
Rn.prototype.push = function (e, t) {
  var r,
    n,
    a,
    i,
    s,
    o = this.strm,
    l = this.options.chunkSize,
    c = this.options.dictionary,
    h = !1;
  if (this.ended) return !1;
  n = t === ~~t ? t : !0 === t ? En.Z_FINISH : En.Z_NO_FLUSH, "string" == typeof e ? o.input = Cn.binstring2buf(e) : "[object ArrayBuffer]" === Nn.call(e) ? o.input = new Uint8Array(e) : o.input = e, o.next_in = 0, o.avail_in = o.input.length;
  do {
    if (0 === o.avail_out && (o.output = new xn.Buf8(l), o.next_out = 0, o.avail_out = l), (r = Sn.inflate(o, En.Z_NO_FLUSH)) === En.Z_NEED_DICT && c && (r = Sn.inflateSetDictionary(this.strm, c)), r === En.Z_BUF_ERROR && !0 === h && (r = En.Z_OK, h = !1), r !== En.Z_STREAM_END && r !== En.Z_OK) return this.onEnd(r), this.ended = !0, !1;
    o.next_out && (0 !== o.avail_out && r !== En.Z_STREAM_END && (0 !== o.avail_in || n !== En.Z_FINISH && n !== En.Z_SYNC_FLUSH) || ("string" === this.options.to ? (a = Cn.utf8border(o.output, o.next_out), i = o.next_out - a, s = Cn.buf2string(o.output, a), o.next_out = i, o.avail_out = l - i, i && xn.arraySet(o.output, o.output, a, i, 0), this.onData(s)) : this.onData(xn.shrinkBuf(o.output, o.next_out)))), 0 === o.avail_in && 0 === o.avail_out && (h = !0);
  } while ((o.avail_in > 0 || 0 === o.avail_out) && r !== En.Z_STREAM_END);
  return r === En.Z_STREAM_END && (n = En.Z_FINISH), n === En.Z_FINISH ? (r = Sn.inflateEnd(this.strm), this.onEnd(r), this.ended = !0, r === En.Z_OK) : n !== En.Z_SYNC_FLUSH || (this.onEnd(En.Z_OK), o.avail_out = 0, !0);
}, Rn.prototype.onData = function (e) {
  this.chunks.push(e);
}, Rn.prototype.onEnd = function (e) {
  e === En.Z_OK && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = xn.flattenChunks(this.chunks)), this.chunks = [], this.err = e, this.msg = this.strm.msg;
}, Xr.Inflate = Rn, Xr.inflate = Bn, Xr.inflateRaw = function (e, t) {
  return (t = t || {}).raw = !0, Bn(e, t);
}, Xr.ungzip = Bn;
var Mn = {};
(0, ft.assign)(Mn, pt, Xr, kn);
var Dn = "undefined" != typeof Uint8Array && "undefined" != typeof Uint16Array && "undefined" != typeof Uint32Array,
  On = Mn,
  In = me(),
  zn = be,
  Fn = Dn ? "uint8array" : "array";
function Ln(e, t) {
  zn.call(this, "FlateWorker/" + e), this._pako = null, this._pakoAction = e, this._pakoOptions = t, this.meta = {};
}
dt.magic = "\b\0", In.inherits(Ln, zn), Ln.prototype.processChunk = function (e) {
  this.meta = e.meta, null === this._pako && this._createPako(), this._pako.push(In.transformTo(Fn, e.data), !1);
}, Ln.prototype.flush = function () {
  zn.prototype.flush.call(this), null === this._pako && this._createPako(), this._pako.push([], !0);
}, Ln.prototype.cleanUp = function () {
  zn.prototype.cleanUp.call(this), this._pako = null;
}, Ln.prototype._createPako = function () {
  this._pako = new On[this._pakoAction]({
    raw: !0,
    level: this._pakoOptions.level || -1
  });
  var e = this;
  this._pako.onData = function (t) {
    e.push({
      data: t,
      meta: e.meta
    });
  };
}, dt.compressWorker = function (e) {
  return new Ln("Deflate", e);
}, dt.uncompressWorker = function () {
  return new Ln("Inflate", {});
};
var jn = be;
ut.STORE = {
  magic: "\0\0",
  compressWorker: function compressWorker() {
    return new jn("STORE compression");
  },
  uncompressWorker: function uncompressWorker() {
    return new jn("STORE decompression");
  }
}, ut.DEFLATE = dt;
var Un = {
    LOCAL_FILE_HEADER: "PK",
    CENTRAL_FILE_HEADER: "PK",
    CENTRAL_DIRECTORY_END: "PK",
    ZIP64_CENTRAL_DIRECTORY_LOCATOR: "PK",
    ZIP64_CENTRAL_DIRECTORY_END: "PK",
    DATA_DESCRIPTOR: "PK\b"
  },
  $n = me(),
  Hn = be,
  Wn = u,
  Zn = je,
  Vn = Un,
  qn = function qn(e, t) {
    var r,
      n = "";
    for (r = 0; r < t; r++) n += String.fromCharCode(255 & e), e >>>= 8;
    return n;
  },
  Xn = function Xn(e, t, r, n, a, i) {
    var s,
      o,
      l = e.file,
      c = e.compression,
      h = i !== Wn.utf8encode,
      u = $n.transformTo("string", i(l.name)),
      d = $n.transformTo("string", Wn.utf8encode(l.name)),
      f = l.comment,
      p = $n.transformTo("string", i(f)),
      m = $n.transformTo("string", Wn.utf8encode(f)),
      g = d.length !== l.name.length,
      b = m.length !== f.length,
      y = "",
      v = "",
      w = "",
      _ = l.dir,
      k = l.date,
      S = {
        crc32: 0,
        compressedSize: 0,
        uncompressedSize: 0
      };
    t && !r || (S.crc32 = e.crc32, S.compressedSize = e.compressedSize, S.uncompressedSize = e.uncompressedSize);
    var x = 0;
    t && (x |= 8), h || !g && !b || (x |= 2048);
    var C,
      E,
      P,
      A = 0,
      T = 0;
    _ && (A |= 16), "UNIX" === a ? (T = 798, A |= (C = l.unixPermissions, E = _, P = C, C || (P = E ? 16893 : 33204), (65535 & P) << 16)) : (T = 20, A |= 63 & (l.dosPermissions || 0)), s = k.getUTCHours(), s <<= 6, s |= k.getUTCMinutes(), s <<= 5, s |= k.getUTCSeconds() / 2, o = k.getUTCFullYear() - 1980, o <<= 4, o |= k.getUTCMonth() + 1, o <<= 5, o |= k.getUTCDate(), g && (v = qn(1, 1) + qn(Zn(u), 4) + d, y += "up" + qn(v.length, 2) + v), b && (w = qn(1, 1) + qn(Zn(p), 4) + m, y += "uc" + qn(w.length, 2) + w);
    var N = "";
    return N += "\n\0", N += qn(x, 2), N += c.magic, N += qn(s, 2), N += qn(o, 2), N += qn(S.crc32, 4), N += qn(S.compressedSize, 4), N += qn(S.uncompressedSize, 4), N += qn(u.length, 2), N += qn(y.length, 2), {
      fileRecord: Vn.LOCAL_FILE_HEADER + N + u + y,
      dirRecord: Vn.CENTRAL_FILE_HEADER + qn(T, 2) + N + qn(p.length, 2) + "\0\0\0\0" + qn(A, 4) + qn(n, 4) + u + y + p
    };
  },
  Kn = function Kn(e) {
    return Vn.DATA_DESCRIPTOR + qn(e.crc32, 4) + qn(e.compressedSize, 4) + qn(e.uncompressedSize, 4);
  };
function Yn(e, t, r, n) {
  Hn.call(this, "ZipFileWorker"), this.bytesWritten = 0, this.zipComment = t, this.zipPlatform = r, this.encodeFileName = n, this.streamFiles = e, this.accumulate = !1, this.contentBuffer = [], this.dirRecords = [], this.currentSourceOffset = 0, this.entriesCount = 0, this.currentFile = null, this._sources = [];
}
$n.inherits(Yn, Hn), Yn.prototype.push = function (e) {
  var t = e.meta.percent || 0,
    r = this.entriesCount,
    n = this._sources.length;
  this.accumulate ? this.contentBuffer.push(e) : (this.bytesWritten += e.data.length, Hn.prototype.push.call(this, {
    data: e.data,
    meta: {
      currentFile: this.currentFile,
      percent: r ? (t + 100 * (r - n - 1)) / r : 100
    }
  }));
}, Yn.prototype.openedSource = function (e) {
  this.currentSourceOffset = this.bytesWritten, this.currentFile = e.file.name;
  var t = this.streamFiles && !e.file.dir;
  if (t) {
    var r = Xn(e, t, !1, this.currentSourceOffset, this.zipPlatform, this.encodeFileName);
    this.push({
      data: r.fileRecord,
      meta: {
        percent: 0
      }
    });
  } else this.accumulate = !0;
}, Yn.prototype.closedSource = function (e) {
  this.accumulate = !1;
  var t = this.streamFiles && !e.file.dir,
    r = Xn(e, t, !0, this.currentSourceOffset, this.zipPlatform, this.encodeFileName);
  if (this.dirRecords.push(r.dirRecord), t) this.push({
    data: Kn(e),
    meta: {
      percent: 100
    }
  });else for (this.push({
    data: r.fileRecord,
    meta: {
      percent: 0
    }
  }); this.contentBuffer.length;) this.push(this.contentBuffer.shift());
  this.currentFile = null;
}, Yn.prototype.flush = function () {
  for (var e = this.bytesWritten, t = 0; t < this.dirRecords.length; t++) this.push({
    data: this.dirRecords[t],
    meta: {
      percent: 100
    }
  });
  var r = this.bytesWritten - e,
    n = function (e, t, r, n, a) {
      var i = $n.transformTo("string", a(n));
      return Vn.CENTRAL_DIRECTORY_END + "\0\0\0\0" + qn(e, 2) + qn(e, 2) + qn(t, 4) + qn(r, 4) + qn(i.length, 2) + i;
    }(this.dirRecords.length, r, e, this.zipComment, this.encodeFileName);
  this.push({
    data: n,
    meta: {
      percent: 100
    }
  });
}, Yn.prototype.prepareNextSource = function () {
  this.previous = this._sources.shift(), this.openedSource(this.previous.streamInfo), this.isPaused ? this.previous.pause() : this.previous.resume();
}, Yn.prototype.registerPrevious = function (e) {
  this._sources.push(e);
  var t = this;
  return e.on("data", function (e) {
    t.processChunk(e);
  }), e.on("end", function () {
    t.closedSource(t.previous.streamInfo), t._sources.length ? t.prepareNextSource() : t.end();
  }), e.on("error", function (e) {
    t.error(e);
  }), this;
}, Yn.prototype.resume = function () {
  return !!Hn.prototype.resume.call(this) && (!this.previous && this._sources.length ? (this.prepareNextSource(), !0) : this.previous || this._sources.length || this.generatedError ? void 0 : (this.end(), !0));
}, Yn.prototype.error = function (e) {
  var t = this._sources;
  if (!Hn.prototype.error.call(this, e)) return !1;
  for (var r = 0; r < t.length; r++) try {
    t[r].error(e);
  } catch (e) {}
  return !0;
}, Yn.prototype.lock = function () {
  Hn.prototype.lock.call(this);
  for (var e = this._sources, t = 0; t < e.length; t++) e[t].lock();
};
var Gn = ut,
  Jn = Yn;
ht.generateWorker = function (e, t, r) {
  var n = new Jn(t.streamFiles, r, t.platform, t.encodeFileName),
    a = 0;
  try {
    e.forEach(function (e, r) {
      a++;
      var i = function (e, t) {
          var r = e || t,
            n = Gn[r];
          if (!n) throw new Error(r + " is not a valid compression method !");
          return n;
        }(r.options.compression, t.compression),
        s = r.options.compressionOptions || t.compressionOptions || {},
        o = r.dir,
        l = r.date;
      r._compressWorker(i, s).withStreamInfo("file", {
        name: e,
        dir: o,
        date: l,
        comment: r.comment || "",
        unixPermissions: r.unixPermissions,
        dosPermissions: r.dosPermissions
      }).pipe(n);
    }), n.entriesCount = a;
  } catch (e) {
    n.error(e);
  }
  return n;
};
var Qn = me(),
  ea = be;
function ta(e, t) {
  ea.call(this, "Nodejs stream input adapter for " + e), this._upstreamEnded = !1, this._bindStream(t);
}
Qn.inherits(ta, ea), ta.prototype._bindStream = function (e) {
  var t = this;
  this._stream = e, e.pause(), e.on("data", function (e) {
    t.push({
      data: e,
      meta: {
        percent: 0
      }
    });
  }).on("error", function (e) {
    t.isPaused ? this.generatedError = e : t.error(e);
  }).on("end", function () {
    t.isPaused ? t._upstreamEnded = !0 : t.end();
  });
}, ta.prototype.pause = function () {
  return !!ea.prototype.pause.call(this) && (this._stream.pause(), !0);
}, ta.prototype.resume = function () {
  return !!ea.prototype.resume.call(this) && (this._upstreamEnded ? this.end() : this._stream.resume(), !0);
};
var ra = ta,
  na = u,
  aa = me(),
  ia = be,
  sa = Be,
  oa = Me,
  la = Qe,
  ca = ct,
  ha = ht,
  ua = ue,
  da = ra,
  fa = function fa(e, t, r) {
    var n,
      a = aa.getTypeOf(t),
      i = aa.extend(r || {}, oa);
    i.date = i.date || new Date(), null !== i.compression && (i.compression = i.compression.toUpperCase()), "string" == typeof i.unixPermissions && (i.unixPermissions = parseInt(i.unixPermissions, 8)), i.unixPermissions && 16384 & i.unixPermissions && (i.dir = !0), i.dosPermissions && 16 & i.dosPermissions && (i.dir = !0), i.dir && (e = ma(e)), i.createFolders && (n = pa(e)) && ga.call(this, n, !0);
    var s = "string" === a && !1 === i.binary && !1 === i.base64;
    r && void 0 !== r.binary || (i.binary = !s), (t instanceof la && 0 === t.uncompressedSize || i.dir || !t || 0 === t.length) && (i.base64 = !1, i.binary = !0, t = "", i.compression = "STORE", a = "string");
    var o = null;
    o = t instanceof la || t instanceof ia ? t : ua.isNode && ua.isStream(t) ? new da(e, t) : aa.prepareContent(e, t, i.binary, i.optimizedBinaryString, i.base64);
    var l = new ca(e, o, i);
    this.files[e] = l;
  },
  pa = function pa(e) {
    "/" === e.slice(-1) && (e = e.substring(0, e.length - 1));
    var t = e.lastIndexOf("/");
    return t > 0 ? e.substring(0, t) : "";
  },
  ma = function ma(e) {
    return "/" !== e.slice(-1) && (e += "/"), e;
  },
  ga = function ga(e, t) {
    return t = void 0 !== t ? t : oa.createFolders, e = ma(e), this.files[e] || fa.call(this, e, null, {
      dir: !0,
      createFolders: t
    }), this.files[e];
  };
function ba(e) {
  return "[object RegExp]" === Object.prototype.toString.call(e);
}
var ya = {
    load: function load() {
      throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");
    },
    forEach: function forEach(e) {
      var t, r, n;
      for (t in this.files) n = this.files[t], (r = t.slice(this.root.length, t.length)) && t.slice(0, this.root.length) === this.root && e(r, n);
    },
    filter: function filter(e) {
      var t = [];
      return this.forEach(function (r, n) {
        e(r, n) && t.push(n);
      }), t;
    },
    file: function file(e, t, r) {
      if (1 === arguments.length) {
        if (ba(e)) {
          var n = e;
          return this.filter(function (e, t) {
            return !t.dir && n.test(e);
          });
        }
        var a = this.files[this.root + e];
        return a && !a.dir ? a : null;
      }
      return e = this.root + e, fa.call(this, e, t, r), this;
    },
    folder: function folder(e) {
      if (!e) return this;
      if (ba(e)) return this.filter(function (t, r) {
        return r.dir && e.test(t);
      });
      var t = this.root + e,
        r = ga.call(this, t),
        n = this.clone();
      return n.root = r.name, n;
    },
    remove: function remove(e) {
      e = this.root + e;
      var t = this.files[e];
      if (t || ("/" !== e.slice(-1) && (e += "/"), t = this.files[e]), t && !t.dir) delete this.files[e];else for (var r = this.filter(function (t, r) {
          return r.name.slice(0, e.length) === e;
        }), n = 0; n < r.length; n++) delete this.files[r[n].name];
      return this;
    },
    generate: function generate() {
      throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");
    },
    generateInternalStream: function generateInternalStream(e) {
      var t,
        r = {};
      try {
        if ((r = aa.extend(e || {}, {
          streamFiles: !1,
          compression: "STORE",
          compressionOptions: null,
          type: "",
          platform: "DOS",
          comment: null,
          mimeType: "application/zip",
          encodeFileName: na.utf8encode
        })).type = r.type.toLowerCase(), r.compression = r.compression.toUpperCase(), "binarystring" === r.type && (r.type = "string"), !r.type) throw new Error("No output type specified.");
        aa.checkSupport(r.type), "darwin" !== r.platform && "freebsd" !== r.platform && "linux" !== r.platform && "sunos" !== r.platform || (r.platform = "UNIX"), "win32" === r.platform && (r.platform = "DOS");
        var n = r.comment || this.comment || "";
        t = ha.generateWorker(this, r, n);
      } catch (e) {
        (t = new ia("error")).error(e);
      }
      return new sa(t, r.type || "string", r.mimeType);
    },
    generateAsync: function generateAsync(e, t) {
      return this.generateInternalStream(e).accumulate(t);
    },
    generateNodeStream: function generateNodeStream(e, t) {
      return (e = e || {}).type || (e.type = "nodebuffer"), this.generateInternalStream(e).toNodejsStream(t);
    }
  },
  va = ya,
  wa = me();
function _a(e) {
  this.data = e, this.length = e.length, this.index = 0, this.zero = 0;
}
_a.prototype = {
  checkOffset: function checkOffset(e) {
    this.checkIndex(this.index + e);
  },
  checkIndex: function checkIndex(e) {
    if (this.length < this.zero + e || e < 0) throw new Error("End of data reached (data length = " + this.length + ", asked index = " + e + "). Corrupted zip ?");
  },
  setIndex: function setIndex(e) {
    this.checkIndex(e), this.index = e;
  },
  skip: function skip(e) {
    this.setIndex(this.index + e);
  },
  byteAt: function byteAt() {},
  readInt: function readInt(e) {
    var t,
      r = 0;
    for (this.checkOffset(e), t = this.index + e - 1; t >= this.index; t--) r = (r << 8) + this.byteAt(t);
    return this.index += e, r;
  },
  readString: function readString(e) {
    return wa.transformTo("string", this.readData(e));
  },
  readData: function readData() {},
  lastIndexOfSignature: function lastIndexOfSignature() {},
  readAndCheckSignature: function readAndCheckSignature() {},
  readDate: function readDate() {
    var e = this.readInt(4);
    return new Date(Date.UTC(1980 + (e >> 25 & 127), (e >> 21 & 15) - 1, e >> 16 & 31, e >> 11 & 31, e >> 5 & 63, (31 & e) << 1));
  }
};
var ka = _a,
  Sa = ka;
function xa(e) {
  Sa.call(this, e);
  for (var t = 0; t < this.data.length; t++) e[t] = 255 & e[t];
}
me().inherits(xa, Sa), xa.prototype.byteAt = function (e) {
  return this.data[this.zero + e];
}, xa.prototype.lastIndexOfSignature = function (e) {
  for (var t = e.charCodeAt(0), r = e.charCodeAt(1), n = e.charCodeAt(2), a = e.charCodeAt(3), i = this.length - 4; i >= 0; --i) if (this.data[i] === t && this.data[i + 1] === r && this.data[i + 2] === n && this.data[i + 3] === a) return i - this.zero;
  return -1;
}, xa.prototype.readAndCheckSignature = function (e) {
  var t = e.charCodeAt(0),
    r = e.charCodeAt(1),
    n = e.charCodeAt(2),
    a = e.charCodeAt(3),
    i = this.readData(4);
  return t === i[0] && r === i[1] && n === i[2] && a === i[3];
}, xa.prototype.readData = function (e) {
  if (this.checkOffset(e), 0 === e) return [];
  var t = this.data.slice(this.zero + this.index, this.zero + this.index + e);
  return this.index += e, t;
};
var Ca = xa,
  Ea = ka;
function Pa(e) {
  Ea.call(this, e);
}
me().inherits(Pa, Ea), Pa.prototype.byteAt = function (e) {
  return this.data.charCodeAt(this.zero + e);
}, Pa.prototype.lastIndexOfSignature = function (e) {
  return this.data.lastIndexOf(e) - this.zero;
}, Pa.prototype.readAndCheckSignature = function (e) {
  return e === this.readData(4);
}, Pa.prototype.readData = function (e) {
  this.checkOffset(e);
  var t = this.data.slice(this.zero + this.index, this.zero + this.index + e);
  return this.index += e, t;
};
var Aa = Pa,
  Ta = Ca;
function Na(e) {
  Ta.call(this, e);
}
me().inherits(Na, Ta), Na.prototype.readData = function (e) {
  if (this.checkOffset(e), 0 === e) return new Uint8Array(0);
  var t = this.data.subarray(this.zero + this.index, this.zero + this.index + e);
  return this.index += e, t;
};
var Ra = Na,
  Ba = Ra;
function Ma(e) {
  Ba.call(this, e);
}
me().inherits(Ma, Ba), Ma.prototype.readData = function (e) {
  this.checkOffset(e);
  var t = this.data.slice(this.zero + this.index, this.zero + this.index + e);
  return this.index += e, t;
};
var Da = Ma,
  Oa = me(),
  Ia = f,
  za = Ca,
  Fa = Aa,
  La = Da,
  ja = Ra,
  Ua = function Ua(e) {
    var t = Oa.getTypeOf(e);
    return Oa.checkSupport(t), "string" !== t || Ia.uint8array ? "nodebuffer" === t ? new La(e) : Ia.uint8array ? new ja(Oa.transformTo("uint8array", e)) : new za(Oa.transformTo("array", e)) : new Fa(e);
  },
  $a = Ua,
  Ha = me(),
  Wa = Qe,
  Za = je,
  Va = u,
  qa = ut,
  Xa = f;
function Ka(e, t) {
  this.options = e, this.loadOptions = t;
}
Ka.prototype = {
  isEncrypted: function isEncrypted() {
    return !(1 & ~this.bitFlag);
  },
  useUTF8: function useUTF8() {
    return !(2048 & ~this.bitFlag);
  },
  readLocalPart: function readLocalPart(e) {
    var t, r;
    if (e.skip(22), this.fileNameLength = e.readInt(2), r = e.readInt(2), this.fileName = e.readData(this.fileNameLength), e.skip(r), -1 === this.compressedSize || -1 === this.uncompressedSize) throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");
    if (null === (t = function (e) {
      for (var t in qa) if (Object.prototype.hasOwnProperty.call(qa, t) && qa[t].magic === e) return qa[t];
      return null;
    }(this.compressionMethod))) throw new Error("Corrupted zip : compression " + Ha.pretty(this.compressionMethod) + " unknown (inner file : " + Ha.transformTo("string", this.fileName) + ")");
    this.decompressed = new Wa(this.compressedSize, this.uncompressedSize, this.crc32, t, e.readData(this.compressedSize));
  },
  readCentralPart: function readCentralPart(e) {
    this.versionMadeBy = e.readInt(2), e.skip(2), this.bitFlag = e.readInt(2), this.compressionMethod = e.readString(2), this.date = e.readDate(), this.crc32 = e.readInt(4), this.compressedSize = e.readInt(4), this.uncompressedSize = e.readInt(4);
    var t = e.readInt(2);
    if (this.extraFieldsLength = e.readInt(2), this.fileCommentLength = e.readInt(2), this.diskNumberStart = e.readInt(2), this.internalFileAttributes = e.readInt(2), this.externalFileAttributes = e.readInt(4), this.localHeaderOffset = e.readInt(4), this.isEncrypted()) throw new Error("Encrypted zip are not supported");
    e.skip(t), this.readExtraFields(e), this.parseZIP64ExtraField(e), this.fileComment = e.readData(this.fileCommentLength);
  },
  processAttributes: function processAttributes() {
    this.unixPermissions = null, this.dosPermissions = null;
    var e = this.versionMadeBy >> 8;
    this.dir = !!(16 & this.externalFileAttributes), 0 === e && (this.dosPermissions = 63 & this.externalFileAttributes), 3 === e && (this.unixPermissions = this.externalFileAttributes >> 16 & 65535), this.dir || "/" !== this.fileNameStr.slice(-1) || (this.dir = !0);
  },
  parseZIP64ExtraField: function parseZIP64ExtraField() {
    if (this.extraFields[1]) {
      var e = $a(this.extraFields[1].value);
      this.uncompressedSize === Ha.MAX_VALUE_32BITS && (this.uncompressedSize = e.readInt(8)), this.compressedSize === Ha.MAX_VALUE_32BITS && (this.compressedSize = e.readInt(8)), this.localHeaderOffset === Ha.MAX_VALUE_32BITS && (this.localHeaderOffset = e.readInt(8)), this.diskNumberStart === Ha.MAX_VALUE_32BITS && (this.diskNumberStart = e.readInt(4));
    }
  },
  readExtraFields: function readExtraFields(e) {
    var t,
      r,
      n,
      a = e.index + this.extraFieldsLength;
    for (this.extraFields || (this.extraFields = {}); e.index + 4 < a;) t = e.readInt(2), r = e.readInt(2), n = e.readData(r), this.extraFields[t] = {
      id: t,
      length: r,
      value: n
    };
    e.setIndex(a);
  },
  handleUTF8: function handleUTF8() {
    var e = Xa.uint8array ? "uint8array" : "array";
    if (this.useUTF8()) this.fileNameStr = Va.utf8decode(this.fileName), this.fileCommentStr = Va.utf8decode(this.fileComment);else {
      var t = this.findExtraFieldUnicodePath();
      if (null !== t) this.fileNameStr = t;else {
        var r = Ha.transformTo(e, this.fileName);
        this.fileNameStr = this.loadOptions.decodeFileName(r);
      }
      var n = this.findExtraFieldUnicodeComment();
      if (null !== n) this.fileCommentStr = n;else {
        var a = Ha.transformTo(e, this.fileComment);
        this.fileCommentStr = this.loadOptions.decodeFileName(a);
      }
    }
  },
  findExtraFieldUnicodePath: function findExtraFieldUnicodePath() {
    var e = this.extraFields[28789];
    if (e) {
      var t = $a(e.value);
      return 1 !== t.readInt(1) || Za(this.fileName) !== t.readInt(4) ? null : Va.utf8decode(t.readData(e.length - 5));
    }
    return null;
  },
  findExtraFieldUnicodeComment: function findExtraFieldUnicodeComment() {
    var e = this.extraFields[25461];
    if (e) {
      var t = $a(e.value);
      return 1 !== t.readInt(1) || Za(this.fileComment) !== t.readInt(4) ? null : Va.utf8decode(t.readData(e.length - 5));
    }
    return null;
  }
};
var Ya = Ka,
  Ga = Ua,
  Ja = me(),
  Qa = Un,
  ei = Ya,
  ti = f;
function ri(e) {
  this.files = [], this.loadOptions = e;
}
ri.prototype = {
  checkSignature: function checkSignature(e) {
    if (!this.reader.readAndCheckSignature(e)) {
      this.reader.index -= 4;
      var t = this.reader.readString(4);
      throw new Error("Corrupted zip or bug: unexpected signature (" + Ja.pretty(t) + ", expected " + Ja.pretty(e) + ")");
    }
  },
  isSignature: function isSignature(e, t) {
    var r = this.reader.index;
    this.reader.setIndex(e);
    var n = this.reader.readString(4) === t;
    return this.reader.setIndex(r), n;
  },
  readBlockEndOfCentral: function readBlockEndOfCentral() {
    this.diskNumber = this.reader.readInt(2), this.diskWithCentralDirStart = this.reader.readInt(2), this.centralDirRecordsOnThisDisk = this.reader.readInt(2), this.centralDirRecords = this.reader.readInt(2), this.centralDirSize = this.reader.readInt(4), this.centralDirOffset = this.reader.readInt(4), this.zipCommentLength = this.reader.readInt(2);
    var e = this.reader.readData(this.zipCommentLength),
      t = ti.uint8array ? "uint8array" : "array",
      r = Ja.transformTo(t, e);
    this.zipComment = this.loadOptions.decodeFileName(r);
  },
  readBlockZip64EndOfCentral: function readBlockZip64EndOfCentral() {
    this.zip64EndOfCentralSize = this.reader.readInt(8), this.reader.skip(4), this.diskNumber = this.reader.readInt(4), this.diskWithCentralDirStart = this.reader.readInt(4), this.centralDirRecordsOnThisDisk = this.reader.readInt(8), this.centralDirRecords = this.reader.readInt(8), this.centralDirSize = this.reader.readInt(8), this.centralDirOffset = this.reader.readInt(8), this.zip64ExtensibleData = {};
    for (var e, t, r, n = this.zip64EndOfCentralSize - 44; 0 < n;) e = this.reader.readInt(2), t = this.reader.readInt(4), r = this.reader.readData(t), this.zip64ExtensibleData[e] = {
      id: e,
      length: t,
      value: r
    };
  },
  readBlockZip64EndOfCentralLocator: function readBlockZip64EndOfCentralLocator() {
    if (this.diskWithZip64CentralDirStart = this.reader.readInt(4), this.relativeOffsetEndOfZip64CentralDir = this.reader.readInt(8), this.disksCount = this.reader.readInt(4), this.disksCount > 1) throw new Error("Multi-volumes zip are not supported");
  },
  readLocalFiles: function readLocalFiles() {
    var e, t;
    for (e = 0; e < this.files.length; e++) t = this.files[e], this.reader.setIndex(t.localHeaderOffset), this.checkSignature(Qa.LOCAL_FILE_HEADER), t.readLocalPart(this.reader), t.handleUTF8(), t.processAttributes();
  },
  readCentralDir: function readCentralDir() {
    var e;
    for (this.reader.setIndex(this.centralDirOffset); this.reader.readAndCheckSignature(Qa.CENTRAL_FILE_HEADER);) (e = new ei({
      zip64: this.zip64
    }, this.loadOptions)).readCentralPart(this.reader), this.files.push(e);
    if (this.centralDirRecords !== this.files.length && 0 !== this.centralDirRecords && 0 === this.files.length) throw new Error("Corrupted zip or bug: expected " + this.centralDirRecords + " records in central dir, got " + this.files.length);
  },
  readEndOfCentral: function readEndOfCentral() {
    var e = this.reader.lastIndexOfSignature(Qa.CENTRAL_DIRECTORY_END);
    if (e < 0) throw !this.isSignature(0, Qa.LOCAL_FILE_HEADER) ? new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html") : new Error("Corrupted zip: can't find end of central directory");
    this.reader.setIndex(e);
    var t = e;
    if (this.checkSignature(Qa.CENTRAL_DIRECTORY_END), this.readBlockEndOfCentral(), this.diskNumber === Ja.MAX_VALUE_16BITS || this.diskWithCentralDirStart === Ja.MAX_VALUE_16BITS || this.centralDirRecordsOnThisDisk === Ja.MAX_VALUE_16BITS || this.centralDirRecords === Ja.MAX_VALUE_16BITS || this.centralDirSize === Ja.MAX_VALUE_32BITS || this.centralDirOffset === Ja.MAX_VALUE_32BITS) {
      if (this.zip64 = !0, (e = this.reader.lastIndexOfSignature(Qa.ZIP64_CENTRAL_DIRECTORY_LOCATOR)) < 0) throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");
      if (this.reader.setIndex(e), this.checkSignature(Qa.ZIP64_CENTRAL_DIRECTORY_LOCATOR), this.readBlockZip64EndOfCentralLocator(), !this.isSignature(this.relativeOffsetEndOfZip64CentralDir, Qa.ZIP64_CENTRAL_DIRECTORY_END) && (this.relativeOffsetEndOfZip64CentralDir = this.reader.lastIndexOfSignature(Qa.ZIP64_CENTRAL_DIRECTORY_END), this.relativeOffsetEndOfZip64CentralDir < 0)) throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");
      this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir), this.checkSignature(Qa.ZIP64_CENTRAL_DIRECTORY_END), this.readBlockZip64EndOfCentral();
    }
    var r = this.centralDirOffset + this.centralDirSize;
    this.zip64 && (r += 20, r += 12 + this.zip64EndOfCentralSize);
    var n = t - r;
    if (n > 0) this.isSignature(t, Qa.CENTRAL_FILE_HEADER) || (this.reader.zero = n);else if (n < 0) throw new Error("Corrupted zip: missing " + Math.abs(n) + " bytes.");
  },
  prepareReader: function prepareReader(e) {
    this.reader = Ga(e);
  },
  load: function load(e) {
    this.prepareReader(e), this.readEndOfCentral(), this.readCentralDir(), this.readLocalFiles();
  }
};
var ni = ri,
  ai = me(),
  ii = pe,
  si = u,
  oi = ni,
  li = We,
  ci = ue;
function hi(e) {
  return new ii.Promise(function (t, r) {
    var n = e.decompressed.getContentWorker().pipe(new li());
    n.on("error", function (e) {
      r(e);
    }).on("end", function () {
      n.streamInfo.crc32 !== e.decompressed.crc32 ? r(new Error("Corrupted zip : CRC32 mismatch")) : t();
    }).resume();
  });
}
function ui() {
  if (!(this instanceof ui)) return new ui();
  if (arguments.length) throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");
  this.files = Object.create(null), this.comment = null, this.root = "", this.clone = function () {
    var e = new ui();
    for (var t in this) "function" != typeof this[t] && (e[t] = this[t]);
    return e;
  };
}
ui.prototype = va, ui.prototype.loadAsync = function (e, t) {
  var r = this;
  return t = ai.extend(t || {}, {
    base64: !1,
    checkCRC32: !1,
    optimizedBinaryString: !1,
    createFolders: !1,
    decodeFileName: si.utf8decode
  }), ci.isNode && ci.isStream(e) ? ii.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")) : ai.prepareContent("the loaded zip file", e, !0, t.optimizedBinaryString, t.base64).then(function (e) {
    var r = new oi(t);
    return r.load(e), r;
  }).then(function (e) {
    var r = [ii.Promise.resolve(e)],
      n = e.files;
    if (t.checkCRC32) for (var a = 0; a < n.length; a++) r.push(hi(n[a]));
    return ii.Promise.all(r);
  }).then(function (e) {
    for (var n = e.shift(), a = n.files, i = 0; i < a.length; i++) {
      var s = a[i],
        o = s.fileNameStr,
        l = ai.resolve(s.fileNameStr);
      r.file(l, s.decompressed, {
        binary: !0,
        optimizedBinaryString: !0,
        date: s.date,
        dir: s.dir,
        comment: s.fileCommentStr.length ? s.fileCommentStr : null,
        unixPermissions: s.unixPermissions,
        dosPermissions: s.dosPermissions,
        createFolders: t.createFolders
      }), s.dir || (r.file(l).unsafeOriginalName = o);
    }
    return n.zipComment.length && (r.comment = n.zipComment), r;
  });
}, ui.support = f, ui.defaults = Me, ui.version = "3.10.1", ui.loadAsync = function (e, t) {
  return new ui().loadAsync(e, t);
}, ui.external = pe;
var di,
  fi = i(ui);
!function (e) {
  e.OfficeDocument = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument", e.FontTable = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable", e.Image = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/image", e.Numbering = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering", e.Styles = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles", e.StylesWithEffects = "http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects", e.Theme = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme", e.Settings = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings", e.WebSettings = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings", e.Hyperlink = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink", e.Footnotes = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes", e.Endnotes = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes", e.Footer = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer", e.Header = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/header", e.ExtendedProperties = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties", e.CoreProperties = "http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties", e.CustomProperties = "http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties", e.Comments = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments", e.CommentsExtended = "http://schemas.microsoft.com/office/2011/relationships/commentsExtended";
}(di || (di = {}));
var pi = "http://schemas.openxmlformats.org/wordprocessingml/2006/main",
  mi = {
    mul: .05,
    unit: "pt"
  },
  gi = {
    mul: 1 / 12700,
    unit: "pt"
  },
  bi = {
    mul: .5,
    unit: "pt"
  },
  yi = {
    mul: .125,
    unit: "pt"
  },
  vi = {
    mul: 1,
    unit: "pt"
  },
  wi = {
    mul: .02,
    unit: "%"
  };
function _i(e) {
  var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : mi;
  return null == e || /.+(p[xt]|[%])$/.test(e) ? e : "".concat((parseInt(e) * t.mul).toFixed(2)).concat(t.unit);
}
function ki(e, t, r) {
  if (e.namespaceURI != pi) return !1;
  switch (e.localName) {
    case "color":
      t.color = r.attr(e, "val");
      break;
    case "sz":
      t.fontSize = r.lengthAttr(e, "val", bi);
      break;
    default:
      return !1;
  }
  return !0;
}
var Si = /*#__PURE__*/function () {
  function Si() {
    _classCallCheck(this, Si);
  }
  return _createClass(Si, [{
    key: "elements",
    value: function elements(e) {
      var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      var r = [];
      for (var _n2 = 0, _a2 = e.childNodes.length; _n2 < _a2; _n2++) {
        var _a3 = e.childNodes.item(_n2);
        1 != _a3.nodeType || null != t && _a3.localName != t || r.push(_a3);
      }
      return r;
    }
  }, {
    key: "element",
    value: function element(e, t) {
      for (var _r2 = 0, _n3 = e.childNodes.length; _r2 < _n3; _r2++) {
        var _n4 = e.childNodes.item(_r2);
        if (1 == _n4.nodeType && _n4.localName == t) return _n4;
      }
      return null;
    }
  }, {
    key: "elementAttr",
    value: function elementAttr(e, t, r) {
      var n = this.element(e, t);
      return n ? this.attr(n, r) : void 0;
    }
  }, {
    key: "attrs",
    value: function attrs(e) {
      return Array.from(e.attributes);
    }
  }, {
    key: "attr",
    value: function attr(e, t) {
      for (var _r3 = 0, _n5 = e.attributes.length; _r3 < _n5; _r3++) {
        var _n6 = e.attributes.item(_r3);
        if (_n6.localName == t) return _n6.value;
      }
      return null;
    }
  }, {
    key: "intAttr",
    value: function intAttr(e, t) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      var n = this.attr(e, t);
      return n ? parseInt(n) : r;
    }
  }, {
    key: "hexAttr",
    value: function hexAttr(e, t) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      var n = this.attr(e, t);
      return n ? parseInt(n, 16) : r;
    }
  }, {
    key: "floatAttr",
    value: function floatAttr(e, t) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      var n = this.attr(e, t);
      return n ? parseFloat(n) : r;
    }
  }, {
    key: "boolAttr",
    value: function boolAttr(e, t) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      return function (e) {
        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;
        switch (e) {
          case "1":
          case "on":
          case "true":
            return !0;
          case "0":
          case "off":
          case "false":
            return !1;
          default:
            return t;
        }
      }(this.attr(e, t), r);
    }
  }, {
    key: "lengthAttr",
    value: function lengthAttr(e, t) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : mi;
      return _i(this.attr(e, t), r);
    }
  }]);
}();
var xi = new Si();
var Ci = /*#__PURE__*/function () {
  function Ci(e, t) {
    _classCallCheck(this, Ci);
    this._package = e, this.path = t;
  }
  return _createClass(Ci, [{
    key: "load",
    value: function () {
      var _load = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {
        var e, t;
        return _regeneratorRuntime().wrap(function _callee$(_context) {
          while (1) switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return this._package.loadRelationships(this.path);
            case 2:
              this.rels = _context.sent;
              _context.next = 5;
              return this._package.load(this.path);
            case 5:
              e = _context.sent;
              t = this._package.parseXmlDocument(e);
              this._package.options.keepOrigin && (this._xmlDocument = t), this.parseXml(t.firstElementChild);
            case 8:
            case "end":
              return _context.stop();
          }
        }, _callee, this);
      }));
      function load() {
        return _load.apply(this, arguments);
      }
      return load;
    }()
  }, {
    key: "save",
    value: function save() {
      var e;
      this._package.update(this.path, (e = this._xmlDocument, new XMLSerializer().serializeToString(e)));
    }
  }, {
    key: "parseXml",
    value: function parseXml(e) {}
  }]);
}();
var Ei = {
  embedRegular: "regular",
  embedBold: "bold",
  embedItalic: "italic",
  embedBoldItalic: "boldItalic"
};
function Pi(e, t) {
  return t.elements(e).map(function (e) {
    return function (e, t) {
      var r = {
        name: t.attr(e, "name"),
        embedFontRefs: []
      };
      var _iterator = _createForOfIteratorHelper(t.elements(e)),
        _step;
      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var _n7 = _step.value;
          switch (_n7.localName) {
            case "family":
              r.family = t.attr(_n7, "val");
              break;
            case "altName":
              r.altName = t.attr(_n7, "val");
              break;
            case "embedRegular":
            case "embedBold":
            case "embedItalic":
            case "embedBoldItalic":
              r.embedFontRefs.push(Ai(_n7, t));
          }
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }
      return r;
    }(e, t);
  });
}
function Ai(e, t) {
  return {
    id: t.attr(e, "id"),
    key: t.attr(e, "fontKey"),
    type: Ei[e.localName]
  };
}
var Ti = /*#__PURE__*/function (_Ci) {
  function Ti() {
    _classCallCheck(this, Ti);
    return _callSuper(this, Ti, arguments);
  }
  _inherits(Ti, _Ci);
  return _createClass(Ti, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.fonts = Pi(e, this._package.xmlParser);
    }
  }]);
}(Ci);
function Ni(e) {
  var t = e.lastIndexOf("/") + 1;
  return [0 == t ? "" : e.substring(0, t), 0 == t ? e : e.substring(t)];
}
function Ri(e, t) {
  try {
    var _r4 = "http://docx/";
    return new URL(e, _r4 + t).toString().substring(_r4.length);
  } catch (_unused) {
    return "".concat(t).concat(e);
  }
}
function Bi(e, t) {
  return e.reduce(function (e, r) {
    return e[t(r)] = r, e;
  }, {});
}
function Mi(e) {
  return e && "object" == _typeof(e) && !Array.isArray(e);
}
function Di(e) {
  for (var _len2 = arguments.length, t = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
    t[_key2 - 1] = arguments[_key2];
  }
  if (!t.length) return e;
  var r = t.shift();
  if (Mi(e) && Mi(r)) for (var _t3 in r) if (Mi(r[_t3])) {
    var _e$_t;
    Di((_e$_t = e[_t3]) !== null && _e$_t !== void 0 ? _e$_t : e[_t3] = {}, r[_t3]);
  } else e[_t3] = r[_t3];
  return Di.apply(void 0, [e].concat(t));
}
function Oi(e) {
  return Array.isArray(e) ? e : [e];
}
var Ii = /*#__PURE__*/function () {
  function Ii(e, t) {
    _classCallCheck(this, Ii);
    this._zip = e, this.options = t, this.xmlParser = new Si();
  }
  return _createClass(Ii, [{
    key: "get",
    value: function get(e) {
      var _this$_zip$files$t;
      var t = function (e) {
        return e.startsWith("/") ? e.substr(1) : e;
      }(e);
      return (_this$_zip$files$t = this._zip.files[t]) !== null && _this$_zip$files$t !== void 0 ? _this$_zip$files$t : this._zip.files[t.replace(/\//g, "\\")];
    }
  }, {
    key: "update",
    value: function update(e, t) {
      this._zip.file(e, t);
    }
  }, {
    key: "save",
    value: function save() {
      var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "blob";
      return this._zip.generateAsync({
        type: e
      });
    }
  }, {
    key: "load",
    value: function load(e) {
      var _this$get$async, _this$get;
      var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "string";
      return (_this$get$async = (_this$get = this.get(e)) === null || _this$get === void 0 ? void 0 : _this$get.async(t)) !== null && _this$get$async !== void 0 ? _this$get$async : Promise.resolve(null);
    }
  }, {
    key: "loadRelationships",
    value: function () {
      var _loadRelationships = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {
        var e,
          t,
          _Ni,
          _Ni2,
          _r5,
          _n8,
          r,
          n,
          a,
          _args2 = arguments;
        return _regeneratorRuntime().wrap(function _callee2$(_context2) {
          while (1) switch (_context2.prev = _context2.next) {
            case 0:
              e = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : null;
              t = "_rels/.rels";
              if (null != e) {
                _Ni = Ni(e), _Ni2 = _slicedToArray(_Ni, 2), _r5 = _Ni2[0], _n8 = _Ni2[1];
                t = "".concat(_r5, "_rels/").concat(_n8, ".rels");
              }
              _context2.next = 5;
              return this.load(t);
            case 5:
              r = _context2.sent;
              return _context2.abrupt("return", r ? (n = this.parseXmlDocument(r).firstElementChild, (a = this.xmlParser).elements(n).map(function (e) {
                return {
                  id: a.attr(e, "Id"),
                  type: a.attr(e, "Type"),
                  target: a.attr(e, "Target"),
                  targetMode: a.attr(e, "TargetMode")
                };
              })) : null);
            case 7:
            case "end":
              return _context2.stop();
          }
        }, _callee2, this);
      }));
      function loadRelationships() {
        return _loadRelationships.apply(this, arguments);
      }
      return loadRelationships;
    }()
  }, {
    key: "parseXmlDocument",
    value: function parseXmlDocument(e) {
      return function (e) {
        var _i$getElementsByTagNa;
        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;
        var r;
        t && (e = e.replace(/<[?].*[?]>/, "")), e = 65279 === (r = e).charCodeAt(0) ? r.substring(1) : r;
        var n = new DOMParser().parseFromString(e, "application/xml"),
          a = (i = n, (_i$getElementsByTagNa = i.getElementsByTagName("parsererror")[0]) === null || _i$getElementsByTagNa === void 0 ? void 0 : _i$getElementsByTagNa.textContent);
        var i;
        if (a) throw new Error(a);
        return n;
      }(e, this.options.trimXmlDeclaration);
    }
  }], [{
    key: "load",
    value: function () {
      var _load2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e, t) {
        var r;
        return _regeneratorRuntime().wrap(function _callee3$(_context3) {
          while (1) switch (_context3.prev = _context3.next) {
            case 0:
              _context3.next = 2;
              return fi.loadAsync(e);
            case 2:
              r = _context3.sent;
              return _context3.abrupt("return", new Ii(r, t));
            case 4:
            case "end":
              return _context3.stop();
          }
        }, _callee3);
      }));
      function load(_x, _x2) {
        return _load2.apply(this, arguments);
      }
      return load;
    }()
  }]);
}();
var zi = /*#__PURE__*/function (_Ci2) {
  function zi(e, t, r) {
    var _this;
    _classCallCheck(this, zi);
    _this = _callSuper(this, zi, [e, t]), _this._documentParser = r;
    return _this;
  }
  _inherits(zi, _Ci2);
  return _createClass(zi, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.body = this._documentParser.parseDocumentFile(e);
    }
  }]);
}(Ci);
function Fi(e, t) {
  return {
    type: t.attr(e, "val"),
    color: t.attr(e, "color"),
    size: t.lengthAttr(e, "sz", yi),
    offset: t.lengthAttr(e, "space", vi),
    frame: t.boolAttr(e, "frame"),
    shadow: t.boolAttr(e, "shadow")
  };
}
function Li(e, t) {
  var r = {};
  var _iterator2 = _createForOfIteratorHelper(t.elements(e)),
    _step2;
  try {
    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
      var n = _step2.value;
      switch (n.localName) {
        case "left":
          r.left = Fi(n, t);
          break;
        case "top":
          r.top = Fi(n, t);
          break;
        case "right":
          r.right = Fi(n, t);
          break;
        case "bottom":
          r.bottom = Fi(n, t);
      }
    }
  } catch (err) {
    _iterator2.e(err);
  } finally {
    _iterator2.f();
  }
  return r;
}
var ji, Ui;
function $i(e) {
  var _r$headerRefs, _r$footerRefs;
  var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : xi;
  var r = {};
  var _iterator3 = _createForOfIteratorHelper(t.elements(e)),
    _step3;
  try {
    for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
      var n = _step3.value;
      switch (n.localName) {
        case "pgSz":
          r.pageSize = {
            width: t.lengthAttr(n, "w"),
            height: t.lengthAttr(n, "h"),
            orientation: t.attr(n, "orient")
          };
          break;
        case "type":
          r.type = t.attr(n, "val");
          break;
        case "pgMar":
          r.pageMargins = {
            left: t.lengthAttr(n, "left"),
            right: t.lengthAttr(n, "right"),
            top: t.lengthAttr(n, "top"),
            bottom: t.lengthAttr(n, "bottom"),
            header: t.lengthAttr(n, "header"),
            footer: t.lengthAttr(n, "footer"),
            gutter: t.lengthAttr(n, "gutter")
          };
          break;
        case "cols":
          r.columns = Hi(n, t);
          break;
        case "headerReference":
          ((_r$headerRefs = r.headerRefs) !== null && _r$headerRefs !== void 0 ? _r$headerRefs : r.headerRefs = []).push(Zi(n, t));
          break;
        case "footerReference":
          ((_r$footerRefs = r.footerRefs) !== null && _r$footerRefs !== void 0 ? _r$footerRefs : r.footerRefs = []).push(Zi(n, t));
          break;
        case "titlePg":
          r.titlePage = t.boolAttr(n, "val", !0);
          break;
        case "pgBorders":
          r.pageBorders = Li(n, t);
          break;
        case "pgNumType":
          r.pageNumber = Wi(n, t);
      }
    }
  } catch (err) {
    _iterator3.e(err);
  } finally {
    _iterator3.f();
  }
  return r;
}
function Hi(e, t) {
  return {
    numberOfColumns: t.intAttr(e, "num"),
    space: t.lengthAttr(e, "space"),
    separator: t.boolAttr(e, "sep"),
    equalWidth: t.boolAttr(e, "equalWidth", !0),
    columns: t.elements(e, "col").map(function (e) {
      return {
        width: t.lengthAttr(e, "w"),
        space: t.lengthAttr(e, "space")
      };
    })
  };
}
function Wi(e, t) {
  return {
    chapSep: t.attr(e, "chapSep"),
    chapStyle: t.attr(e, "chapStyle"),
    format: t.attr(e, "fmt"),
    start: t.intAttr(e, "start")
  };
}
function Zi(e, t) {
  return {
    id: t.attr(e, "id"),
    type: t.attr(e, "type")
  };
}
function Vi(e, t) {
  var r = {};
  var _iterator4 = _createForOfIteratorHelper(t.elements(e)),
    _step4;
  try {
    for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
      var n = _step4.value;
      qi(n, r, t);
    }
  } catch (err) {
    _iterator4.e(err);
  } finally {
    _iterator4.f();
  }
  return r;
}
function qi(e, t, r) {
  return !!ki(e, t, r);
}
function Xi(e, t) {
  var r = {};
  var _iterator5 = _createForOfIteratorHelper(t.elements(e)),
    _step5;
  try {
    for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {
      var n = _step5.value;
      Ki(n, r, t);
    }
  } catch (err) {
    _iterator5.e(err);
  } finally {
    _iterator5.f();
  }
  return r;
}
function Ki(e, t, r) {
  if (e.namespaceURI != pi) return !1;
  if (ki(e, t, r)) return !0;
  switch (e.localName) {
    case "tabs":
      t.tabs = function (e, t) {
        return t.elements(e, "tab").map(function (e) {
          return {
            position: t.lengthAttr(e, "pos"),
            leader: t.attr(e, "leader"),
            style: t.attr(e, "val")
          };
        });
      }(e, r);
      break;
    case "sectPr":
      t.sectionProps = $i(e, r);
      break;
    case "numPr":
      t.numbering = function (e, t) {
        var r = {};
        var _iterator6 = _createForOfIteratorHelper(t.elements(e)),
          _step6;
        try {
          for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {
            var n = _step6.value;
            switch (n.localName) {
              case "numId":
                r.id = t.attr(n, "val");
                break;
              case "ilvl":
                r.level = t.intAttr(n, "val");
            }
          }
        } catch (err) {
          _iterator6.e(err);
        } finally {
          _iterator6.f();
        }
        return r;
      }(e, r);
      break;
    case "spacing":
      return t.lineSpacing = function (e, t) {
        return {
          before: t.lengthAttr(e, "before"),
          after: t.lengthAttr(e, "after"),
          line: t.intAttr(e, "line"),
          lineRule: t.attr(e, "lineRule")
        };
      }(e, r), !1;
    case "textAlignment":
      return t.textAlignment = r.attr(e, "val"), !1;
    case "keepLines":
      t.keepLines = r.boolAttr(e, "val", !0);
      break;
    case "keepNext":
      t.keepNext = r.boolAttr(e, "val", !0);
      break;
    case "pageBreakBefore":
      t.pageBreakBefore = r.boolAttr(e, "val", !0);
      break;
    case "outlineLvl":
      t.outlineLevel = r.intAttr(e, "val");
      break;
    case "pStyle":
      t.styleName = r.attr(e, "val");
      break;
    case "rPr":
      t.runProps = Vi(e, r);
      break;
    default:
      return !1;
  }
  return !0;
}
function Yi(e, t) {
  var r = {
    id: t.attr(e, "numId"),
    overrides: []
  };
  var _iterator7 = _createForOfIteratorHelper(t.elements(e)),
    _step7;
  try {
    for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {
      var n = _step7.value;
      switch (n.localName) {
        case "abstractNumId":
          r.abstractId = t.attr(n, "val");
          break;
        case "lvlOverride":
          r.overrides.push(Qi(n, t));
      }
    }
  } catch (err) {
    _iterator7.e(err);
  } finally {
    _iterator7.f();
  }
  return r;
}
function Gi(e, t) {
  var r = {
    id: t.attr(e, "abstractNumId"),
    levels: []
  };
  var _iterator8 = _createForOfIteratorHelper(t.elements(e)),
    _step8;
  try {
    for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {
      var n = _step8.value;
      switch (n.localName) {
        case "name":
          r.name = t.attr(n, "val");
          break;
        case "multiLevelType":
          r.multiLevelType = t.attr(n, "val");
          break;
        case "numStyleLink":
          r.numberingStyleLink = t.attr(n, "val");
          break;
        case "styleLink":
          r.styleLink = t.attr(n, "val");
          break;
        case "lvl":
          r.levels.push(Ji(n, t));
      }
    }
  } catch (err) {
    _iterator8.e(err);
  } finally {
    _iterator8.f();
  }
  return r;
}
function Ji(e, t) {
  var r = {
    level: t.intAttr(e, "ilvl")
  };
  var _iterator9 = _createForOfIteratorHelper(t.elements(e)),
    _step9;
  try {
    for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {
      var n = _step9.value;
      switch (n.localName) {
        case "start":
          r.start = t.attr(n, "val");
          break;
        case "lvlRestart":
          r.restart = t.intAttr(n, "val");
          break;
        case "numFmt":
          r.format = t.attr(n, "val");
          break;
        case "lvlText":
          r.text = t.attr(n, "val");
          break;
        case "lvlJc":
          r.justification = t.attr(n, "val");
          break;
        case "lvlPicBulletId":
          r.bulletPictureId = t.attr(n, "val");
          break;
        case "pStyle":
          r.paragraphStyle = t.attr(n, "val");
          break;
        case "pPr":
          r.paragraphProps = Xi(n, t);
          break;
        case "rPr":
          r.runProps = Vi(n, t);
      }
    }
  } catch (err) {
    _iterator9.e(err);
  } finally {
    _iterator9.f();
  }
  return r;
}
function Qi(e, t) {
  var r = {
    level: t.intAttr(e, "ilvl")
  };
  var _iterator10 = _createForOfIteratorHelper(t.elements(e)),
    _step10;
  try {
    for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {
      var n = _step10.value;
      switch (n.localName) {
        case "startOverride":
          r.start = t.intAttr(n, "val");
          break;
        case "lvl":
          r.numberingLevel = Ji(n, t);
      }
    }
  } catch (err) {
    _iterator10.e(err);
  } finally {
    _iterator10.f();
  }
  return r;
}
function es(e, t) {
  var r = t.element(e, "pict"),
    n = r && t.element(r, "shape"),
    a = n && t.element(n, "imagedata");
  return a ? {
    id: t.attr(e, "numPicBulletId"),
    referenceId: t.attr(a, "id"),
    style: t.attr(n, "style")
  } : null;
}
!function (e) {
  e.Continuous = "continuous", e.NextPage = "nextPage", e.NextColumn = "nextColumn", e.EvenPage = "evenPage", e.OddPage = "oddPage";
}(ji || (ji = {}));
var ts = /*#__PURE__*/function (_Ci3) {
  function ts(e, t, r) {
    var _this2;
    _classCallCheck(this, ts);
    _this2 = _callSuper(this, ts, [e, t]), _this2._documentParser = r;
    return _this2;
  }
  _inherits(ts, _Ci3);
  return _createClass(ts, [{
    key: "parseXml",
    value: function parseXml(e) {
      Object.assign(this, function (e, t) {
        var r = {
          numberings: [],
          abstractNumberings: [],
          bulletPictures: []
        };
        var _iterator11 = _createForOfIteratorHelper(t.elements(e)),
          _step11;
        try {
          for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {
            var n = _step11.value;
            switch (n.localName) {
              case "num":
                r.numberings.push(Yi(n, t));
                break;
              case "abstractNum":
                r.abstractNumberings.push(Gi(n, t));
                break;
              case "numPicBullet":
                r.bulletPictures.push(es(n, t));
            }
          }
        } catch (err) {
          _iterator11.e(err);
        } finally {
          _iterator11.f();
        }
        return r;
      }(e, this._package.xmlParser)), this.domNumberings = this._documentParser.parseNumberingFile(e);
    }
  }]);
}(Ci);
var rs = /*#__PURE__*/function (_Ci4) {
  function rs(e, t, r) {
    var _this3;
    _classCallCheck(this, rs);
    _this3 = _callSuper(this, rs, [e, t]), _this3._documentParser = r;
    return _this3;
  }
  _inherits(rs, _Ci4);
  return _createClass(rs, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.styles = this._documentParser.parseStylesFile(e);
    }
  }]);
}(Ci);
!function (e) {
  e.Document = "document", e.Paragraph = "paragraph", e.Run = "run", e.Break = "break", e.NoBreakHyphen = "noBreakHyphen", e.Table = "table", e.Row = "row", e.Cell = "cell", e.Hyperlink = "hyperlink", e.SmartTag = "smartTag", e.Drawing = "drawing", e.Image = "image", e.Text = "text", e.Tab = "tab", e.Symbol = "symbol", e.BookmarkStart = "bookmarkStart", e.BookmarkEnd = "bookmarkEnd", e.Footer = "footer", e.Header = "header", e.FootnoteReference = "footnoteReference", e.EndnoteReference = "endnoteReference", e.Footnote = "footnote", e.Endnote = "endnote", e.SimpleField = "simpleField", e.ComplexField = "complexField", e.Instruction = "instruction", e.VmlPicture = "vmlPicture", e.MmlMath = "mmlMath", e.MmlMathParagraph = "mmlMathParagraph", e.MmlFraction = "mmlFraction", e.MmlFunction = "mmlFunction", e.MmlFunctionName = "mmlFunctionName", e.MmlNumerator = "mmlNumerator", e.MmlDenominator = "mmlDenominator", e.MmlRadical = "mmlRadical", e.MmlBase = "mmlBase", e.MmlDegree = "mmlDegree", e.MmlSuperscript = "mmlSuperscript", e.MmlSubscript = "mmlSubscript", e.MmlPreSubSuper = "mmlPreSubSuper", e.MmlSubArgument = "mmlSubArgument", e.MmlSuperArgument = "mmlSuperArgument", e.MmlNary = "mmlNary", e.MmlDelimiter = "mmlDelimiter", e.MmlRun = "mmlRun", e.MmlEquationArray = "mmlEquationArray", e.MmlLimit = "mmlLimit", e.MmlLimitLower = "mmlLimitLower", e.MmlMatrix = "mmlMatrix", e.MmlMatrixRow = "mmlMatrixRow", e.MmlBox = "mmlBox", e.MmlBar = "mmlBar", e.MmlGroupChar = "mmlGroupChar", e.VmlElement = "vmlElement", e.Inserted = "inserted", e.Deleted = "deleted", e.DeletedText = "deletedText", e.Comment = "comment", e.CommentReference = "commentReference", e.CommentRangeStart = "commentRangeStart", e.CommentRangeEnd = "commentRangeEnd";
}(Ui || (Ui = {}));
var ns = /*#__PURE__*/_createClass(function ns() {
  _classCallCheck(this, ns);
  this.children = [], this.cssStyle = {};
});
var as = /*#__PURE__*/function (_ns) {
  function as() {
    var _this4;
    _classCallCheck(this, as);
    _this4 = _callSuper(this, as, arguments), _this4.type = Ui.Header;
    return _this4;
  }
  _inherits(as, _ns);
  return _createClass(as);
}(ns);
var is = /*#__PURE__*/function (_ns2) {
  function is() {
    var _this5;
    _classCallCheck(this, is);
    _this5 = _callSuper(this, is, arguments), _this5.type = Ui.Footer;
    return _this5;
  }
  _inherits(is, _ns2);
  return _createClass(is);
}(ns);
var ss = /*#__PURE__*/function (_Ci5) {
  function ss(e, t, r) {
    var _this6;
    _classCallCheck(this, ss);
    _this6 = _callSuper(this, ss, [e, t]), _this6._documentParser = r;
    return _this6;
  }
  _inherits(ss, _Ci5);
  return _createClass(ss, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.rootElement = this.createRootElement(), this.rootElement.children = this._documentParser.parseBodyElements(e);
    }
  }]);
}(Ci);
var os = /*#__PURE__*/function (_ss) {
  function os() {
    _classCallCheck(this, os);
    return _callSuper(this, os, arguments);
  }
  _inherits(os, _ss);
  return _createClass(os, [{
    key: "createRootElement",
    value: function createRootElement() {
      return new as();
    }
  }]);
}(ss);
var ls = /*#__PURE__*/function (_ss2) {
  function ls() {
    _classCallCheck(this, ls);
    return _callSuper(this, ls, arguments);
  }
  _inherits(ls, _ss2);
  return _createClass(ls, [{
    key: "createRootElement",
    value: function createRootElement() {
      return new is();
    }
  }]);
}(ss);
function cs(e) {
  if (void 0 !== e) return parseInt(e);
}
var hs = /*#__PURE__*/function (_Ci6) {
  function hs() {
    _classCallCheck(this, hs);
    return _callSuper(this, hs, arguments);
  }
  _inherits(hs, _Ci6);
  return _createClass(hs, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.props = function (e, t) {
        var r = {};
        var _iterator12 = _createForOfIteratorHelper(t.elements(e)),
          _step12;
        try {
          for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {
            var n = _step12.value;
            switch (n.localName) {
              case "Template":
                r.template = n.textContent;
                break;
              case "Pages":
                r.pages = cs(n.textContent);
                break;
              case "Words":
                r.words = cs(n.textContent);
                break;
              case "Characters":
                r.characters = cs(n.textContent);
                break;
              case "Application":
                r.application = n.textContent;
                break;
              case "Lines":
                r.lines = cs(n.textContent);
                break;
              case "Paragraphs":
                r.paragraphs = cs(n.textContent);
                break;
              case "Company":
                r.company = n.textContent;
                break;
              case "AppVersion":
                r.appVersion = n.textContent;
            }
          }
        } catch (err) {
          _iterator12.e(err);
        } finally {
          _iterator12.f();
        }
        return r;
      }(e, this._package.xmlParser);
    }
  }]);
}(Ci);
var us = /*#__PURE__*/function (_Ci7) {
  function us() {
    _classCallCheck(this, us);
    return _callSuper(this, us, arguments);
  }
  _inherits(us, _Ci7);
  return _createClass(us, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.props = function (e, t) {
        var r = {};
        var _iterator13 = _createForOfIteratorHelper(t.elements(e)),
          _step13;
        try {
          for (_iterator13.s(); !(_step13 = _iterator13.n()).done;) {
            var n = _step13.value;
            switch (n.localName) {
              case "title":
                r.title = n.textContent;
                break;
              case "description":
                r.description = n.textContent;
                break;
              case "subject":
                r.subject = n.textContent;
                break;
              case "creator":
                r.creator = n.textContent;
                break;
              case "keywords":
                r.keywords = n.textContent;
                break;
              case "language":
                r.language = n.textContent;
                break;
              case "lastModifiedBy":
                r.lastModifiedBy = n.textContent;
                break;
              case "revision":
                n.textContent && (r.revision = parseInt(n.textContent));
            }
          }
        } catch (err) {
          _iterator13.e(err);
        } finally {
          _iterator13.f();
        }
        return r;
      }(e, this._package.xmlParser);
    }
  }]);
}(Ci);
var ds = /*#__PURE__*/_createClass(function ds() {
  _classCallCheck(this, ds);
});
function fs(e, t) {
  var r = {
    name: t.attr(e, "name"),
    colors: {}
  };
  var _iterator14 = _createForOfIteratorHelper(t.elements(e)),
    _step14;
  try {
    for (_iterator14.s(); !(_step14 = _iterator14.n()).done;) {
      var _i2 = _step14.value;
      var n = t.element(_i2, "srgbClr"),
        a = t.element(_i2, "sysClr");
      n ? r.colors[_i2.localName] = t.attr(n, "val") : a && (r.colors[_i2.localName] = t.attr(a, "lastClr"));
    }
  } catch (err) {
    _iterator14.e(err);
  } finally {
    _iterator14.f();
  }
  return r;
}
function ps(e, t) {
  var r = {
    name: t.attr(e, "name")
  };
  var _iterator15 = _createForOfIteratorHelper(t.elements(e)),
    _step15;
  try {
    for (_iterator15.s(); !(_step15 = _iterator15.n()).done;) {
      var n = _step15.value;
      switch (n.localName) {
        case "majorFont":
          r.majorFont = ms(n, t);
          break;
        case "minorFont":
          r.minorFont = ms(n, t);
      }
    }
  } catch (err) {
    _iterator15.e(err);
  } finally {
    _iterator15.f();
  }
  return r;
}
function ms(e, t) {
  return {
    latinTypeface: t.elementAttr(e, "latin", "typeface"),
    eaTypeface: t.elementAttr(e, "ea", "typeface"),
    csTypeface: t.elementAttr(e, "cs", "typeface")
  };
}
var gs = /*#__PURE__*/function (_Ci8) {
  function gs(e, t) {
    _classCallCheck(this, gs);
    return _callSuper(this, gs, [e, t]);
  }
  _inherits(gs, _Ci8);
  return _createClass(gs, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.theme = function (e, t) {
        var r = new ds(),
          n = t.element(e, "themeElements");
        var _iterator16 = _createForOfIteratorHelper(t.elements(n)),
          _step16;
        try {
          for (_iterator16.s(); !(_step16 = _iterator16.n()).done;) {
            var _e2 = _step16.value;
            switch (_e2.localName) {
              case "clrScheme":
                r.colorScheme = fs(_e2, t);
                break;
              case "fontScheme":
                r.fontScheme = ps(_e2, t);
            }
          }
        } catch (err) {
          _iterator16.e(err);
        } finally {
          _iterator16.f();
        }
        return r;
      }(e, this._package.xmlParser);
    }
  }]);
}(Ci);
var bs = /*#__PURE__*/_createClass(function bs() {
  _classCallCheck(this, bs);
});
var ys = /*#__PURE__*/function (_bs) {
  function ys() {
    var _this7;
    _classCallCheck(this, ys);
    _this7 = _callSuper(this, ys, arguments), _this7.type = Ui.Footnote;
    return _this7;
  }
  _inherits(ys, _bs);
  return _createClass(ys);
}(bs);
var vs = /*#__PURE__*/function (_bs2) {
  function vs() {
    var _this8;
    _classCallCheck(this, vs);
    _this8 = _callSuper(this, vs, arguments), _this8.type = Ui.Endnote;
    return _this8;
  }
  _inherits(vs, _bs2);
  return _createClass(vs);
}(bs);
var ws = /*#__PURE__*/function (_Ci9) {
  function ws(e, t, r) {
    var _this9;
    _classCallCheck(this, ws);
    _this9 = _callSuper(this, ws, [e, t]), _this9._documentParser = r;
    return _this9;
  }
  _inherits(ws, _Ci9);
  return _createClass(ws);
}(Ci);
var _s = /*#__PURE__*/function (_ws) {
  function _s(e, t, r) {
    _classCallCheck(this, _s);
    return _callSuper(this, _s, [e, t, r]);
  }
  _inherits(_s, _ws);
  return _createClass(_s, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.notes = this._documentParser.parseNotes(e, "footnote", ys);
    }
  }]);
}(ws);
var ks = /*#__PURE__*/function (_ws2) {
  function ks(e, t, r) {
    _classCallCheck(this, ks);
    return _callSuper(this, ks, [e, t, r]);
  }
  _inherits(ks, _ws2);
  return _createClass(ks, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.notes = this._documentParser.parseNotes(e, "endnote", vs);
    }
  }]);
}(ws);
function Ss(e, t) {
  var r = {
    defaultNoteIds: []
  };
  var _iterator17 = _createForOfIteratorHelper(t.elements(e)),
    _step17;
  try {
    for (_iterator17.s(); !(_step17 = _iterator17.n()).done;) {
      var n = _step17.value;
      switch (n.localName) {
        case "numFmt":
          r.nummeringFormat = t.attr(n, "val");
          break;
        case "footnote":
        case "endnote":
          r.defaultNoteIds.push(t.attr(n, "id"));
      }
    }
  } catch (err) {
    _iterator17.e(err);
  } finally {
    _iterator17.f();
  }
  return r;
}
var xs = /*#__PURE__*/function (_Ci10) {
  function xs(e, t) {
    _classCallCheck(this, xs);
    return _callSuper(this, xs, [e, t]);
  }
  _inherits(xs, _Ci10);
  return _createClass(xs, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.settings = function (e, t) {
        var r = {};
        var _iterator18 = _createForOfIteratorHelper(t.elements(e)),
          _step18;
        try {
          for (_iterator18.s(); !(_step18 = _iterator18.n()).done;) {
            var n = _step18.value;
            switch (n.localName) {
              case "defaultTabStop":
                r.defaultTabStop = t.lengthAttr(n, "val");
                break;
              case "footnotePr":
                r.footnoteProps = Ss(n, t);
                break;
              case "endnotePr":
                r.endnoteProps = Ss(n, t);
                break;
              case "autoHyphenation":
                r.autoHyphenation = t.boolAttr(n, "val");
            }
          }
        } catch (err) {
          _iterator18.e(err);
        } finally {
          _iterator18.f();
        }
        return r;
      }(e, this._package.xmlParser);
    }
  }]);
}(Ci);
var Cs = /*#__PURE__*/function (_Ci11) {
  function Cs() {
    _classCallCheck(this, Cs);
    return _callSuper(this, Cs, arguments);
  }
  _inherits(Cs, _Ci11);
  return _createClass(Cs, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.props = function (e, t) {
        return t.elements(e, "property").map(function (e) {
          var r = e.firstChild;
          return {
            formatId: t.attr(e, "fmtid"),
            name: t.attr(e, "name"),
            type: r.nodeName,
            value: r.textContent
          };
        });
      }(e, this._package.xmlParser);
    }
  }]);
}(Ci);
var Es = /*#__PURE__*/function (_Ci12) {
  function Es(e, t, r) {
    var _this10;
    _classCallCheck(this, Es);
    _this10 = _callSuper(this, Es, [e, t]), _this10._documentParser = r;
    return _this10;
  }
  _inherits(Es, _Ci12);
  return _createClass(Es, [{
    key: "parseXml",
    value: function parseXml(e) {
      this.comments = this._documentParser.parseComments(e), this.commentMap = Bi(this.comments, function (e) {
        return e.id;
      });
    }
  }]);
}(Ci);
var Ps = /*#__PURE__*/function (_Ci13) {
  function Ps(e, t) {
    var _this11;
    _classCallCheck(this, Ps);
    _this11 = _callSuper(this, Ps, [e, t]), _this11.comments = [];
    return _this11;
  }
  _inherits(Ps, _Ci13);
  return _createClass(Ps, [{
    key: "parseXml",
    value: function parseXml(e) {
      var t = this._package.xmlParser;
      var _iterator19 = _createForOfIteratorHelper(t.elements(e, "commentEx")),
        _step19;
      try {
        for (_iterator19.s(); !(_step19 = _iterator19.n()).done;) {
          var _r6 = _step19.value;
          this.comments.push({
            paraId: t.attr(_r6, "paraId"),
            paraIdParent: t.attr(_r6, "paraIdParent"),
            done: t.boolAttr(_r6, "done")
          });
        }
      } catch (err) {
        _iterator19.e(err);
      } finally {
        _iterator19.f();
      }
      this.commentMap = Bi(this.comments, function (e) {
        return e.paraId;
      });
    }
  }]);
}(Ci);
var As = [{
  type: di.OfficeDocument,
  target: "word/document.xml"
}, {
  type: di.ExtendedProperties,
  target: "docProps/app.xml"
}, {
  type: di.CoreProperties,
  target: "docProps/core.xml"
}, {
  type: di.CustomProperties,
  target: "docProps/custom.xml"
}];
var Ts = /*#__PURE__*/function () {
  function Ts() {
    _classCallCheck(this, Ts);
    this.parts = [], this.partsMap = {};
  }
  return _createClass(Ts, [{
    key: "save",
    value: function save() {
      var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "blob";
      return this._package.save(e);
    }
  }, {
    key: "loadRelationshipPart",
    value: function () {
      var _loadRelationshipPart = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(e, t) {
        var _r$rels,
          _this12 = this;
        var r, _Ni3, _Ni4, _e3;
        return _regeneratorRuntime().wrap(function _callee4$(_context4) {
          while (1) switch (_context4.prev = _context4.next) {
            case 0:
              if (!this.partsMap[e]) {
                _context4.next = 2;
                break;
              }
              return _context4.abrupt("return", this.partsMap[e]);
            case 2:
              if (this._package.get(e)) {
                _context4.next = 4;
                break;
              }
              return _context4.abrupt("return", null);
            case 4:
              r = null;
              _context4.t0 = t;
              _context4.next = _context4.t0 === di.OfficeDocument ? 8 : _context4.t0 === di.FontTable ? 10 : _context4.t0 === di.Numbering ? 12 : _context4.t0 === di.Styles ? 14 : _context4.t0 === di.Theme ? 16 : _context4.t0 === di.Footnotes ? 18 : _context4.t0 === di.Endnotes ? 20 : _context4.t0 === di.Footer ? 22 : _context4.t0 === di.Header ? 24 : _context4.t0 === di.CoreProperties ? 26 : _context4.t0 === di.ExtendedProperties ? 28 : _context4.t0 === di.CustomProperties ? 30 : _context4.t0 === di.Settings ? 32 : _context4.t0 === di.Comments ? 34 : _context4.t0 === di.CommentsExtended ? 36 : 37;
              break;
            case 8:
              this.documentPart = r = new zi(this._package, e, this._parser);
              return _context4.abrupt("break", 37);
            case 10:
              this.fontTablePart = r = new Ti(this._package, e);
              return _context4.abrupt("break", 37);
            case 12:
              this.numberingPart = r = new ts(this._package, e, this._parser);
              return _context4.abrupt("break", 37);
            case 14:
              this.stylesPart = r = new rs(this._package, e, this._parser);
              return _context4.abrupt("break", 37);
            case 16:
              this.themePart = r = new gs(this._package, e);
              return _context4.abrupt("break", 37);
            case 18:
              this.footnotesPart = r = new _s(this._package, e, this._parser);
              return _context4.abrupt("break", 37);
            case 20:
              this.endnotesPart = r = new ks(this._package, e, this._parser);
              return _context4.abrupt("break", 37);
            case 22:
              r = new ls(this._package, e, this._parser);
              return _context4.abrupt("break", 37);
            case 24:
              r = new os(this._package, e, this._parser);
              return _context4.abrupt("break", 37);
            case 26:
              this.corePropsPart = r = new us(this._package, e);
              return _context4.abrupt("break", 37);
            case 28:
              this.extendedPropsPart = r = new hs(this._package, e);
              return _context4.abrupt("break", 37);
            case 30:
              r = new Cs(this._package, e);
              return _context4.abrupt("break", 37);
            case 32:
              this.settingsPart = r = new xs(this._package, e);
              return _context4.abrupt("break", 37);
            case 34:
              this.commentsPart = r = new Es(this._package, e, this._parser);
              return _context4.abrupt("break", 37);
            case 36:
              this.commentsExtendedPart = r = new Ps(this._package, e);
            case 37:
              if (!(null == r)) {
                _context4.next = 39;
                break;
              }
              return _context4.abrupt("return", Promise.resolve(null));
            case 39:
              this.partsMap[e] = r;
              this.parts.push(r);
              _context4.next = 43;
              return r.load();
            case 43:
              if (!(((_r$rels = r.rels) === null || _r$rels === void 0 ? void 0 : _r$rels.length) > 0)) {
                _context4.next = 47;
                break;
              }
              _Ni3 = Ni(r.path), _Ni4 = _slicedToArray(_Ni3, 1), _e3 = _Ni4[0];
              _context4.next = 47;
              return Promise.all(r.rels.map(function (t) {
                return _this12.loadRelationshipPart(Ri(t.target, _e3), t.type);
              }));
            case 47:
              return _context4.abrupt("return", r);
            case 48:
            case "end":
              return _context4.stop();
          }
        }, _callee4, this);
      }));
      function loadRelationshipPart(_x3, _x4) {
        return _loadRelationshipPart.apply(this, arguments);
      }
      return loadRelationshipPart;
    }()
  }, {
    key: "loadDocumentImage",
    value: function () {
      var _loadDocumentImage = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(e, t) {
        var r;
        return _regeneratorRuntime().wrap(function _callee5$(_context5) {
          while (1) switch (_context5.prev = _context5.next) {
            case 0:
              _context5.next = 2;
              return this.loadResource(t !== null && t !== void 0 ? t : this.documentPart, e, "blob");
            case 2:
              r = _context5.sent;
              return _context5.abrupt("return", this.blobToURL(r));
            case 4:
            case "end":
              return _context5.stop();
          }
        }, _callee5, this);
      }));
      function loadDocumentImage(_x5, _x6) {
        return _loadDocumentImage.apply(this, arguments);
      }
      return loadDocumentImage;
    }()
  }, {
    key: "loadNumberingImage",
    value: function () {
      var _loadNumberingImage = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(e) {
        var t;
        return _regeneratorRuntime().wrap(function _callee6$(_context6) {
          while (1) switch (_context6.prev = _context6.next) {
            case 0:
              _context6.next = 2;
              return this.loadResource(this.numberingPart, e, "blob");
            case 2:
              t = _context6.sent;
              return _context6.abrupt("return", this.blobToURL(t));
            case 4:
            case "end":
              return _context6.stop();
          }
        }, _callee6, this);
      }));
      function loadNumberingImage(_x7) {
        return _loadNumberingImage.apply(this, arguments);
      }
      return loadNumberingImage;
    }()
  }, {
    key: "loadFont",
    value: function () {
      var _loadFont = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(e, t) {
        var r;
        return _regeneratorRuntime().wrap(function _callee7$(_context7) {
          while (1) switch (_context7.prev = _context7.next) {
            case 0:
              _context7.next = 2;
              return this.loadResource(this.fontTablePart, e, "uint8array");
            case 2:
              r = _context7.sent;
              return _context7.abrupt("return", r ? this.blobToURL(new Blob([Ns(r, t)])) : r);
            case 4:
            case "end":
              return _context7.stop();
          }
        }, _callee7, this);
      }));
      function loadFont(_x8, _x9) {
        return _loadFont.apply(this, arguments);
      }
      return loadFont;
    }()
  }, {
    key: "blobToURL",
    value: function blobToURL(e) {
      return e ? this._options.useBase64URL ? function (e) {
        return new Promise(function (t, r) {
          var n = new FileReader();
          n.onloadend = function () {
            return t(n.result);
          }, n.onerror = function () {
            return r();
          }, n.readAsDataURL(e);
        });
      }(e) : URL.createObjectURL(e) : null;
    }
  }, {
    key: "findPartByRelId",
    value: function findPartByRelId(e) {
      var _t$rels;
      var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      var r = ((_t$rels = t.rels) !== null && _t$rels !== void 0 ? _t$rels : this.rels).find(function (t) {
        return t.id == e;
      });
      var n = t ? Ni(t.path)[0] : "";
      return r ? this.partsMap[Ri(r.target, n)] : null;
    }
  }, {
    key: "getPathById",
    value: function getPathById(e, t) {
      var r = e.rels.find(function (e) {
          return e.id == t;
        }),
        _Ni5 = Ni(e.path),
        _Ni6 = _slicedToArray(_Ni5, 1),
        n = _Ni6[0];
      return r ? Ri(r.target, n) : null;
    }
  }, {
    key: "loadResource",
    value: function loadResource(e, t, r) {
      var n = this.getPathById(e, t);
      return n ? this._package.load(n, r) : Promise.resolve(null);
    }
  }], [{
    key: "load",
    value: function () {
      var _load3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(e, t, r) {
        var n;
        return _regeneratorRuntime().wrap(function _callee8$(_context8) {
          while (1) switch (_context8.prev = _context8.next) {
            case 0:
              n = new Ts();
              n._options = r;
              n._parser = t;
              _context8.next = 5;
              return Ii.load(e, r);
            case 5:
              n._package = _context8.sent;
              _context8.next = 8;
              return n._package.loadRelationships();
            case 8:
              n.rels = _context8.sent;
              _context8.next = 11;
              return Promise.all(As.map(function (e) {
                var _n$rels$find;
                var t = (_n$rels$find = n.rels.find(function (t) {
                  return t.type === e.type;
                })) !== null && _n$rels$find !== void 0 ? _n$rels$find : e;
                return n.loadRelationshipPart(t.target, t.type);
              }));
            case 11:
              return _context8.abrupt("return", n);
            case 12:
            case "end":
              return _context8.stop();
          }
        }, _callee8);
      }));
      function load(_x10, _x11, _x12) {
        return _load3.apply(this, arguments);
      }
      return load;
    }()
  }]);
}();
function Ns(e, t) {
  var r = t.replace(/{|}|-/g, ""),
    n = new Array(16);
  for (var _e4 = 0; _e4 < 16; _e4++) n[16 - _e4 - 1] = parseInt(r.substr(2 * _e4, 2), 16);
  for (var _t4 = 0; _t4 < 32; _t4++) e[_t4] = e[_t4] ^ n[_t4 % 16];
  return e;
}
function Rs(e, t) {
  return {
    type: Ui.BookmarkEnd,
    id: t.attr(e, "id")
  };
}
var Bs = /*#__PURE__*/function (_ns3) {
  function Bs() {
    var _this13;
    _classCallCheck(this, Bs);
    _this13 = _callSuper(this, Bs, arguments), _this13.type = Ui.VmlElement, _this13.attrs = {};
    return _this13;
  }
  _inherits(Bs, _ns3);
  return _createClass(Bs);
}(ns);
function Ms(e, t) {
  var _r$children;
  var r = new Bs();
  switch (e.localName) {
    case "rect":
      r.tagName = "rect", Object.assign(r.attrs, {
        width: "100%",
        height: "100%"
      });
      break;
    case "oval":
      r.tagName = "ellipse", Object.assign(r.attrs, {
        cx: "50%",
        cy: "50%",
        rx: "50%",
        ry: "50%"
      });
      break;
    case "line":
      r.tagName = "line";
      break;
    case "shape":
      r.tagName = "g";
      break;
    case "textbox":
      r.tagName = "foreignObject", Object.assign(r.attrs, {
        width: "100%",
        height: "100%"
      });
      break;
    default:
      return null;
  }
  var _iterator20 = _createForOfIteratorHelper(xi.attrs(e)),
    _step20;
  try {
    for (_iterator20.s(); !(_step20 = _iterator20.n()).done;) {
      var _t5 = _step20.value;
      switch (_t5.localName) {
        case "style":
          r.cssStyleText = _t5.value;
          break;
        case "fillcolor":
          r.attrs.fill = _t5.value;
          break;
        case "from":
          var _Os = Os(_t5.value),
            _Os2 = _slicedToArray(_Os, 2),
            _e5 = _Os2[0],
            n = _Os2[1];
          Object.assign(r.attrs, {
            x1: _e5,
            y1: n
          });
          break;
        case "to":
          var _Os3 = Os(_t5.value),
            _Os4 = _slicedToArray(_Os3, 2),
            a = _Os4[0],
            _i3 = _Os4[1];
          Object.assign(r.attrs, {
            x2: a,
            y2: _i3
          });
      }
    }
  } catch (err) {
    _iterator20.e(err);
  } finally {
    _iterator20.f();
  }
  var _iterator21 = _createForOfIteratorHelper(xi.elements(e)),
    _step21;
  try {
    for (_iterator21.s(); !(_step21 = _iterator21.n()).done;) {
      var _n9 = _step21.value;
      switch (_n9.localName) {
        case "stroke":
          Object.assign(r.attrs, Ds(_n9));
          break;
        case "fill":
          Object.assign(r.attrs, {});
          break;
        case "imagedata":
          r.tagName = "image", Object.assign(r.attrs, {
            width: "100%",
            height: "100%"
          }), r.imageHref = {
            id: xi.attr(_n9, "id"),
            title: xi.attr(_n9, "title")
          };
          break;
        case "txbxContent":
          (_r$children = r.children).push.apply(_r$children, _toConsumableArray(t.parseBodyElements(_n9)));
          break;
        default:
          var _e6 = Ms(_n9, t);
          _e6 && r.children.push(_e6);
      }
    }
  } catch (err) {
    _iterator21.e(err);
  } finally {
    _iterator21.f();
  }
  return r;
}
function Ds(e) {
  var _xi$lengthAttr;
  return {
    stroke: xi.attr(e, "color"),
    "stroke-width": (_xi$lengthAttr = xi.lengthAttr(e, "weight", gi)) !== null && _xi$lengthAttr !== void 0 ? _xi$lengthAttr : "1px"
  };
}
function Os(e) {
  return e.split(",");
}
var Is = /*#__PURE__*/function (_ns4) {
  function Is() {
    var _this14;
    _classCallCheck(this, Is);
    _this14 = _callSuper(this, Is, arguments), _this14.type = Ui.Comment;
    return _this14;
  }
  _inherits(Is, _ns4);
  return _createClass(Is);
}(ns);
var zs = /*#__PURE__*/function (_ns5) {
  function zs(e) {
    var _this15;
    _classCallCheck(this, zs);
    _this15 = _callSuper(this, zs), _this15.id = e, _this15.type = Ui.CommentReference;
    return _this15;
  }
  _inherits(zs, _ns5);
  return _createClass(zs);
}(ns);
var Fs = /*#__PURE__*/function (_ns6) {
  function Fs(e) {
    var _this16;
    _classCallCheck(this, Fs);
    _this16 = _callSuper(this, Fs), _this16.id = e, _this16.type = Ui.CommentRangeStart;
    return _this16;
  }
  _inherits(Fs, _ns6);
  return _createClass(Fs);
}(ns);
var Ls = /*#__PURE__*/function (_ns7) {
  function Ls(e) {
    var _this17;
    _classCallCheck(this, Ls);
    _this17 = _callSuper(this, Ls), _this17.id = e, _this17.type = Ui.CommentRangeEnd;
    return _this17;
  }
  _inherits(Ls, _ns7);
  return _createClass(Ls);
}(ns);
var js = "inherit",
  Us = "black",
  $s = "black",
  Hs = "transparent";
var Ws = [],
  Zs = {
    oMath: Ui.MmlMath,
    oMathPara: Ui.MmlMathParagraph,
    f: Ui.MmlFraction,
    func: Ui.MmlFunction,
    fName: Ui.MmlFunctionName,
    num: Ui.MmlNumerator,
    den: Ui.MmlDenominator,
    rad: Ui.MmlRadical,
    deg: Ui.MmlDegree,
    e: Ui.MmlBase,
    sSup: Ui.MmlSuperscript,
    sSub: Ui.MmlSubscript,
    sPre: Ui.MmlPreSubSuper,
    sup: Ui.MmlSuperArgument,
    sub: Ui.MmlSubArgument,
    d: Ui.MmlDelimiter,
    nary: Ui.MmlNary,
    eqArr: Ui.MmlEquationArray,
    lim: Ui.MmlLimit,
    limLow: Ui.MmlLimitLower,
    m: Ui.MmlMatrix,
    mr: Ui.MmlMatrixRow,
    box: Ui.MmlBox,
    bar: Ui.MmlBar,
    groupChr: Ui.MmlGroupChar
  };
var Vs = /*#__PURE__*/function () {
  function Vs(e) {
    _classCallCheck(this, Vs);
    this.options = _objectSpread({
      ignoreWidth: !1,
      debug: !1
    }, e);
  }
  return _createClass(Vs, [{
    key: "parseNotes",
    value: function parseNotes(e, t, r) {
      var n = [];
      var _iterator22 = _createForOfIteratorHelper(xi.elements(e, t)),
        _step22;
      try {
        for (_iterator22.s(); !(_step22 = _iterator22.n()).done;) {
          var a = _step22.value;
          var _e7 = new r();
          _e7.id = xi.attr(a, "id"), _e7.noteType = xi.attr(a, "type"), _e7.children = this.parseBodyElements(a), n.push(_e7);
        }
      } catch (err) {
        _iterator22.e(err);
      } finally {
        _iterator22.f();
      }
      return n;
    }
  }, {
    key: "parseComments",
    value: function parseComments(e) {
      var t = [];
      var _iterator23 = _createForOfIteratorHelper(xi.elements(e, "comment")),
        _step23;
      try {
        for (_iterator23.s(); !(_step23 = _iterator23.n()).done;) {
          var _r7 = _step23.value;
          var _e8 = new Is();
          _e8.id = xi.attr(_r7, "id"), _e8.author = xi.attr(_r7, "author"), _e8.initials = xi.attr(_r7, "initials"), _e8.date = xi.attr(_r7, "date"), _e8.children = this.parseBodyElements(_r7), t.push(_e8);
        }
      } catch (err) {
        _iterator23.e(err);
      } finally {
        _iterator23.f();
      }
      return t;
    }
  }, {
    key: "parseDocumentFile",
    value: function parseDocumentFile(e) {
      var t = xi.element(e, "body"),
        r = xi.element(e, "background"),
        n = xi.element(t, "sectPr");
      return {
        type: Ui.Document,
        children: this.parseBodyElements(t),
        props: n ? $i(n, xi) : {},
        cssStyle: r ? this.parseBackground(r) : {}
      };
    }
  }, {
    key: "parseBackground",
    value: function parseBackground(e) {
      var t = {},
        r = Xs.colorAttr(e, "color");
      return r && (t["background-color"] = r), t;
    }
  }, {
    key: "parseBodyElements",
    value: function parseBodyElements(e) {
      var _this18 = this;
      var t = [];
      var _iterator24 = _createForOfIteratorHelper(xi.elements(e)),
        _step24;
      try {
        for (_iterator24.s(); !(_step24 = _iterator24.n()).done;) {
          var _r8 = _step24.value;
          switch (_r8.localName) {
            case "p":
              t.push(this.parseParagraph(_r8));
              break;
            case "tbl":
              t.push(this.parseTable(_r8));
              break;
            case "sdt":
              t.push.apply(t, _toConsumableArray(this.parseSdt(_r8, function (e) {
                return _this18.parseBodyElements(e);
              })));
          }
        }
      } catch (err) {
        _iterator24.e(err);
      } finally {
        _iterator24.f();
      }
      return t;
    }
  }, {
    key: "parseStylesFile",
    value: function parseStylesFile(e) {
      var _this19 = this;
      var t = [];
      return Xs.foreach(e, function (e) {
        switch (e.localName) {
          case "style":
            t.push(_this19.parseStyle(e));
            break;
          case "docDefaults":
            t.push(_this19.parseDefaultStyles(e));
        }
      }), t;
    }
  }, {
    key: "parseDefaultStyles",
    value: function parseDefaultStyles(e) {
      var _this20 = this;
      var t = {
        id: null,
        name: null,
        target: null,
        basedOn: null,
        styles: []
      };
      return Xs.foreach(e, function (e) {
        switch (e.localName) {
          case "rPrDefault":
            var r = xi.element(e, "rPr");
            r && t.styles.push({
              target: "span",
              values: _this20.parseDefaultProperties(r, {})
            });
            break;
          case "pPrDefault":
            var n = xi.element(e, "pPr");
            n && t.styles.push({
              target: "p",
              values: _this20.parseDefaultProperties(n, {})
            });
        }
      }), t;
    }
  }, {
    key: "parseStyle",
    value: function parseStyle(e) {
      var _this21 = this;
      var t = {
        id: xi.attr(e, "styleId"),
        isDefault: xi.boolAttr(e, "default"),
        name: null,
        target: null,
        basedOn: null,
        styles: [],
        linked: null
      };
      switch (xi.attr(e, "type")) {
        case "paragraph":
          t.target = "p";
          break;
        case "table":
          t.target = "table";
          break;
        case "character":
          t.target = "span";
      }
      return Xs.foreach(e, function (e) {
        switch (e.localName) {
          case "basedOn":
            t.basedOn = xi.attr(e, "val");
            break;
          case "name":
            t.name = xi.attr(e, "val");
            break;
          case "link":
            t.linked = xi.attr(e, "val");
            break;
          case "next":
            t.next = xi.attr(e, "val");
            break;
          case "aliases":
            t.aliases = xi.attr(e, "val").split(",");
            break;
          case "pPr":
            t.styles.push({
              target: "p",
              values: _this21.parseDefaultProperties(e, {})
            }), t.paragraphProps = Xi(e, xi);
            break;
          case "rPr":
            t.styles.push({
              target: "span",
              values: _this21.parseDefaultProperties(e, {})
            }), t.runProps = Vi(e, xi);
            break;
          case "tblPr":
          case "tcPr":
            t.styles.push({
              target: "td",
              values: _this21.parseDefaultProperties(e, {})
            });
            break;
          case "tblStylePr":
            var _iterator25 = _createForOfIteratorHelper(_this21.parseTableStyle(e)),
              _step25;
            try {
              for (_iterator25.s(); !(_step25 = _iterator25.n()).done;) {
                var _r9 = _step25.value;
                t.styles.push(_r9);
              }
            } catch (err) {
              _iterator25.e(err);
            } finally {
              _iterator25.f();
            }
            break;
          case "rsid":
          case "qFormat":
          case "hidden":
          case "semiHidden":
          case "unhideWhenUsed":
          case "autoRedefine":
          case "uiPriority":
            break;
          default:
            _this21.options.debug && console.warn("DOCX: Unknown style element: ".concat(e.localName));
        }
      }), t;
    }
  }, {
    key: "parseTableStyle",
    value: function parseTableStyle(e) {
      var _this22 = this;
      var t = [],
        r = xi.attr(e, "type"),
        n = "",
        a = "";
      switch (r) {
        case "firstRow":
          a = ".first-row", n = "tr.first-row td";
          break;
        case "lastRow":
          a = ".last-row", n = "tr.last-row td";
          break;
        case "firstCol":
          a = ".first-col", n = "td.first-col";
          break;
        case "lastCol":
          a = ".last-col", n = "td.last-col";
          break;
        case "band1Vert":
          a = ":not(.no-vband)", n = "td.odd-col";
          break;
        case "band2Vert":
          a = ":not(.no-vband)", n = "td.even-col";
          break;
        case "band1Horz":
          a = ":not(.no-hband)", n = "tr.odd-row";
          break;
        case "band2Horz":
          a = ":not(.no-hband)", n = "tr.even-row";
          break;
        default:
          return [];
      }
      return Xs.foreach(e, function (e) {
        switch (e.localName) {
          case "pPr":
            t.push({
              target: "".concat(n, " p"),
              mod: a,
              values: _this22.parseDefaultProperties(e, {})
            });
            break;
          case "rPr":
            t.push({
              target: "".concat(n, " span"),
              mod: a,
              values: _this22.parseDefaultProperties(e, {})
            });
            break;
          case "tblPr":
          case "tcPr":
            t.push({
              target: n,
              mod: a,
              values: _this22.parseDefaultProperties(e, {})
            });
        }
      }), t;
    }
  }, {
    key: "parseNumberingFile",
    value: function parseNumberingFile(e) {
      var _this23 = this;
      var t = [],
        r = {},
        n = [];
      return Xs.foreach(e, function (e) {
        switch (e.localName) {
          case "abstractNum":
            _this23.parseAbstractNumbering(e, n).forEach(function (e) {
              return t.push(e);
            });
            break;
          case "numPicBullet":
            n.push(_this23.parseNumberingPicBullet(e));
            break;
          case "num":
            var a = xi.attr(e, "numId"),
              i = xi.elementAttr(e, "abstractNumId", "val");
            r[i] = a;
        }
      }), t.forEach(function (e) {
        return e.id = r[e.id];
      }), t;
    }
  }, {
    key: "parseNumberingPicBullet",
    value: function parseNumberingPicBullet(e) {
      var t = xi.element(e, "pict"),
        r = t && xi.element(t, "shape"),
        n = r && xi.element(r, "imagedata");
      return n ? {
        id: xi.intAttr(e, "numPicBulletId"),
        src: xi.attr(n, "id"),
        style: xi.attr(r, "style")
      } : null;
    }
  }, {
    key: "parseAbstractNumbering",
    value: function parseAbstractNumbering(e, t) {
      var _this24 = this;
      var r = [],
        n = xi.attr(e, "abstractNumId");
      return Xs.foreach(e, function (e) {
        if ("lvl" === e.localName) r.push(_this24.parseNumberingLevel(n, e, t));
      }), r;
    }
  }, {
    key: "parseNumberingLevel",
    value: function parseNumberingLevel(e, t, r) {
      var _this25 = this;
      var n = {
        id: e,
        level: xi.intAttr(t, "ilvl"),
        start: 1,
        pStyleName: void 0,
        pStyle: {},
        rStyle: {},
        suff: "tab"
      };
      return Xs.foreach(t, function (e) {
        switch (e.localName) {
          case "start":
            n.start = xi.intAttr(e, "val");
            break;
          case "pPr":
            _this25.parseDefaultProperties(e, n.pStyle);
            break;
          case "rPr":
            _this25.parseDefaultProperties(e, n.rStyle);
            break;
          case "lvlPicBulletId":
            var t = xi.intAttr(e, "val");
            n.bullet = r.find(function (e) {
              return (e === null || e === void 0 ? void 0 : e.id) == t;
            });
            break;
          case "lvlText":
            n.levelText = xi.attr(e, "val");
            break;
          case "pStyle":
            n.pStyleName = xi.attr(e, "val");
            break;
          case "numFmt":
            n.format = xi.attr(e, "val");
            break;
          case "suff":
            n.suff = xi.attr(e, "val");
        }
      }), n;
    }
  }, {
    key: "parseSdt",
    value: function parseSdt(e, t) {
      var r = xi.element(e, "sdtContent");
      return r ? t(r) : [];
    }
  }, {
    key: "parseInserted",
    value: function parseInserted(e, t) {
      var _t$children, _t6;
      return {
        type: Ui.Inserted,
        children: (_t$children = (_t6 = t(e)) === null || _t6 === void 0 ? void 0 : _t6.children) !== null && _t$children !== void 0 ? _t$children : []
      };
    }
  }, {
    key: "parseDeleted",
    value: function parseDeleted(e, t) {
      var _t$children2, _t7;
      return {
        type: Ui.Deleted,
        children: (_t$children2 = (_t7 = t(e)) === null || _t7 === void 0 ? void 0 : _t7.children) !== null && _t$children2 !== void 0 ? _t$children2 : []
      };
    }
  }, {
    key: "parseParagraph",
    value: function parseParagraph(e) {
      var _n$children,
        _this26 = this;
      var t,
        r,
        n = {
          type: Ui.Paragraph,
          children: []
        };
      var _iterator26 = _createForOfIteratorHelper(xi.elements(e)),
        _step26;
      try {
        for (_iterator26.s(); !(_step26 = _iterator26.n()).done;) {
          var a = _step26.value;
          switch (a.localName) {
            case "pPr":
              this.parseParagraphProperties(a, n);
              break;
            case "r":
              n.children.push(this.parseRun(a, n));
              break;
            case "hyperlink":
              n.children.push(this.parseHyperlink(a, n));
              break;
            case "smartTag":
              n.children.push(this.parseSmartTag(a, n));
              break;
            case "bookmarkStart":
              n.children.push((t = a, r = xi, {
                type: Ui.BookmarkStart,
                id: r.attr(t, "id"),
                name: r.attr(t, "name"),
                colFirst: r.intAttr(t, "colFirst"),
                colLast: r.intAttr(t, "colLast")
              }));
              break;
            case "bookmarkEnd":
              n.children.push(Rs(a, xi));
              break;
            case "commentRangeStart":
              n.children.push(new Fs(xi.attr(a, "id")));
              break;
            case "commentRangeEnd":
              n.children.push(new Ls(xi.attr(a, "id")));
              break;
            case "oMath":
            case "oMathPara":
              n.children.push(this.parseMathElement(a));
              break;
            case "sdt":
              (_n$children = n.children).push.apply(_n$children, _toConsumableArray(this.parseSdt(a, function (e) {
                return _this26.parseParagraph(e).children;
              })));
              break;
            case "ins":
              n.children.push(this.parseInserted(a, function (e) {
                return _this26.parseParagraph(e);
              }));
              break;
            case "del":
              n.children.push(this.parseDeleted(a, function (e) {
                return _this26.parseParagraph(e);
              }));
          }
        }
      } catch (err) {
        _iterator26.e(err);
      } finally {
        _iterator26.f();
      }
      return n;
    }
  }, {
    key: "parseParagraphProperties",
    value: function parseParagraphProperties(e, t) {
      var _this27 = this;
      this.parseDefaultProperties(e, t.cssStyle = {}, null, function (e) {
        if (Ki(e, t, xi)) return !0;
        switch (e.localName) {
          case "pStyle":
            t.styleName = xi.attr(e, "val");
            break;
          case "cnfStyle":
            t.className = Ks.classNameOfCnfStyle(e);
            break;
          case "framePr":
            _this27.parseFrame(e, t);
            break;
          case "rPr":
            break;
          default:
            return !1;
        }
        return !0;
      });
    }
  }, {
    key: "parseFrame",
    value: function parseFrame(e, t) {
      "drop" == xi.attr(e, "dropCap") && (t.cssStyle.float = "left");
    }
  }, {
    key: "parseHyperlink",
    value: function parseHyperlink(e, t) {
      var _this28 = this;
      var r = {
          type: Ui.Hyperlink,
          parent: t,
          children: []
        },
        n = xi.attr(e, "anchor"),
        a = xi.attr(e, "id");
      return n && (r.href = "#" + n), a && (r.id = a), Xs.foreach(e, function (e) {
        if ("r" === e.localName) r.children.push(_this28.parseRun(e, r));
      }), r;
    }
  }, {
    key: "parseSmartTag",
    value: function parseSmartTag(e, t) {
      var _this29 = this;
      var r = {
          type: Ui.SmartTag,
          parent: t,
          children: []
        },
        n = xi.attr(e, "uri"),
        a = xi.attr(e, "element");
      return n && (r.uri = n), a && (r.element = a), Xs.foreach(e, function (e) {
        if ("r" === e.localName) r.children.push(_this29.parseRun(e, r));
      }), r;
    }
  }, {
    key: "parseRun",
    value: function parseRun(e, t) {
      var _this30 = this;
      var r = {
        type: Ui.Run,
        parent: t,
        children: []
      };
      return Xs.foreach(e, function (e) {
        switch ((e = _this30.checkAlternateContent(e)).localName) {
          case "t":
            r.children.push({
              type: Ui.Text,
              text: e.textContent
            });
            break;
          case "delText":
            r.children.push({
              type: Ui.DeletedText,
              text: e.textContent
            });
            break;
          case "commentReference":
            r.children.push(new zs(xi.attr(e, "id")));
            break;
          case "fldSimple":
            r.children.push({
              type: Ui.SimpleField,
              instruction: xi.attr(e, "instr"),
              lock: xi.boolAttr(e, "lock", !1),
              dirty: xi.boolAttr(e, "dirty", !1)
            });
            break;
          case "instrText":
            r.fieldRun = !0, r.children.push({
              type: Ui.Instruction,
              text: e.textContent
            });
            break;
          case "fldChar":
            r.fieldRun = !0, r.children.push({
              type: Ui.ComplexField,
              charType: xi.attr(e, "fldCharType"),
              lock: xi.boolAttr(e, "lock", !1),
              dirty: xi.boolAttr(e, "dirty", !1)
            });
            break;
          case "noBreakHyphen":
            r.children.push({
              type: Ui.NoBreakHyphen
            });
            break;
          case "br":
            r.children.push({
              type: Ui.Break,
              break: xi.attr(e, "type") || "textWrapping"
            });
            break;
          case "lastRenderedPageBreak":
            r.children.push({
              type: Ui.Break,
              break: "lastRenderedPageBreak"
            });
            break;
          case "sym":
            r.children.push({
              type: Ui.Symbol,
              font: xi.attr(e, "font"),
              char: xi.attr(e, "char")
            });
            break;
          case "tab":
            r.children.push({
              type: Ui.Tab
            });
            break;
          case "footnoteReference":
            r.children.push({
              type: Ui.FootnoteReference,
              id: xi.attr(e, "id")
            });
            break;
          case "endnoteReference":
            r.children.push({
              type: Ui.EndnoteReference,
              id: xi.attr(e, "id")
            });
            break;
          case "drawing":
            var _t8 = _this30.parseDrawing(e);
            _t8 && (r.children = [_t8]);
            break;
          case "pict":
            r.children.push(_this30.parseVmlPicture(e));
            break;
          case "rPr":
            _this30.parseRunProperties(e, r);
        }
      }), r;
    }
  }, {
    key: "parseMathElement",
    value: function parseMathElement(e) {
      var t = "".concat(e.localName, "Pr"),
        r = {
          type: Zs[e.localName],
          children: []
        };
      var _iterator27 = _createForOfIteratorHelper(xi.elements(e)),
        _step27;
      try {
        for (_iterator27.s(); !(_step27 = _iterator27.n()).done;) {
          var a = _step27.value;
          if (Zs[a.localName]) r.children.push(this.parseMathElement(a));else if ("r" == a.localName) {
            var n = this.parseRun(a);
            n.type = Ui.MmlRun, r.children.push(n);
          } else a.localName == t && (r.props = this.parseMathProperies(a));
        }
      } catch (err) {
        _iterator27.e(err);
      } finally {
        _iterator27.f();
      }
      return r;
    }
  }, {
    key: "parseMathProperies",
    value: function parseMathProperies(e) {
      var t = {};
      var _iterator28 = _createForOfIteratorHelper(xi.elements(e)),
        _step28;
      try {
        for (_iterator28.s(); !(_step28 = _iterator28.n()).done;) {
          var _r10 = _step28.value;
          switch (_r10.localName) {
            case "chr":
              t.char = xi.attr(_r10, "val");
              break;
            case "vertJc":
              t.verticalJustification = xi.attr(_r10, "val");
              break;
            case "pos":
              t.position = xi.attr(_r10, "val");
              break;
            case "degHide":
              t.hideDegree = xi.boolAttr(_r10, "val");
              break;
            case "begChr":
              t.beginChar = xi.attr(_r10, "val");
              break;
            case "endChr":
              t.endChar = xi.attr(_r10, "val");
          }
        }
      } catch (err) {
        _iterator28.e(err);
      } finally {
        _iterator28.f();
      }
      return t;
    }
  }, {
    key: "parseRunProperties",
    value: function parseRunProperties(e, t) {
      this.parseDefaultProperties(e, t.cssStyle = {}, null, function (e) {
        switch (e.localName) {
          case "rStyle":
            t.styleName = xi.attr(e, "val");
            break;
          case "vertAlign":
            t.verticalAlign = Ks.valueOfVertAlign(e, !0);
            break;
          default:
            return !1;
        }
        return !0;
      });
    }
  }, {
    key: "parseVmlPicture",
    value: function parseVmlPicture(e) {
      var t = {
        type: Ui.VmlPicture,
        children: []
      };
      var _iterator29 = _createForOfIteratorHelper(xi.elements(e)),
        _step29;
      try {
        for (_iterator29.s(); !(_step29 = _iterator29.n()).done;) {
          var _r11 = _step29.value;
          var _e9 = Ms(_r11, this);
          _e9 && t.children.push(_e9);
        }
      } catch (err) {
        _iterator29.e(err);
      } finally {
        _iterator29.f();
      }
      return t;
    }
  }, {
    key: "checkAlternateContent",
    value: function checkAlternateContent(e) {
      var _xi$element;
      if ("AlternateContent" != e.localName) return e;
      var t = xi.element(e, "Choice");
      if (t) {
        var r = xi.attr(t, "Requires"),
          n = e.lookupNamespaceURI(r);
        if (Ws.includes(n)) return t.firstElementChild;
      }
      return (_xi$element = xi.element(e, "Fallback")) === null || _xi$element === void 0 ? void 0 : _xi$element.firstElementChild;
    }
  }, {
    key: "parseDrawing",
    value: function parseDrawing(e) {
      var _iterator30 = _createForOfIteratorHelper(xi.elements(e)),
        _step30;
      try {
        for (_iterator30.s(); !(_step30 = _iterator30.n()).done;) {
          var t = _step30.value;
          switch (t.localName) {
            case "inline":
            case "anchor":
              return this.parseDrawingWrapper(t);
          }
        }
      } catch (err) {
        _iterator30.e(err);
      } finally {
        _iterator30.f();
      }
    }
  }, {
    key: "parseDrawingWrapper",
    value: function parseDrawingWrapper(e) {
      var t = {
          type: Ui.Drawing,
          children: [],
          cssStyle: {}
        },
        r = "anchor" == e.localName;
      var n = null,
        a = xi.boolAttr(e, "simplePos");
      xi.boolAttr(e, "behindDoc");
      var i = {
          relative: "page",
          align: "left",
          offset: "0"
        },
        s = {
          relative: "page",
          align: "top",
          offset: "0"
        };
      var _iterator31 = _createForOfIteratorHelper(xi.elements(e)),
        _step31;
      try {
        for (_iterator31.s(); !(_step31 = _iterator31.n()).done;) {
          var o = _step31.value;
          switch (o.localName) {
            case "simplePos":
              a && (i.offset = xi.lengthAttr(o, "x", gi), s.offset = xi.lengthAttr(o, "y", gi));
              break;
            case "extent":
              t.cssStyle.width = xi.lengthAttr(o, "cx", gi), t.cssStyle.height = xi.lengthAttr(o, "cy", gi);
              break;
            case "positionH":
            case "positionV":
              if (!a) {
                var _xi$attr;
                var _e10 = "positionH" == o.localName ? i : s;
                var l = xi.element(o, "align"),
                  c = xi.element(o, "posOffset");
                _e10.relative = (_xi$attr = xi.attr(o, "relativeFrom")) !== null && _xi$attr !== void 0 ? _xi$attr : _e10.relative, l && (_e10.align = l.textContent), c && (_e10.offset = Xs.sizeValue(c, gi));
              }
              break;
            case "wrapTopAndBottom":
              n = "wrapTopAndBottom";
              break;
            case "wrapNone":
              n = "wrapNone";
              break;
            case "graphic":
              var h = this.parseGraphic(o);
              h && t.children.push(h);
          }
        }
      } catch (err) {
        _iterator31.e(err);
      } finally {
        _iterator31.f();
      }
      return "wrapTopAndBottom" == n ? (t.cssStyle.display = "block", i.align && (t.cssStyle["text-align"] = i.align, t.cssStyle.width = "100%")) : "wrapNone" == n ? (t.cssStyle.display = "block", t.cssStyle.position = "relative", t.cssStyle.width = "0px", t.cssStyle.height = "0px", i.offset && (t.cssStyle.left = i.offset), s.offset && (t.cssStyle.top = s.offset)) : !r || "left" != i.align && "right" != i.align || (t.cssStyle.float = i.align), t;
    }
  }, {
    key: "parseGraphic",
    value: function parseGraphic(e) {
      var t = xi.element(e, "graphicData");
      var _iterator32 = _createForOfIteratorHelper(xi.elements(t)),
        _step32;
      try {
        for (_iterator32.s(); !(_step32 = _iterator32.n()).done;) {
          var _e11 = _step32.value;
          if ("pic" === _e11.localName) return this.parsePicture(_e11);
        }
      } catch (err) {
        _iterator32.e(err);
      } finally {
        _iterator32.f();
      }
      return null;
    }
  }, {
    key: "parsePicture",
    value: function parsePicture(e) {
      var t = {
          type: Ui.Image,
          src: "",
          cssStyle: {}
        },
        r = xi.element(e, "blipFill"),
        n = xi.element(r, "blip");
      t.src = xi.attr(n, "embed");
      var a = xi.element(e, "spPr"),
        i = xi.element(a, "xfrm");
      var _iterator33 = _createForOfIteratorHelper((t.cssStyle.position = "relative", xi.elements(i))),
        _step33;
      try {
        for (_iterator33.s(); !(_step33 = _iterator33.n()).done;) {
          var s = _step33.value;
          switch (s.localName) {
            case "ext":
              t.cssStyle.width = xi.lengthAttr(s, "cx", gi), t.cssStyle.height = xi.lengthAttr(s, "cy", gi);
              break;
            case "off":
              t.cssStyle.left = xi.lengthAttr(s, "x", gi), t.cssStyle.top = xi.lengthAttr(s, "y", gi);
          }
        }
      } catch (err) {
        _iterator33.e(err);
      } finally {
        _iterator33.f();
      }
      return t;
    }
  }, {
    key: "parseTable",
    value: function parseTable(e) {
      var _this31 = this;
      var t = {
        type: Ui.Table,
        children: []
      };
      return Xs.foreach(e, function (e) {
        switch (e.localName) {
          case "tr":
            t.children.push(_this31.parseTableRow(e));
            break;
          case "tblGrid":
            t.columns = _this31.parseTableColumns(e);
            break;
          case "tblPr":
            _this31.parseTableProperties(e, t);
        }
      }), t;
    }
  }, {
    key: "parseTableColumns",
    value: function parseTableColumns(e) {
      var t = [];
      return Xs.foreach(e, function (e) {
        if ("gridCol" === e.localName) t.push({
          width: xi.lengthAttr(e, "w")
        });
      }), t;
    }
  }, {
    key: "parseTableProperties",
    value: function parseTableProperties(e, t) {
      var _this32 = this;
      switch (t.cssStyle = {}, t.cellStyle = {}, this.parseDefaultProperties(e, t.cssStyle, t.cellStyle, function (e) {
        switch (e.localName) {
          case "tblStyle":
            t.styleName = xi.attr(e, "val");
            break;
          case "tblLook":
            t.className = Ks.classNameOftblLook(e);
            break;
          case "tblpPr":
            _this32.parseTablePosition(e, t);
            break;
          case "tblStyleColBandSize":
            t.colBandSize = xi.intAttr(e, "val");
            break;
          case "tblStyleRowBandSize":
            t.rowBandSize = xi.intAttr(e, "val");
            break;
          default:
            return !1;
        }
        return !0;
      }), t.cssStyle["text-align"]) {
        case "center":
          delete t.cssStyle["text-align"], t.cssStyle["margin-left"] = "auto", t.cssStyle["margin-right"] = "auto";
          break;
        case "right":
          delete t.cssStyle["text-align"], t.cssStyle["margin-left"] = "auto";
      }
    }
  }, {
    key: "parseTablePosition",
    value: function parseTablePosition(e, t) {
      var r = xi.lengthAttr(e, "topFromText"),
        n = xi.lengthAttr(e, "bottomFromText"),
        a = xi.lengthAttr(e, "rightFromText"),
        i = xi.lengthAttr(e, "leftFromText");
      t.cssStyle.float = "left", t.cssStyle["margin-bottom"] = Ks.addSize(t.cssStyle["margin-bottom"], n), t.cssStyle["margin-left"] = Ks.addSize(t.cssStyle["margin-left"], i), t.cssStyle["margin-right"] = Ks.addSize(t.cssStyle["margin-right"], a), t.cssStyle["margin-top"] = Ks.addSize(t.cssStyle["margin-top"], r);
    }
  }, {
    key: "parseTableRow",
    value: function parseTableRow(e) {
      var _this33 = this;
      var t = {
        type: Ui.Row,
        children: []
      };
      return Xs.foreach(e, function (e) {
        switch (e.localName) {
          case "tc":
            t.children.push(_this33.parseTableCell(e));
            break;
          case "trPr":
            _this33.parseTableRowProperties(e, t);
        }
      }), t;
    }
  }, {
    key: "parseTableRowProperties",
    value: function parseTableRowProperties(e, t) {
      t.cssStyle = this.parseDefaultProperties(e, {}, null, function (e) {
        switch (e.localName) {
          case "cnfStyle":
            t.className = Ks.classNameOfCnfStyle(e);
            break;
          case "tblHeader":
            t.isHeader = xi.boolAttr(e, "val");
            break;
          default:
            return !1;
        }
        return !0;
      });
    }
  }, {
    key: "parseTableCell",
    value: function parseTableCell(e) {
      var _this34 = this;
      var t = {
        type: Ui.Cell,
        children: []
      };
      return Xs.foreach(e, function (e) {
        switch (e.localName) {
          case "tbl":
            t.children.push(_this34.parseTable(e));
            break;
          case "p":
            t.children.push(_this34.parseParagraph(e));
            break;
          case "tcPr":
            _this34.parseTableCellProperties(e, t);
        }
      }), t;
    }
  }, {
    key: "parseTableCellProperties",
    value: function parseTableCellProperties(e, t) {
      t.cssStyle = this.parseDefaultProperties(e, {}, null, function (e) {
        var _xi$attr2;
        switch (e.localName) {
          case "gridSpan":
            t.span = xi.intAttr(e, "val", null);
            break;
          case "vMerge":
            t.verticalMerge = (_xi$attr2 = xi.attr(e, "val")) !== null && _xi$attr2 !== void 0 ? _xi$attr2 : "continue";
            break;
          case "cnfStyle":
            t.className = Ks.classNameOfCnfStyle(e);
            break;
          default:
            return !1;
        }
        return !0;
      });
    }
  }, {
    key: "parseDefaultProperties",
    value: function parseDefaultProperties(e) {
      var _this35 = this;
      var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
      return t = t || {}, Xs.foreach(e, function (a) {
        if (!(n !== null && n !== void 0 && n(a))) switch (a.localName) {
          case "jc":
            t["text-align"] = Ks.valueOfJc(a);
            break;
          case "textAlignment":
            t["vertical-align"] = Ks.valueOfTextAlignment(a);
            break;
          case "color":
            t.color = Xs.colorAttr(a, "val", null, Us);
            break;
          case "sz":
            t["font-size"] = t["min-height"] = xi.lengthAttr(a, "val", bi);
            break;
          case "shd":
            t["background-color"] = Xs.colorAttr(a, "fill", null, js);
            break;
          case "highlight":
            t["background-color"] = Xs.colorAttr(a, "val", null, Hs);
            break;
          case "vertAlign":
            break;
          case "position":
            t.verticalAlign = xi.lengthAttr(a, "val", bi);
            break;
          case "tcW":
            if (_this35.options.ignoreWidth) break;
          case "tblW":
            t.width = Ks.valueOfSize(a, "w");
            break;
          case "trHeight":
            _this35.parseTrHeight(a, t);
            break;
          case "strike":
            t["text-decoration"] = xi.boolAttr(a, "val", !0) ? "line-through" : "none";
            break;
          case "b":
            t["font-weight"] = xi.boolAttr(a, "val", !0) ? "bold" : "normal";
            break;
          case "i":
            t["font-style"] = xi.boolAttr(a, "val", !0) ? "italic" : "normal";
            break;
          case "caps":
            t["text-transform"] = xi.boolAttr(a, "val", !0) ? "uppercase" : "none";
            break;
          case "smallCaps":
            t["font-variant"] = xi.boolAttr(a, "val", !0) ? "small-caps" : "none";
            break;
          case "u":
            _this35.parseUnderline(a, t);
            break;
          case "ind":
          case "tblInd":
            _this35.parseIndentation(a, t);
            break;
          case "rFonts":
            _this35.parseFont(a, t);
            break;
          case "tblBorders":
            _this35.parseBorderProperties(a, r || t);
            break;
          case "tblCellSpacing":
            t["border-spacing"] = Ks.valueOfMargin(a), t["border-collapse"] = "separate";
            break;
          case "pBdr":
            _this35.parseBorderProperties(a, t);
            break;
          case "bdr":
            t.border = Ks.valueOfBorder(a);
            break;
          case "tcBorders":
            _this35.parseBorderProperties(a, t);
            break;
          case "vanish":
            xi.boolAttr(a, "val", !0) && (t.display = "none");
            break;
          case "kern":
          case "noWrap":
            break;
          case "tblCellMar":
          case "tcMar":
            _this35.parseMarginProperties(a, r || t);
            break;
          case "tblLayout":
            t["table-layout"] = Ks.valueOfTblLayout(a);
            break;
          case "vAlign":
            t["vertical-align"] = Ks.valueOfTextAlignment(a);
            break;
          case "spacing":
            "pPr" == e.localName && _this35.parseSpacing(a, t);
            break;
          case "wordWrap":
            xi.boolAttr(a, "val") && (t["overflow-wrap"] = "break-word");
            break;
          case "suppressAutoHyphens":
            t.hyphens = xi.boolAttr(a, "val", !0) ? "none" : "auto";
            break;
          case "lang":
            t.$lang = xi.attr(a, "val");
            break;
          case "bCs":
          case "iCs":
          case "szCs":
          case "tabs":
          case "outlineLvl":
          case "contextualSpacing":
          case "tblStyleColBandSize":
          case "tblStyleRowBandSize":
          case "webHidden":
          case "pageBreakBefore":
          case "suppressLineNumbers":
          case "keepLines":
          case "keepNext":
          case "widowControl":
          case "bidi":
          case "rtl":
          case "noProof":
            break;
          default:
            _this35.options.debug && console.warn("DOCX: Unknown document element: ".concat(e.localName, ".").concat(a.localName));
        }
      }), t;
    }
  }, {
    key: "parseUnderline",
    value: function parseUnderline(e, t) {
      var r = xi.attr(e, "val");
      if (null != r) {
        switch (r) {
          case "dash":
          case "dashDotDotHeavy":
          case "dashDotHeavy":
          case "dashedHeavy":
          case "dashLong":
          case "dashLongHeavy":
          case "dotDash":
          case "dotDotDash":
            t["text-decoration"] = "underline dashed";
            break;
          case "dotted":
          case "dottedHeavy":
            t["text-decoration"] = "underline dotted";
            break;
          case "double":
            t["text-decoration"] = "underline double";
            break;
          case "single":
          case "thick":
          case "words":
            t["text-decoration"] = "underline";
            break;
          case "wave":
          case "wavyDouble":
          case "wavyHeavy":
            t["text-decoration"] = "underline wavy";
            break;
          case "none":
            t["text-decoration"] = "none";
        }
        var n = Xs.colorAttr(e, "color");
        n && (t["text-decoration-color"] = n);
      }
    }
  }, {
    key: "parseFont",
    value: function parseFont(e, t) {
      var r = [xi.attr(e, "ascii"), Ks.themeValue(e, "asciiTheme")].filter(function (e) {
        return e;
      }).join(", ");
      r.length > 0 && (t["font-family"] = r);
    }
  }, {
    key: "parseIndentation",
    value: function parseIndentation(e, t) {
      var r = xi.lengthAttr(e, "firstLine"),
        n = xi.lengthAttr(e, "hanging"),
        a = xi.lengthAttr(e, "left"),
        i = xi.lengthAttr(e, "start"),
        s = xi.lengthAttr(e, "right"),
        o = xi.lengthAttr(e, "end");
      r && (t["text-indent"] = r), n && (t["text-indent"] = "-".concat(n)), (a || i) && (t["margin-left"] = a || i), (s || o) && (t["margin-right"] = s || o);
    }
  }, {
    key: "parseSpacing",
    value: function parseSpacing(e, t) {
      var r = xi.lengthAttr(e, "before"),
        n = xi.lengthAttr(e, "after"),
        a = xi.intAttr(e, "line", null),
        i = xi.attr(e, "lineRule");
      if (r && (t["margin-top"] = r), n && (t["margin-bottom"] = n), null !== a) switch (i) {
        case "auto":
          t["line-height"] = "".concat((a / 240).toFixed(2));
          break;
        case "atLeast":
          t["line-height"] = "calc(100% + ".concat(a / 20, "pt)");
          break;
        default:
          t["line-height"] = t["min-height"] = a / 20 + "pt";
      }
    }
  }, {
    key: "parseMarginProperties",
    value: function parseMarginProperties(e, t) {
      Xs.foreach(e, function (e) {
        switch (e.localName) {
          case "left":
            t["padding-left"] = Ks.valueOfMargin(e);
            break;
          case "right":
            t["padding-right"] = Ks.valueOfMargin(e);
            break;
          case "top":
            t["padding-top"] = Ks.valueOfMargin(e);
            break;
          case "bottom":
            t["padding-bottom"] = Ks.valueOfMargin(e);
        }
      });
    }
  }, {
    key: "parseTrHeight",
    value: function parseTrHeight(e, t) {
      xi.attr(e, "hRule"), t.height = xi.lengthAttr(e, "val");
    }
  }, {
    key: "parseBorderProperties",
    value: function parseBorderProperties(e, t) {
      Xs.foreach(e, function (e) {
        switch (e.localName) {
          case "start":
          case "left":
            t["border-left"] = Ks.valueOfBorder(e);
            break;
          case "end":
          case "right":
            t["border-right"] = Ks.valueOfBorder(e);
            break;
          case "top":
            t["border-top"] = Ks.valueOfBorder(e);
            break;
          case "bottom":
            t["border-bottom"] = Ks.valueOfBorder(e);
        }
      });
    }
  }]);
}();
var qs = ["black", "blue", "cyan", "darkBlue", "darkCyan", "darkGray", "darkGreen", "darkMagenta", "darkRed", "darkYellow", "green", "lightGray", "magenta", "none", "red", "white", "yellow"];
var Xs = /*#__PURE__*/function () {
  function Xs() {
    _classCallCheck(this, Xs);
  }
  return _createClass(Xs, null, [{
    key: "foreach",
    value: function foreach(e, t) {
      for (var r = 0; r < e.childNodes.length; r++) {
        var n = e.childNodes[r];
        n.nodeType == Node.ELEMENT_NODE && t(n);
      }
    }
  }, {
    key: "colorAttr",
    value: function colorAttr(e, t) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : "black";
      var a = xi.attr(e, t);
      if (a) return "auto" == a ? n : qs.includes(a) ? a : "#".concat(a);
      var i = xi.attr(e, "themeColor");
      return i ? "var(--docx-".concat(i, "-color)") : r;
    }
  }, {
    key: "sizeValue",
    value: function sizeValue(e) {
      var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : mi;
      return _i(e.textContent, t);
    }
  }]);
}();
var Ks = /*#__PURE__*/function () {
  function Ks() {
    _classCallCheck(this, Ks);
  }
  return _createClass(Ks, null, [{
    key: "themeValue",
    value: function themeValue(e, t) {
      var r = xi.attr(e, t);
      return r ? "var(--docx-".concat(r, "-font)") : null;
    }
  }, {
    key: "valueOfSize",
    value: function valueOfSize(e, t) {
      var r = mi;
      switch (xi.attr(e, "type")) {
        case "dxa":
          break;
        case "pct":
          r = wi;
          break;
        case "auto":
          return "auto";
      }
      return xi.lengthAttr(e, t, r);
    }
  }, {
    key: "valueOfMargin",
    value: function valueOfMargin(e) {
      return xi.lengthAttr(e, "w");
    }
  }, {
    key: "valueOfBorder",
    value: function valueOfBorder(e) {
      if ("nil" == xi.attr(e, "val")) return "none";
      var t = Xs.colorAttr(e, "color");
      return "".concat(xi.lengthAttr(e, "sz", yi), " solid ").concat("auto" == t ? $s : t);
    }
  }, {
    key: "valueOfTblLayout",
    value: function valueOfTblLayout(e) {
      return "fixed" == xi.attr(e, "val") ? "fixed" : "auto";
    }
  }, {
    key: "classNameOfCnfStyle",
    value: function classNameOfCnfStyle(e) {
      var t = xi.attr(e, "val");
      return ["first-row", "last-row", "first-col", "last-col", "odd-col", "even-col", "odd-row", "even-row", "ne-cell", "nw-cell", "se-cell", "sw-cell"].filter(function (e, r) {
        return "1" == t[r];
      }).join(" ");
    }
  }, {
    key: "valueOfJc",
    value: function valueOfJc(e) {
      var t = xi.attr(e, "val");
      switch (t) {
        case "start":
        case "left":
          return "left";
        case "center":
          return "center";
        case "end":
        case "right":
          return "right";
        case "both":
          return "justify";
      }
      return t;
    }
  }, {
    key: "valueOfVertAlign",
    value: function valueOfVertAlign(e) {
      var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;
      var r = xi.attr(e, "val");
      switch (r) {
        case "subscript":
          return "sub";
        case "superscript":
          return t ? "sup" : "super";
      }
      return t ? null : r;
    }
  }, {
    key: "valueOfTextAlignment",
    value: function valueOfTextAlignment(e) {
      var t = xi.attr(e, "val");
      switch (t) {
        case "auto":
        case "baseline":
          return "baseline";
        case "top":
          return "top";
        case "center":
          return "middle";
        case "bottom":
          return "bottom";
      }
      return t;
    }
  }, {
    key: "addSize",
    value: function addSize(e, t) {
      return null == e ? t : null == t ? e : "calc(".concat(e, " + ").concat(t, ")");
    }
  }, {
    key: "classNameOftblLook",
    value: function classNameOftblLook(e) {
      var t = xi.hexAttr(e, "val", 0);
      var r = "";
      return (xi.boolAttr(e, "firstRow") || 32 & t) && (r += " first-row"), (xi.boolAttr(e, "lastRow") || 64 & t) && (r += " last-row"), (xi.boolAttr(e, "firstColumn") || 128 & t) && (r += " first-col"), (xi.boolAttr(e, "lastColumn") || 256 & t) && (r += " last-col"), (xi.boolAttr(e, "noHBand") || 512 & t) && (r += " no-hband"), (xi.boolAttr(e, "noVBand") || 1024 & t) && (r += " no-vband"), r.trim();
    }
  }]);
}();
var Ys = {
  pos: 0,
  leader: "none",
  style: "left"
};
function Gs(e, t, r) {
  var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : .75;
  var a = e.closest("p"),
    i = e.getBoundingClientRect(),
    s = a.getBoundingClientRect(),
    o = getComputedStyle(a),
    l = (t === null || t === void 0 ? void 0 : t.length) > 0 ? t.map(function (e) {
      return {
        pos: Js(e.position),
        leader: e.leader,
        style: e.style
      };
    }).sort(function (e, t) {
      return e.pos - t.pos;
    }) : [Ys],
    c = l[l.length - 1],
    h = s.width * n,
    u = Js(r);
  var d = c.pos + u;
  if (d < h) for (; d < h && l.length < 50; d += u) l.push(_objectSpread(_objectSpread({}, Ys), {}, {
    pos: d
  }));
  var f = parseFloat(o.marginLeft),
    p = s.left + f,
    m = (i.left - p) * n,
    g = l.find(function (e) {
      return "clear" != e.style && e.pos > m;
    });
  if (null == g) return;
  var b = 1;
  if ("right" == g.style || "center" == g.style) {
    var _t9 = Array.from(a.querySelectorAll(".".concat(e.className))),
      _r12 = _t9.indexOf(e) + 1,
      _i4 = document.createRange();
    _i4.setStart(e, 1), _r12 < _t9.length ? _i4.setEndBefore(_t9[_r12]) : _i4.setEndAfter(a);
    var _o = "center" == g.style ? .5 : 1,
      _l = _i4.getBoundingClientRect(),
      _c = _l.left + _o * _l.width - (s.left - f);
    b = g.pos - _c * n;
  } else b = g.pos - m;
  switch (e.innerHTML = "&nbsp;", e.style.textDecoration = "inherit", e.style.wordSpacing = "".concat(b.toFixed(0), "pt"), g.leader) {
    case "dot":
    case "middleDot":
      e.style.textDecoration = "underline", e.style.textDecorationStyle = "dotted";
      break;
    case "hyphen":
    case "heavy":
    case "underscore":
      e.style.textDecoration = "underline";
  }
}
function Js(e) {
  return parseFloat(e);
}
var Qs = "http://www.w3.org/2000/svg",
  eo = "http://www.w3.org/1998/Math/MathML";
var to = /*#__PURE__*/function () {
  function to(e) {
    _classCallCheck(this, to);
    this.htmlDocument = e, this.className = "docx", this.styleMap = {}, this.currentPart = null, this.tableVerticalMerges = [], this.currentVerticalMerge = null, this.tableCellPositions = [], this.currentCellPosition = null, this.footnoteMap = {}, this.endnoteMap = {}, this.currentEndnoteIds = [], this.usedHederFooterParts = [], this.currentTabs = [], this.tabsTimeout = 0, this.commentMap = {}, this.tasks = [], this.postRenderTasks = [], this.createElement = ro;
  }
  return _createClass(to, [{
    key: "render",
    value: function render(e, t) {
      var _e$settingsPart$setti;
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      var n = arguments.length > 3 ? arguments[3] : undefined;
      this.document = e, this.options = n, this.className = n.className, this.rootSelector = n.inWrapper ? ".".concat(this.className, "-wrapper") : ":root", this.styleMap = null, this.tasks = [], this.options.renderComments && globalThis.Highlight && (this.commentHighlight = new Highlight()), io(r = r || t), io(t), lo(r, "docxjs library predefined styles"), r.appendChild(this.renderDefaultStyle()), e.themePart && (lo(r, "docxjs document theme values"), this.renderTheme(e.themePart, r)), null != e.stylesPart && (this.styleMap = this.processStyles(e.stylesPart.styles), lo(r, "docxjs document styles"), r.appendChild(this.renderStyles(e.stylesPart.styles))), e.numberingPart && (this.prodessNumberings(e.numberingPart.domNumberings), lo(r, "docxjs document numbering styles"), r.appendChild(this.renderNumbering(e.numberingPart.domNumberings, r))), e.footnotesPart && (this.footnoteMap = Bi(e.footnotesPart.notes, function (e) {
        return e.id;
      })), e.endnotesPart && (this.endnoteMap = Bi(e.endnotesPart.notes, function (e) {
        return e.id;
      })), e.settingsPart && (this.defaultTabSize = (_e$settingsPart$setti = e.settingsPart.settings) === null || _e$settingsPart$setti === void 0 ? void 0 : _e$settingsPart$setti.defaultTabStop), !n.ignoreFonts && e.fontTablePart && this.renderFontTable(e.fontTablePart, r);
      var a = this.renderSections(e.documentPart.body);
      this.options.inWrapper ? t.appendChild(this.renderWrapper(a)) : so(t, a), this.commentHighlight && n.renderComments && CSS.highlights.set("".concat(this.className, "-comments"), this.commentHighlight), this.refreshTabStops(), this.postRenderTasks.forEach(function (e) {
        return e();
      });
    }
  }, {
    key: "renderTheme",
    value: function renderTheme(e, t) {
      var _e$theme, _e$theme2;
      var r = {},
        n = (_e$theme = e.theme) === null || _e$theme === void 0 ? void 0 : _e$theme.fontScheme;
      n && (n.majorFont && (r["--docx-majorHAnsi-font"] = n.majorFont.latinTypeface), n.minorFont && (r["--docx-minorHAnsi-font"] = n.minorFont.latinTypeface));
      var a = (_e$theme2 = e.theme) === null || _e$theme2 === void 0 ? void 0 : _e$theme2.colorScheme;
      if (a) for (var _i5 = 0, _Object$entries = Object.entries(a.colors); _i5 < _Object$entries.length; _i5++) {
        var _Object$entries$_i = _slicedToArray(_Object$entries[_i5], 2),
          _e12 = _Object$entries$_i[0],
          _t10 = _Object$entries$_i[1];
        r["--docx-".concat(_e12, "-color")] = "#".concat(_t10);
      }
      var i = this.styleToString(".".concat(this.className), r);
      t.appendChild(oo(i));
    }
  }, {
    key: "renderFontTable",
    value: function renderFontTable(e, t) {
      var _this36 = this;
      var _iterator34 = _createForOfIteratorHelper(e.fonts),
        _step34;
      try {
        var _loop = function _loop() {
          var r = _step34.value;
          var _iterator35 = _createForOfIteratorHelper(r.embedFontRefs),
            _step35;
          try {
            var _loop2 = function _loop2() {
              var e = _step35.value;
              _this36.tasks.push(_this36.document.loadFont(e.id, e.key).then(function (n) {
                var a = {
                  "font-family": r.name,
                  src: "url(".concat(n, ")")
                };
                "bold" != e.type && "boldItalic" != e.type || (a["font-weight"] = "bold"), "italic" != e.type && "boldItalic" != e.type || (a["font-style"] = "italic"), lo(t, "docxjs ".concat(r.name, " font"));
                var i = _this36.styleToString("@font-face", a);
                t.appendChild(oo(i)), _this36.refreshTabStops();
              }));
            };
            for (_iterator35.s(); !(_step35 = _iterator35.n()).done;) {
              _loop2();
            }
          } catch (err) {
            _iterator35.e(err);
          } finally {
            _iterator35.f();
          }
        };
        for (_iterator34.s(); !(_step34 = _iterator34.n()).done;) {
          _loop();
        }
      } catch (err) {
        _iterator34.e(err);
      } finally {
        _iterator34.f();
      }
    }
  }, {
    key: "processStyleName",
    value: function processStyleName(e) {
      return e ? "".concat(this.className, "_").concat(function (e) {
        return e === null || e === void 0 ? void 0 : e.replace(/[ .]+/g, "-").replace(/[&]+/g, "and").toLowerCase();
      }(e)) : this.className;
    }
  }, {
    key: "processStyles",
    value: function processStyles(e) {
      var _this37 = this;
      var t = Bi(e.filter(function (e) {
        return null != e.id;
      }), function (e) {
        return e.id;
      });
      var _iterator36 = _createForOfIteratorHelper(e.filter(function (e) {
          return e.basedOn;
        })),
        _step36;
      try {
        for (_iterator36.s(); !(_step36 = _iterator36.n()).done;) {
          var n = _step36.value;
          var r = t[n.basedOn];
          if (r) {
            n.paragraphProps = Di(n.paragraphProps, r.paragraphProps), n.runProps = Di(n.runProps, r.runProps);
            var _iterator38 = _createForOfIteratorHelper(r.styles),
              _step38;
            try {
              var _loop3 = function _loop3() {
                var e = _step38.value;
                var t = n.styles.find(function (t) {
                  return t.target == e.target;
                });
                t ? _this37.copyStyleProperties(e.values, t.values) : n.styles.push(_objectSpread(_objectSpread({}, e), {}, {
                  values: _objectSpread({}, e.values)
                }));
              };
              for (_iterator38.s(); !(_step38 = _iterator38.n()).done;) {
                _loop3();
              }
            } catch (err) {
              _iterator38.e(err);
            } finally {
              _iterator38.f();
            }
          } else this.options.debug && console.warn("Can't find base style ".concat(n.basedOn));
        }
      } catch (err) {
        _iterator36.e(err);
      } finally {
        _iterator36.f();
      }
      var _iterator37 = _createForOfIteratorHelper(e),
        _step37;
      try {
        for (_iterator37.s(); !(_step37 = _iterator37.n()).done;) {
          var _t11 = _step37.value;
          _t11.cssName = this.processStyleName(_t11.id);
        }
      } catch (err) {
        _iterator37.e(err);
      } finally {
        _iterator37.f();
      }
      return t;
    }
  }, {
    key: "prodessNumberings",
    value: function prodessNumberings(e) {
      var _iterator39 = _createForOfIteratorHelper(e.filter(function (e) {
          return e.pStyleName;
        })),
        _step39;
      try {
        for (_iterator39.s(); !(_step39 = _iterator39.n()).done;) {
          var _e13$paragraphProps;
          var _t12 = _step39.value;
          var _e13 = this.findStyle(_t12.pStyleName);
          (_e13 === null || _e13 === void 0 || (_e13$paragraphProps = _e13.paragraphProps) === null || _e13$paragraphProps === void 0 ? void 0 : _e13$paragraphProps.numbering) && (_e13.paragraphProps.numbering.level = _t12.level);
        }
      } catch (err) {
        _iterator39.e(err);
      } finally {
        _iterator39.f();
      }
    }
  }, {
    key: "processElement",
    value: function processElement(e) {
      if (e.children) {
        var _iterator40 = _createForOfIteratorHelper(e.children),
          _step40;
        try {
          for (_iterator40.s(); !(_step40 = _iterator40.n()).done;) {
            var t = _step40.value;
            t.parent = e, t.type == Ui.Table ? this.processTable(t) : this.processElement(t);
          }
        } catch (err) {
          _iterator40.e(err);
        } finally {
          _iterator40.f();
        }
      }
    }
  }, {
    key: "processTable",
    value: function processTable(e) {
      var _iterator41 = _createForOfIteratorHelper(e.children),
        _step41;
      try {
        for (_iterator41.s(); !(_step41 = _iterator41.n()).done;) {
          var t = _step41.value;
          var _iterator42 = _createForOfIteratorHelper(t.children),
            _step42;
          try {
            for (_iterator42.s(); !(_step42 = _iterator42.n()).done;) {
              var r = _step42.value;
              r.cssStyle = this.copyStyleProperties(e.cellStyle, r.cssStyle, ["border-left", "border-right", "border-top", "border-bottom", "padding-left", "padding-right", "padding-top", "padding-bottom"]), this.processElement(r);
            }
          } catch (err) {
            _iterator42.e(err);
          } finally {
            _iterator42.f();
          }
        }
      } catch (err) {
        _iterator41.e(err);
      } finally {
        _iterator41.f();
      }
    }
  }, {
    key: "copyStyleProperties",
    value: function copyStyleProperties(e, t) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      if (!e) return t;
      var _iterator43 = _createForOfIteratorHelper((null == t && (t = {}), null == r && (r = Object.getOwnPropertyNames(e)), r)),
        _step43;
      try {
        for (_iterator43.s(); !(_step43 = _iterator43.n()).done;) {
          var n = _step43.value;
          e.hasOwnProperty(n) && !t.hasOwnProperty(n) && (t[n] = e[n]);
        }
      } catch (err) {
        _iterator43.e(err);
      } finally {
        _iterator43.f();
      }
      return t;
    }
  }, {
    key: "createPageElement",
    value: function createPageElement(e, t) {
      var r = this.createElement("section", {
        className: e
      });
      return t && (t.pageMargins && (r.style.paddingLeft = t.pageMargins.left, r.style.paddingRight = t.pageMargins.right, r.style.paddingTop = t.pageMargins.top, r.style.paddingBottom = t.pageMargins.bottom), t.pageSize && (this.options.ignoreWidth || (r.style.width = t.pageSize.width), this.options.ignoreHeight || (r.style.minHeight = t.pageSize.height))), r;
    }
  }, {
    key: "createSectionContent",
    value: function createSectionContent(e) {
      var t = this.createElement("article");
      return e.columns && e.columns.numberOfColumns && (t.style.columnCount = "".concat(e.columns.numberOfColumns), t.style.columnGap = e.columns.space, e.columns.separator && (t.style.columnRule = "1px solid black")), t;
    }
  }, {
    key: "renderSections",
    value: function renderSections(e) {
      var t = [];
      this.processElement(e);
      var r = this.splitBySection(e.children, e.props),
        n = this.groupByPageBreaks(r);
      var a = null;
      for (var _r13 = 0, _s2 = n.length; _r13 < _s2; _r13++) {
        this.currentFootnoteIds = [];
        var _o2 = n[_r13][0].sectProps;
        var _l2 = this.createPageElement(this.className, _o2);
        this.renderStyleValues(e.cssStyle, _l2), this.options.renderHeaders && this.renderHeaderFooter(_o2.headerRefs, _o2, t.length, a != _o2, _l2);
        var _iterator44 = _createForOfIteratorHelper(n[_r13]),
          _step44;
        try {
          for (_iterator44.s(); !(_step44 = _iterator44.n()).done;) {
            var _e14 = _step44.value;
            var i = this.createSectionContent(_e14.sectProps);
            this.renderElements(_e14.elements, i), _l2.appendChild(i), _o2 = _e14.sectProps;
          }
        } catch (err) {
          _iterator44.e(err);
        } finally {
          _iterator44.f();
        }
        this.options.renderFootnotes && this.renderNotes(this.currentFootnoteIds, this.footnoteMap, _l2), this.options.renderEndnotes && _r13 == _s2 - 1 && this.renderNotes(this.currentEndnoteIds, this.endnoteMap, _l2), this.options.renderFooters && this.renderHeaderFooter(_o2.footerRefs, _o2, t.length, a != _o2, _l2), t.push(_l2), a = _o2;
      }
      return t;
    }
  }, {
    key: "renderHeaderFooter",
    value: function renderHeaderFooter(e, t, r, n, a) {
      if (e) {
        var _ref, _ref2;
        var i = (_ref = (_ref2 = t.titlePage && n ? e.find(function (e) {
            return "first" == e.type;
          }) : null) !== null && _ref2 !== void 0 ? _ref2 : r % 2 == 1 ? e.find(function (e) {
            return "even" == e.type;
          }) : null) !== null && _ref !== void 0 ? _ref : e.find(function (e) {
            return "default" == e.type;
          }),
          s = i && this.document.findPartByRelId(i.id, this.document.documentPart);
        if (s) {
          this.currentPart = s, this.usedHederFooterParts.includes(s.path) || (this.processElement(s.rootElement), this.usedHederFooterParts.push(s.path));
          var _this$renderElements = this.renderElements([s.rootElement], a),
            _this$renderElements2 = _slicedToArray(_this$renderElements, 1),
            _e15 = _this$renderElements2[0];
          t !== null && t !== void 0 && t.pageMargins && (s.rootElement.type === Ui.Header ? (_e15.style.marginTop = "calc(".concat(t.pageMargins.header, " - ").concat(t.pageMargins.top, ")"), _e15.style.minHeight = "calc(".concat(t.pageMargins.top, " - ").concat(t.pageMargins.header, ")")) : s.rootElement.type === Ui.Footer && (_e15.style.marginBottom = "calc(".concat(t.pageMargins.footer, " - ").concat(t.pageMargins.bottom, ")"), _e15.style.minHeight = "calc(".concat(t.pageMargins.bottom, " - ").concat(t.pageMargins.footer, ")"))), this.currentPart = null;
        }
      }
    }
  }, {
    key: "isPageBreakElement",
    value: function isPageBreakElement(e) {
      return e.type == Ui.Break && ("lastRenderedPageBreak" == e.break ? !this.options.ignoreLastRenderedPageBreak : "page" == e.break);
    }
  }, {
    key: "isPageBreakSection",
    value: function isPageBreakSection(e, t) {
      var _e$pageSize, _t$pageSize, _e$pageSize2, _t$pageSize2, _e$pageSize3, _t$pageSize3;
      return !!e && !!t && (((_e$pageSize = e.pageSize) === null || _e$pageSize === void 0 ? void 0 : _e$pageSize.orientation) != ((_t$pageSize = t.pageSize) === null || _t$pageSize === void 0 ? void 0 : _t$pageSize.orientation) || ((_e$pageSize2 = e.pageSize) === null || _e$pageSize2 === void 0 ? void 0 : _e$pageSize2.width) != ((_t$pageSize2 = t.pageSize) === null || _t$pageSize2 === void 0 ? void 0 : _t$pageSize2.width) || ((_e$pageSize3 = e.pageSize) === null || _e$pageSize3 === void 0 ? void 0 : _e$pageSize3.height) != ((_t$pageSize3 = t.pageSize) === null || _t$pageSize3 === void 0 ? void 0 : _t$pageSize3.height));
    }
  }, {
    key: "splitBySection",
    value: function splitBySection(e, t) {
      var _this38 = this;
      var r = {
          sectProps: null,
          elements: [],
          pageBreak: !1
        },
        n = [r];
      var _iterator45 = _createForOfIteratorHelper(e),
        _step45;
      try {
        for (_iterator45.s(); !(_step45 = _iterator45.n()).done;) {
          var _t13 = _step45.value;
          if (_t13.type == Ui.Paragraph) {
            var _e17$paragraphProps;
            var _e17 = this.findStyle(_t13.styleName);
            (_e17 === null || _e17 === void 0 || (_e17$paragraphProps = _e17.paragraphProps) === null || _e17$paragraphProps === void 0 ? void 0 : _e17$paragraphProps.pageBreakBefore) && (r.sectProps = a, r.pageBreak = !0, r = {
              sectProps: null,
              elements: [],
              pageBreak: !1
            }, n.push(r));
          }
          if (r.elements.push(_t13), _t13.type == Ui.Paragraph) {
            var _e18 = _t13;
            var a = _e18.sectionProps,
              i = -1,
              s = -1;
            if (this.options.breakPages && _e18.children && (i = _e18.children.findIndex(function (e) {
              var _e$children$findIndex, _e$children;
              return -1 != (s = (_e$children$findIndex = (_e$children = e.children) === null || _e$children === void 0 ? void 0 : _e$children.findIndex(_this38.isPageBreakElement.bind(_this38))) !== null && _e$children$findIndex !== void 0 ? _e$children$findIndex : -1);
            })), (a || -1 != i) && (r.sectProps = a, r.pageBreak = -1 != i, r = {
              sectProps: null,
              elements: [],
              pageBreak: !1
            }, n.push(r)), -1 != i) {
              var _n10 = _e18.children[i],
                _a4 = s < _n10.children.length - 1;
              if (i < _e18.children.length - 1 || _a4) {
                var o = _t13.children,
                  l = _objectSpread(_objectSpread({}, _t13), {}, {
                    children: o.slice(i)
                  });
                if (_t13.children = o.slice(0, i), r.elements.push(l), _a4) {
                  var _e19 = _n10.children,
                    _r14 = _objectSpread(_objectSpread({}, _n10), {}, {
                      children: _e19.slice(0, s)
                    });
                  _t13.children.push(_r14), _n10.children = _e19.slice(s);
                }
              }
            }
          }
        }
      } catch (err) {
        _iterator45.e(err);
      } finally {
        _iterator45.f();
      }
      var c = null;
      for (var _e16 = n.length - 1; _e16 >= 0; _e16--) {
        var _c2;
        null == n[_e16].sectProps ? n[_e16].sectProps = (_c2 = c) !== null && _c2 !== void 0 ? _c2 : t : c = n[_e16].sectProps;
      }
      return n;
    }
  }, {
    key: "groupByPageBreaks",
    value: function groupByPageBreaks(e) {
      var t,
        r = [];
      var n = [r];
      var _iterator46 = _createForOfIteratorHelper(e),
        _step46;
      try {
        for (_iterator46.s(); !(_step46 = _iterator46.n()).done;) {
          var a = _step46.value;
          r.push(a), (this.options.ignoreLastRenderedPageBreak || a.pageBreak || this.isPageBreakSection(t, a.sectProps)) && n.push(r = []), t = a.sectProps;
        }
      } catch (err) {
        _iterator46.e(err);
      } finally {
        _iterator46.f();
      }
      return n.filter(function (e) {
        return e.length > 0;
      });
    }
  }, {
    key: "renderWrapper",
    value: function renderWrapper(e) {
      return this.createElement("div", {
        className: "".concat(this.className, "-wrapper")
      }, e);
    }
  }, {
    key: "renderDefaultStyle",
    value: function renderDefaultStyle() {
      var e = this.className,
        t = "\n.".concat(e, "-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } \n.").concat(e, "-wrapper>section.").concat(e, " { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }\n.").concat(e, " { color: black; hyphens: auto; text-underline-position: from-font; }\nsection.").concat(e, " { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\nsection.").concat(e, ">article { margin-bottom: auto; z-index: 1; }\nsection.").concat(e, ">footer { z-index: 1; }\n.").concat(e, " table { border-collapse: collapse; }\n.").concat(e, " table td, .").concat(e, " table th { vertical-align: top; }\n.").concat(e, " p { margin: 0pt; min-height: 1em; }\n.").concat(e, " span { white-space: pre-wrap; overflow-wrap: break-word; }\n.").concat(e, " a { color: inherit; text-decoration: inherit; }\n.").concat(e, " svg { fill: transparent; }\n");
      return this.options.renderComments && (t += "\n.".concat(e, "-comment-ref { cursor: default; }\n.").concat(e, "-comment-popover { display: none; z-index: 1000; padding: 0.5rem; background: white; position: absolute; box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.25); width: 30ch; }\n.").concat(e, "-comment-ref:hover~.").concat(e, "-comment-popover { display: block; }\n.").concat(e, "-comment-author,.").concat(e, "-comment-date { font-size: 0.875rem; color: #888; }\n")), oo(t);
    }
  }, {
    key: "renderNumbering",
    value: function renderNumbering(e, t) {
      var _this39 = this;
      var r = "",
        n = [];
      var _iterator47 = _createForOfIteratorHelper(e),
        _step47;
      try {
        var _loop4 = function _loop4() {
            a = _step47.value;
            i = "p.".concat(_this39.numberingClass(a.id, a.level)), s = "none";
            if (a.bullet) {
              var _e20 = "--".concat(_this39.className, "-").concat(a.bullet.src).toLowerCase();
              r += _this39.styleToString("".concat(i, ":before"), {
                content: "' '",
                display: "inline-block",
                background: "var(".concat(_e20, ")")
              }, a.bullet.style), _this39.tasks.push(_this39.document.loadNumberingImage(a.bullet.src).then(function (r) {
                var n = "".concat(_this39.rootSelector, " { ").concat(_e20, ": url(").concat(r, ") }");
                t.appendChild(oo(n));
              }));
            } else if (a.levelText) {
              var _e21 = _this39.numberingCounter(a.id, a.level);
              var _t14 = _e21 + " " + (a.start - 1);
              a.level > 0 && (r += _this39.styleToString("p.".concat(_this39.numberingClass(a.id, a.level - 1)), {
                "counter-reset": _t14
              })), n.push(_t14), r += _this39.styleToString("".concat(i, ":before"), _objectSpread({
                content: _this39.levelTextToContent(a.levelText, a.suff, a.id, _this39.numFormatToCssValue(a.format)),
                "counter-increment": _e21
              }, a.rStyle));
            } else s = _this39.numFormatToCssValue(a.format);
            r += _this39.styleToString(i, _objectSpread({
              display: "list-item",
              "list-style-position": "inside",
              "list-style-type": s
            }, a.pStyle));
          },
          a,
          i,
          s;
        for (_iterator47.s(); !(_step47 = _iterator47.n()).done;) {
          _loop4();
        }
      } catch (err) {
        _iterator47.e(err);
      } finally {
        _iterator47.f();
      }
      return n.length > 0 && (r += this.styleToString(this.rootSelector, {
        "counter-reset": n.join(" ")
      })), oo(r);
    }
  }, {
    key: "renderStyles",
    value: function renderStyles(e) {
      var t = "";
      var r = this.styleMap,
        n = Bi(e.filter(function (e) {
          return e.isDefault;
        }), function (e) {
          return e.target;
        });
      var _iterator48 = _createForOfIteratorHelper(e),
        _step48;
      try {
        for (_iterator48.s(); !(_step48 = _iterator48.n()).done;) {
          var _o3 = _step48.value;
          var a = _o3.styles;
          if (_o3.linked) {
            var i = _o3.linked && r[_o3.linked];
            i ? a = a.concat(i.styles) : this.options.debug && console.warn("Can't find linked style ".concat(_o3.linked));
          }
          var _iterator49 = _createForOfIteratorHelper(a),
            _step49;
          try {
            for (_iterator49.s(); !(_step49 = _iterator49.n()).done;) {
              var _o3$target;
              var _e22 = _step49.value;
              var s = "".concat((_o3$target = _o3.target) !== null && _o3$target !== void 0 ? _o3$target : "", ".").concat(_o3.cssName);
              _o3.target != _e22.target && (s += " ".concat(_e22.target)), n[_o3.target] == _o3 && (s = ".".concat(this.className, " ").concat(_o3.target, ", ") + s), t += this.styleToString(s, _e22.values);
            }
          } catch (err) {
            _iterator49.e(err);
          } finally {
            _iterator49.f();
          }
        }
      } catch (err) {
        _iterator48.e(err);
      } finally {
        _iterator48.f();
      }
      return oo(t);
    }
  }, {
    key: "renderNotes",
    value: function renderNotes(e, t, r) {
      var n = e.map(function (e) {
        return t[e];
      }).filter(function (e) {
        return e;
      });
      if (n.length > 0) {
        var a = this.createElement("ol", null, this.renderElements(n));
        r.appendChild(a);
      }
    }
  }, {
    key: "renderElement",
    value: function renderElement(e) {
      switch (e.type) {
        case Ui.Paragraph:
          return this.renderParagraph(e);
        case Ui.BookmarkStart:
          return this.renderBookmarkStart(e);
        case Ui.BookmarkEnd:
          return null;
        case Ui.Run:
          return this.renderRun(e);
        case Ui.Table:
          return this.renderTable(e);
        case Ui.Row:
          return this.renderTableRow(e);
        case Ui.Cell:
          return this.renderTableCell(e);
        case Ui.Hyperlink:
          return this.renderHyperlink(e);
        case Ui.SmartTag:
          return this.renderSmartTag(e);
        case Ui.Drawing:
          return this.renderDrawing(e);
        case Ui.Image:
          return this.renderImage(e);
        case Ui.Text:
        case Ui.Text:
          return this.renderText(e);
        case Ui.DeletedText:
          return this.renderDeletedText(e);
        case Ui.Tab:
          return this.renderTab(e);
        case Ui.Symbol:
          return this.renderSymbol(e);
        case Ui.Break:
          return this.renderBreak(e);
        case Ui.Footer:
          return this.renderContainer(e, "footer");
        case Ui.Header:
          return this.renderContainer(e, "header");
        case Ui.Footnote:
        case Ui.Endnote:
          return this.renderContainer(e, "li");
        case Ui.FootnoteReference:
          return this.renderFootnoteReference(e);
        case Ui.EndnoteReference:
          return this.renderEndnoteReference(e);
        case Ui.NoBreakHyphen:
          return this.createElement("wbr");
        case Ui.VmlPicture:
          return this.renderVmlPicture(e);
        case Ui.VmlElement:
          return this.renderVmlElement(e);
        case Ui.MmlMath:
          return this.renderContainerNS(e, eo, "math", {
            xmlns: eo
          });
        case Ui.MmlMathParagraph:
          return this.renderContainer(e, "span");
        case Ui.MmlFraction:
          return this.renderContainerNS(e, eo, "mfrac");
        case Ui.MmlBase:
          return this.renderContainerNS(e, eo, e.parent.type == Ui.MmlMatrixRow ? "mtd" : "mrow");
        case Ui.MmlNumerator:
        case Ui.MmlDenominator:
        case Ui.MmlFunction:
        case Ui.MmlLimit:
        case Ui.MmlBox:
          return this.renderContainerNS(e, eo, "mrow");
        case Ui.MmlGroupChar:
          return this.renderMmlGroupChar(e);
        case Ui.MmlLimitLower:
          return this.renderContainerNS(e, eo, "munder");
        case Ui.MmlMatrix:
          return this.renderContainerNS(e, eo, "mtable");
        case Ui.MmlMatrixRow:
          return this.renderContainerNS(e, eo, "mtr");
        case Ui.MmlRadical:
          return this.renderMmlRadical(e);
        case Ui.MmlSuperscript:
          return this.renderContainerNS(e, eo, "msup");
        case Ui.MmlSubscript:
          return this.renderContainerNS(e, eo, "msub");
        case Ui.MmlDegree:
        case Ui.MmlSuperArgument:
        case Ui.MmlSubArgument:
          return this.renderContainerNS(e, eo, "mn");
        case Ui.MmlFunctionName:
          return this.renderContainerNS(e, eo, "ms");
        case Ui.MmlDelimiter:
          return this.renderMmlDelimiter(e);
        case Ui.MmlRun:
          return this.renderMmlRun(e);
        case Ui.MmlNary:
          return this.renderMmlNary(e);
        case Ui.MmlPreSubSuper:
          return this.renderMmlPreSubSuper(e);
        case Ui.MmlBar:
          return this.renderMmlBar(e);
        case Ui.MmlEquationArray:
          return this.renderMllList(e);
        case Ui.Inserted:
          return this.renderInserted(e);
        case Ui.Deleted:
          return this.renderDeleted(e);
        case Ui.CommentRangeStart:
          return this.renderCommentRangeStart(e);
        case Ui.CommentRangeEnd:
          return this.renderCommentRangeEnd(e);
        case Ui.CommentReference:
          return this.renderCommentReference(e);
      }
      return null;
    }
  }, {
    key: "renderChildren",
    value: function renderChildren(e, t) {
      return this.renderElements(e.children, t);
    }
  }, {
    key: "renderElements",
    value: function renderElements(e, t) {
      var _this40 = this;
      if (null == e) return null;
      var r = e.flatMap(function (e) {
        return _this40.renderElement(e);
      }).filter(function (e) {
        return null != e;
      });
      return t && so(t, r), r;
    }
  }, {
    key: "renderContainer",
    value: function renderContainer(e, t, r) {
      return this.createElement(t, r, this.renderChildren(e));
    }
  }, {
    key: "renderContainerNS",
    value: function renderContainerNS(e, t, r, n) {
      return ao(t, r, n, this.renderChildren(e));
    }
  }, {
    key: "renderParagraph",
    value: function renderParagraph(e) {
      var _e$tabs, _r$paragraphProps, _e$numbering, _r$paragraphProps2;
      var t = this.createElement("p");
      var r = this.findStyle(e.styleName);
      (_e$tabs = e.tabs) !== null && _e$tabs !== void 0 ? _e$tabs : e.tabs = r === null || r === void 0 || (_r$paragraphProps = r.paragraphProps) === null || _r$paragraphProps === void 0 ? void 0 : _r$paragraphProps.tabs, this.renderClass(e, t), this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), this.renderCommonProperties(t.style, e);
      var n = (_e$numbering = e.numbering) !== null && _e$numbering !== void 0 ? _e$numbering : r === null || r === void 0 || (_r$paragraphProps2 = r.paragraphProps) === null || _r$paragraphProps2 === void 0 ? void 0 : _r$paragraphProps2.numbering;
      return n && t.classList.add(this.numberingClass(n.id, n.level)), t;
    }
  }, {
    key: "renderRunProperties",
    value: function renderRunProperties(e, t) {
      this.renderCommonProperties(e, t);
    }
  }, {
    key: "renderCommonProperties",
    value: function renderCommonProperties(e, t) {
      null != t && (t.color && (e.color = t.color), t.fontSize && (e["font-size"] = t.fontSize));
    }
  }, {
    key: "renderHyperlink",
    value: function renderHyperlink(e) {
      var t = this.createElement("a");
      if (this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), e.href) t.href = e.href;else if (e.id) {
        var _r15 = this.document.documentPart.rels.find(function (t) {
          return t.id == e.id && "External" === t.targetMode;
        });
        t.href = _r15 === null || _r15 === void 0 ? void 0 : _r15.target;
      }
      return t;
    }
  }, {
    key: "renderSmartTag",
    value: function renderSmartTag(e) {
      var t = this.createElement("span");
      return this.renderChildren(e, t), t;
    }
  }, {
    key: "renderCommentRangeStart",
    value: function renderCommentRangeStart(e) {
      var _this$commentHighligh;
      if (!this.options.renderComments) return null;
      var t = new Range();
      (_this$commentHighligh = this.commentHighlight) === null || _this$commentHighligh === void 0 || _this$commentHighligh.add(t);
      var r = this.htmlDocument.createComment("start of comment #".concat(e.id));
      return this.later(function () {
        return t.setStart(r, 0);
      }), this.commentMap[e.id] = t, r;
    }
  }, {
    key: "renderCommentRangeEnd",
    value: function renderCommentRangeEnd(e) {
      if (!this.options.renderComments) return null;
      var t = this.commentMap[e.id],
        r = this.htmlDocument.createComment("end of comment #".concat(e.id));
      return this.later(function () {
        return t === null || t === void 0 ? void 0 : t.setEnd(r, 0);
      }), r;
    }
  }, {
    key: "renderCommentReference",
    value: function renderCommentReference(e) {
      var _this$document$commen;
      if (!this.options.renderComments) return null;
      var t = (_this$document$commen = this.document.commentsPart) === null || _this$document$commen === void 0 ? void 0 : _this$document$commen.commentMap[e.id];
      if (!t) return null;
      var r = new DocumentFragment(),
        n = ro("span", {
          className: "".concat(this.className, "-comment-ref")
        }, ["💬"]),
        a = ro("div", {
          className: "".concat(this.className, "-comment-popover")
        });
      return this.renderCommentContent(t, a), r.appendChild(this.htmlDocument.createComment("comment #".concat(t.id, " by ").concat(t.author, " on ").concat(t.date))), r.appendChild(n), r.appendChild(a), r;
    }
  }, {
    key: "renderCommentContent",
    value: function renderCommentContent(e, t) {
      t.appendChild(ro("div", {
        className: "".concat(this.className, "-comment-author")
      }, [e.author])), t.appendChild(ro("div", {
        className: "".concat(this.className, "-comment-date")
      }, [new Date(e.date).toLocaleString()])), this.renderChildren(e, t);
    }
  }, {
    key: "renderDrawing",
    value: function renderDrawing(e) {
      var t = this.createElement("div");
      return t.style.display = "inline-block", t.style.position = "relative", t.style.textIndent = "0px", this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), t;
    }
  }, {
    key: "renderImage",
    value: function renderImage(e) {
      var t = this.createElement("img");
      return this.renderStyleValues(e.cssStyle, t), this.document && this.tasks.push(this.document.loadDocumentImage(e.src, this.currentPart).then(function (e) {
        t.src = e;
      })), t;
    }
  }, {
    key: "renderText",
    value: function renderText(e) {
      return this.htmlDocument.createTextNode(e.text);
    }
  }, {
    key: "renderDeletedText",
    value: function renderDeletedText(e) {
      return this.options.renderEndnotes ? this.htmlDocument.createTextNode(e.text) : null;
    }
  }, {
    key: "renderBreak",
    value: function renderBreak(e) {
      return "textWrapping" == e.break ? this.createElement("br") : null;
    }
  }, {
    key: "renderInserted",
    value: function renderInserted(e) {
      return this.options.renderChanges ? this.renderContainer(e, "ins") : this.renderChildren(e);
    }
  }, {
    key: "renderDeleted",
    value: function renderDeleted(e) {
      return this.options.renderChanges ? this.renderContainer(e, "del") : null;
    }
  }, {
    key: "renderSymbol",
    value: function renderSymbol(e) {
      var t = this.createElement("span");
      return t.style.fontFamily = e.font, t.innerHTML = "&#x".concat(e.char, ";"), t;
    }
  }, {
    key: "renderFootnoteReference",
    value: function renderFootnoteReference(e) {
      var t = this.createElement("sup");
      return this.currentFootnoteIds.push(e.id), t.textContent = "".concat(this.currentFootnoteIds.length), t;
    }
  }, {
    key: "renderEndnoteReference",
    value: function renderEndnoteReference(e) {
      var t = this.createElement("sup");
      return this.currentEndnoteIds.push(e.id), t.textContent = "".concat(this.currentEndnoteIds.length), t;
    }
  }, {
    key: "renderTab",
    value: function renderTab(e) {
      var t = this.createElement("span");
      if (t.innerHTML = "&emsp;", this.options.experimental) {
        var _ref3;
        t.className = this.tabStopClass();
        var r = (_ref3 = function (e, t) {
          var r = e.parent;
          for (; null != r && r.type != t;) r = r.parent;
          return r;
        }(e, Ui.Paragraph)) === null || _ref3 === void 0 ? void 0 : _ref3.tabs;
        this.currentTabs.push({
          stops: r,
          span: t
        });
      }
      return t;
    }
  }, {
    key: "renderBookmarkStart",
    value: function renderBookmarkStart(e) {
      var t = this.createElement("span");
      return t.id = e.name, t;
    }
  }, {
    key: "renderRun",
    value: function renderRun(e) {
      if (e.fieldRun) return null;
      var t = this.createElement("span");
      if (e.id && (t.id = e.id), this.renderClass(e, t), this.renderStyleValues(e.cssStyle, t), e.verticalAlign) {
        var _r16 = this.createElement(e.verticalAlign);
        this.renderChildren(e, _r16), t.appendChild(_r16);
      } else this.renderChildren(e, t);
      return t;
    }
  }, {
    key: "renderTable",
    value: function renderTable(e) {
      var t = this.createElement("table");
      return this.tableCellPositions.push(this.currentCellPosition), this.tableVerticalMerges.push(this.currentVerticalMerge), this.currentVerticalMerge = {}, this.currentCellPosition = {
        col: 0,
        row: 0
      }, e.columns && t.appendChild(this.renderTableColumns(e.columns)), this.renderClass(e, t), this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), this.currentVerticalMerge = this.tableVerticalMerges.pop(), this.currentCellPosition = this.tableCellPositions.pop(), t;
    }
  }, {
    key: "renderTableColumns",
    value: function renderTableColumns(e) {
      var t = this.createElement("colgroup");
      var _iterator50 = _createForOfIteratorHelper(e),
        _step50;
      try {
        for (_iterator50.s(); !(_step50 = _iterator50.n()).done;) {
          var _r17 = _step50.value;
          var _e23 = this.createElement("col");
          _r17.width && (_e23.style.width = _r17.width), t.appendChild(_e23);
        }
      } catch (err) {
        _iterator50.e(err);
      } finally {
        _iterator50.f();
      }
      return t;
    }
  }, {
    key: "renderTableRow",
    value: function renderTableRow(e) {
      var t = this.createElement("tr");
      return this.currentCellPosition.col = 0, this.renderClass(e, t), this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), this.currentCellPosition.row++, t;
    }
  }, {
    key: "renderTableCell",
    value: function renderTableCell(e) {
      var t = this.createElement("td");
      var r = this.currentCellPosition.col;
      return e.verticalMerge ? "restart" == e.verticalMerge ? (this.currentVerticalMerge[r] = t, t.rowSpan = 1) : this.currentVerticalMerge[r] && (this.currentVerticalMerge[r].rowSpan += 1, t.style.display = "none") : this.currentVerticalMerge[r] = null, this.renderClass(e, t), this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), e.span && (t.colSpan = e.span), this.currentCellPosition.col += t.colSpan, t;
    }
  }, {
    key: "renderVmlPicture",
    value: function renderVmlPicture(e) {
      var t = ro("div");
      return this.renderChildren(e, t), t;
    }
  }, {
    key: "renderVmlElement",
    value: function renderVmlElement(e) {
      var _e$imageHref, _this$document;
      var t = no("svg");
      t.setAttribute("style", e.cssStyleText);
      var r = this.renderVmlChildElement(e);
      return (_e$imageHref = e.imageHref) !== null && _e$imageHref !== void 0 && _e$imageHref.id && this.tasks.push((_this$document = this.document) === null || _this$document === void 0 ? void 0 : _this$document.loadDocumentImage(e.imageHref.id, this.currentPart).then(function (e) {
        return r.setAttribute("href", e);
      })), t.appendChild(r), requestAnimationFrame(function () {
        var e = t.firstElementChild.getBBox();
        t.setAttribute("width", "".concat(Math.ceil(e.x + e.width))), t.setAttribute("height", "".concat(Math.ceil(e.y + e.height)));
      }), t;
    }
  }, {
    key: "renderVmlChildElement",
    value: function renderVmlChildElement(e) {
      var t = no(e.tagName);
      Object.entries(e.attrs).forEach(function (_ref4) {
        var _ref5 = _slicedToArray(_ref4, 2),
          e = _ref5[0],
          r = _ref5[1];
        return t.setAttribute(e, r);
      });
      var _iterator51 = _createForOfIteratorHelper(e.children),
        _step51;
      try {
        for (_iterator51.s(); !(_step51 = _iterator51.n()).done;) {
          var _r18 = _step51.value;
          _r18.type == Ui.VmlElement ? t.appendChild(this.renderVmlChildElement(_r18)) : t.appendChild.apply(t, _toConsumableArray(Oi(this.renderElement(_r18))));
        }
      } catch (err) {
        _iterator51.e(err);
      } finally {
        _iterator51.f();
      }
      return t;
    }
  }, {
    key: "renderMmlRadical",
    value: function renderMmlRadical(e) {
      var _e$props;
      var t = e.children.find(function (e) {
        return e.type == Ui.MmlBase;
      });
      if ((_e$props = e.props) !== null && _e$props !== void 0 && _e$props.hideDegree) return ao(eo, "msqrt", null, this.renderElements([t]));
      var r = e.children.find(function (e) {
        return e.type == Ui.MmlDegree;
      });
      return ao(eo, "mroot", null, this.renderElements([t, r]));
    }
  }, {
    key: "renderMmlDelimiter",
    value: function renderMmlDelimiter(e) {
      var _e$props$beginChar, _e$props$endChar;
      var t = [];
      return t.push(ao(eo, "mo", null, [(_e$props$beginChar = e.props.beginChar) !== null && _e$props$beginChar !== void 0 ? _e$props$beginChar : "("])), t.push.apply(t, _toConsumableArray(this.renderElements(e.children))), t.push(ao(eo, "mo", null, [(_e$props$endChar = e.props.endChar) !== null && _e$props$endChar !== void 0 ? _e$props$endChar : ")"])), ao(eo, "mrow", null, t);
    }
  }, {
    key: "renderMmlNary",
    value: function renderMmlNary(e) {
      var _e$props$char, _e$props2;
      var t = [],
        r = Bi(e.children, function (e) {
          return e.type;
        }),
        n = r[Ui.MmlSuperArgument],
        a = r[Ui.MmlSubArgument],
        i = n ? ao(eo, "mo", null, Oi(this.renderElement(n))) : null,
        s = a ? ao(eo, "mo", null, Oi(this.renderElement(a))) : null,
        o = ao(eo, "mo", null, [(_e$props$char = (_e$props2 = e.props) === null || _e$props2 === void 0 ? void 0 : _e$props2.char) !== null && _e$props$char !== void 0 ? _e$props$char : "∫"]);
      return i || s ? t.push(ao(eo, "munderover", null, [o, s, i])) : i ? t.push(ao(eo, "mover", null, [o, i])) : s ? t.push(ao(eo, "munder", null, [o, s])) : t.push(o), t.push.apply(t, _toConsumableArray(this.renderElements(r[Ui.MmlBase].children))), ao(eo, "mrow", null, t);
    }
  }, {
    key: "renderMmlPreSubSuper",
    value: function renderMmlPreSubSuper(e) {
      var t = [],
        r = Bi(e.children, function (e) {
          return e.type;
        }),
        n = r[Ui.MmlSuperArgument],
        a = r[Ui.MmlSubArgument],
        i = n ? ao(eo, "mo", null, Oi(this.renderElement(n))) : null,
        s = a ? ao(eo, "mo", null, Oi(this.renderElement(a))) : null,
        o = ao(eo, "mo", null);
      return t.push(ao(eo, "msubsup", null, [o, s, i])), t.push.apply(t, _toConsumableArray(this.renderElements(r[Ui.MmlBase].children))), ao(eo, "mrow", null, t);
    }
  }, {
    key: "renderMmlGroupChar",
    value: function renderMmlGroupChar(e) {
      var t = "bot" === e.props.verticalJustification ? "mover" : "munder",
        r = this.renderContainerNS(e, eo, t);
      return e.props.char && r.appendChild(ao(eo, "mo", null, [e.props.char])), r;
    }
  }, {
    key: "renderMmlBar",
    value: function renderMmlBar(e) {
      var t = this.renderContainerNS(e, eo, "mrow");
      switch (e.props.position) {
        case "top":
          t.style.textDecoration = "overline";
          break;
        case "bottom":
          t.style.textDecoration = "underline";
      }
      return t;
    }
  }, {
    key: "renderMmlRun",
    value: function renderMmlRun(e) {
      var t = ao(eo, "ms");
      return this.renderClass(e, t), this.renderStyleValues(e.cssStyle, t), this.renderChildren(e, t), t;
    }
  }, {
    key: "renderMllList",
    value: function renderMllList(e) {
      var t = ao(eo, "mtable");
      this.renderClass(e, t), this.renderStyleValues(e.cssStyle, t), this.renderChildren(e);
      var _iterator52 = _createForOfIteratorHelper(this.renderChildren(e)),
        _step52;
      try {
        for (_iterator52.s(); !(_step52 = _iterator52.n()).done;) {
          var _r19 = _step52.value;
          t.appendChild(ao(eo, "mtr", null, [ao(eo, "mtd", null, [_r19])]));
        }
      } catch (err) {
        _iterator52.e(err);
      } finally {
        _iterator52.f();
      }
      return t;
    }
  }, {
    key: "renderStyleValues",
    value: function renderStyleValues(e, t) {
      for (var _r20 in e) _r20.startsWith("$") ? t.setAttribute(_r20.slice(1), e[_r20]) : t.style[_r20] = e[_r20];
    }
  }, {
    key: "renderClass",
    value: function renderClass(e, t) {
      e.className && (t.className = e.className), e.styleName && t.classList.add(this.processStyleName(e.styleName));
    }
  }, {
    key: "findStyle",
    value: function findStyle(e) {
      var _this$styleMap;
      return e && ((_this$styleMap = this.styleMap) === null || _this$styleMap === void 0 ? void 0 : _this$styleMap[e]);
    }
  }, {
    key: "numberingClass",
    value: function numberingClass(e, t) {
      return "".concat(this.className, "-num-").concat(e, "-").concat(t);
    }
  }, {
    key: "tabStopClass",
    value: function tabStopClass() {
      return "".concat(this.className, "-tab-stop");
    }
  }, {
    key: "styleToString",
    value: function styleToString(e, t) {
      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      var n = "".concat(e, " {\r\n");
      for (var _e24 in t) _e24.startsWith("$") || (n += "  ".concat(_e24, ": ").concat(t[_e24], ";\r\n"));
      return r && (n += r), n + "}\r\n";
    }
  }, {
    key: "numberingCounter",
    value: function numberingCounter(e, t) {
      return "".concat(this.className, "-num-").concat(e, "-").concat(t);
    }
  }, {
    key: "levelTextToContent",
    value: function levelTextToContent(e, t, r, n) {
      var _this41 = this,
        _tab$space$t;
      return "\"".concat(e.replace(/%\d*/g, function (e) {
        var t = parseInt(e.substring(1), 10) - 1;
        return "\"counter(".concat(_this41.numberingCounter(r, t), ", ").concat(n, ")\"");
      })).concat((_tab$space$t = {
        tab: "\\9",
        space: "\\a0"
      }[t]) !== null && _tab$space$t !== void 0 ? _tab$space$t : "", "\"");
    }
  }, {
    key: "numFormatToCssValue",
    value: function numFormatToCssValue(e) {
      var _none$bullet$decimal$;
      return (_none$bullet$decimal$ = {
        none: "none",
        bullet: "disc",
        decimal: "decimal",
        lowerLetter: "lower-alpha",
        upperLetter: "upper-alpha",
        lowerRoman: "lower-roman",
        upperRoman: "upper-roman",
        decimalZero: "decimal-leading-zero",
        aiueo: "katakana",
        aiueoFullWidth: "katakana",
        chineseCounting: "simp-chinese-informal",
        chineseCountingThousand: "simp-chinese-informal",
        chineseLegalSimplified: "simp-chinese-formal",
        chosung: "hangul-consonant",
        ideographDigital: "cjk-ideographic",
        ideographTraditional: "cjk-heavenly-stem",
        ideographLegalTraditional: "trad-chinese-formal",
        ideographZodiac: "cjk-earthly-branch",
        iroha: "katakana-iroha",
        irohaFullWidth: "katakana-iroha",
        japaneseCounting: "japanese-informal",
        japaneseDigitalTenThousand: "cjk-decimal",
        japaneseLegal: "japanese-formal",
        thaiNumbers: "thai",
        koreanCounting: "korean-hangul-formal",
        koreanDigital: "korean-hangul-formal",
        koreanDigital2: "korean-hanja-informal",
        hebrew1: "hebrew",
        hebrew2: "hebrew",
        hindiNumbers: "devanagari",
        ganada: "hangul",
        taiwaneseCounting: "cjk-ideographic",
        taiwaneseCountingThousand: "cjk-ideographic",
        taiwaneseDigital: "cjk-decimal"
      }[e]) !== null && _none$bullet$decimal$ !== void 0 ? _none$bullet$decimal$ : e;
    }
  }, {
    key: "refreshTabStops",
    value: function refreshTabStops() {
      var _this42 = this;
      this.options.experimental && (clearTimeout(this.tabsTimeout), this.tabsTimeout = setTimeout(function () {
        var e = function () {
          var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document.body;
          var t = document.createElement("div");
          t.style.width = "100pt", e.appendChild(t);
          var r = 100 / t.offsetWidth;
          return e.removeChild(t), r;
        }();
        var _iterator53 = _createForOfIteratorHelper(_this42.currentTabs),
          _step53;
        try {
          for (_iterator53.s(); !(_step53 = _iterator53.n()).done;) {
            var _t15 = _step53.value;
            Gs(_t15.span, _t15.stops, _this42.defaultTabSize, e);
          }
        } catch (err) {
          _iterator53.e(err);
        } finally {
          _iterator53.f();
        }
      }, 500));
    }
  }, {
    key: "later",
    value: function later(e) {
      this.postRenderTasks.push(e);
    }
  }]);
}();
function ro(e, t, r) {
  return ao(void 0, e, t, r);
}
function no(e, t, r) {
  return ao(Qs, e, t, r);
}
function ao(e, t, r, n) {
  var a = e ? document.createElementNS(e, t) : document.createElement(t);
  return Object.assign(a, r), n && so(a, n), a;
}
function io(e) {
  e.innerHTML = "";
}
function so(e, t) {
  t.forEach(function (t) {
    return e.appendChild("string" == typeof (r = t) || r instanceof String ? document.createTextNode(t) : t);
    var r;
  });
}
function oo(e) {
  return ro("style", {
    innerHTML: e
  });
}
function lo(e, t) {
  e.appendChild(document.createComment(t));
}
var co = {
  ignoreHeight: !1,
  ignoreWidth: !1,
  ignoreFonts: !1,
  breakPages: !0,
  debug: !1,
  experimental: !1,
  className: "docx",
  inWrapper: !0,
  trimXmlDeclaration: !0,
  ignoreLastRenderedPageBreak: !0,
  renderHeaders: !0,
  renderFooters: !0,
  renderFootnotes: !0,
  renderEndnotes: !0,
  useBase64URL: !1,
  renderChanges: !1,
  renderComments: !1
};
function ho(_x13, _x14, _x15, _x16) {
  return _ho.apply(this, arguments);
}
function _ho() {
  _ho = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee12(e, t, r, n) {
    var a;
    return _regeneratorRuntime().wrap(function _callee12$(_context12) {
      while (1) switch (_context12.prev = _context12.next) {
        case 0:
          _context12.next = 2;
          return function (e, t) {
            var r = _objectSpread(_objectSpread({}, co), t);
            return Ts.load(e, new Vs(r), r);
          }(e, n);
        case 2:
          a = _context12.sent;
          _context12.next = 5;
          return function () {
            var _ref7 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee11(e, t, r, n) {
              var a, i;
              return _regeneratorRuntime().wrap(function _callee11$(_context11) {
                while (1) switch (_context11.prev = _context11.next) {
                  case 0:
                    a = _objectSpread(_objectSpread({}, co), n), i = new to(window.document);
                    return _context11.abrupt("return", (i.render(e, t, r, a), Promise.allSettled(i.tasks)));
                  case 2:
                  case "end":
                    return _context11.stop();
                }
              }, _callee11);
            }));
            return function (_x21, _x22, _x23, _x24) {
              return _ref7.apply(this, arguments);
            };
          }()(a, t, r, n);
        case 5:
          return _context12.abrupt("return", a);
        case 6:
        case "end":
          return _context12.stop();
      }
    }, _callee12);
  }));
  return _ho.apply(this, arguments);
}
var uo = {
  ignoreLastRenderedPageBreak: !1
};
var fo = {
  getData: function getData(e) {
    var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    return "string" == typeof e ? function (e, t) {
      return fetch(e, t).then(function (e) {
        return 200 !== e.status ? Promise.reject(e) : e;
      });
    }(e, t) : Promise.resolve(e);
  },
  render: function render(e, t) {
    var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
    if (!e) return t.innerHTML = "", Promise.resolve();
    var n;
    return e instanceof Blob ? n = e : e instanceof Response ? n = e.blob() : e instanceof ArrayBuffer && (n = new Blob([e])), ho(n, t, t, _objectSpread(_objectSpread({}, uo), r));
  },
  getBlob: function () {
    var _getBlob = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(e) {
      var t;
      return _regeneratorRuntime().wrap(function _callee9$(_context9) {
        while (1) switch (_context9.prev = _context9.next) {
          case 0:
            if (!(e instanceof Blob)) {
              _context9.next = 4;
              break;
            }
            t = e;
            _context9.next = 11;
            break;
          case 4:
            if (!(e instanceof Response)) {
              _context9.next = 10;
              break;
            }
            _context9.next = 7;
            return e.blob();
          case 7:
            t = _context9.sent;
            _context9.next = 11;
            break;
          case 10:
            e instanceof ArrayBuffer && (t = new Blob([e]));
          case 11:
            return _context9.abrupt("return", t);
          case 12:
          case "end":
            return _context9.stop();
        }
      }, _callee9);
    }));
    function getBlob(_x17) {
      return _getBlob.apply(this, arguments);
    }
    return getBlob;
  }()
};
function po(_x18, _x19) {
  return _po.apply(this, arguments);
}
function _po() {
  _po = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee13(e, t) {
    return _regeneratorRuntime().wrap(function _callee13$(_context13) {
      while (1) switch (_context13.prev = _context13.next) {
        case 0:
          t && (t instanceof ArrayBuffer && (t = new Blob([t])), function (e, t) {
            var r = document.createElement("a");
            r.download = e, r.style.display = "none", r.href = t, document.body.appendChild(r), r.click(), document.body.removeChild(r);
          }(e, URL.createObjectURL(t)));
        case 1:
        case "end":
          return _context13.stop();
      }
    }, _callee13);
  }));
  return _po.apply(this, arguments);
}
var mo = /*#__PURE__*/function () {
  function mo(e) {
    var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
    _classCallCheck(this, mo);
    _defineProperty(this, "container", null);
    _defineProperty(this, "wrapper", null);
    _defineProperty(this, "wrapperMain", null);
    _defineProperty(this, "options", {});
    _defineProperty(this, "requestOptions", {});
    _defineProperty(this, "fileData", null);
    this.container = e, this.options = t, this.requestOptions = r, this.createWrapper();
  }
  return _createClass(mo, [{
    key: "createWrapper",
    value: function createWrapper() {
      this.wrapper = document.createElement("div"), this.wrapper.className = "vue-office-docx", this.wrapperMain = document.createElement("div"), this.wrapperMain.className = "vue-office-docx-main", this.wrapper.appendChild(this.wrapperMain), this.container.appendChild(this.wrapper);
    }
  }, {
    key: "setOptions",
    value: function setOptions(e) {
      this.options = e;
    }
  }, {
    key: "setRequestOptions",
    value: function setRequestOptions(e) {
      this.requestOptions = e;
    }
  }, {
    key: "preview",
    value: function preview(e) {
      var _this43 = this;
      return new Promise(function (t, r) {
        fo.getData(e, _this43.requestOptions).then(/*#__PURE__*/function () {
          var _ref6 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10(e) {
            return _regeneratorRuntime().wrap(function _callee10$(_context10) {
              while (1) switch (_context10.prev = _context10.next) {
                case 0:
                  _context10.next = 2;
                  return fo.getBlob(e);
                case 2:
                  _this43.fileData = _context10.sent;
                  fo.render(_this43.fileData, _this43.wrapperMain, _this43.options).then(function () {
                    t();
                  }).catch(function (e) {
                    fo.render("", _this43.wrapperMain, _this43.options), r(e);
                  });
                case 4:
                case "end":
                  return _context10.stop();
              }
            }, _callee10);
          }));
          return function (_x20) {
            return _ref6.apply(this, arguments);
          };
        }()).catch(function (e) {
          fo.render("", _this43.wrapperMain, _this43.options), r(e);
        });
      });
    }
  }, {
    key: "save",
    value: function save(e) {
      po(e || "js-preview-docx-".concat(new Date().getTime(), ".docx"), this.fileData);
    }
  }, {
    key: "destroy",
    value: function destroy() {
      this.container.removeChild(this.wrapper), this.container = null, this.wrapper = null, this.wrapperMain = null, this.options = null, this.requestOptions = null;
    }
  }]);
}();
var go = {
  init: function init(e, t, r) {
    return new mo(e, t, r);
  }
};
export { go as default };
